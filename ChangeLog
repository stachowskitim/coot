
2024-04-22  Paul Emsley  <pemsley at mrc dash lmb dot cam ac dot uk>

	* Release 1.1.08

2024-01-17  Paul Emsley  <pemsley at mrc dash lmb dot cam ac dot uk>

	* Release 1.1.07

2024-01-15  Paul Emsley  <pemsley at mrc dash lmb dot cam ac dot uk>

	* Release 1.1.06

2024-01-15  Paul Emsley  <pemsley at mrc dash lmb dot cam ac dot uk>

	* Release 1.1.05

2024-01-14  Paul Emsley  <pemsley at mrc dash lmb dot cam ac dot uk>

	* Release 1.1.04

2023-12-22  Paul Emsley  <pemsley at mrc dash lmb dot cam ac dot uk>

	* Release 1.1.03

2023-11-10  Paul Emsley  <pemsley at mrc dash lmb dot cam ac dot uk>

	* Release 1.1.02

2023-11-09  Paul Emsley  <pemsley at mrc dash lmb dot cam ac dot uk>

	* Release 1.1.01

2023-10-31  Paul Emsley  <pemsley at mrc dash lmb dot cam ac dot uk>

	* Release 1.1

2022-04-14  Paul Emsley  <pemsley at mrc dash lmb dot cam ac dot uk>

	* Release 1.0.04

2022-04-12  Paul Emsley  <pemsley at mrc dash lmb dot cam ac dot uk>

	* Release 1.0.03

2022-04-04  Paul Emsley  <pemsley at mrc dash lmb dot cam ac dot uk>

	* Release 1.0.01

2022-04-01  Paul Emsley  <pemsley at mrc dash lmb dot cam ac dot uk>

	* Release 1

2024-01-09  Paul Emsley  <pemsley at mrc dash lmb dot cam ac dot uk>

	* Release 0.9.8.93

2023-09-04  Paul Emsley  <pemsley at mrc dash lmb dot cam ac dot uk>

	* Release 0.9.8.92

2023-08-04  Paul Emsley  <pemsley at mrc dash lmb dot cam ac dot uk>

	* Release 0.9.8.91

2023-07-25  Paul Emsley  <pemsley at mrc dash lmb dot cam ac dot uk>

	* Release 0.9.8.9

2023-06-23  Paul Emsley  <pemsley at mrc dash lmb dot cam ac dot uk>

	* Release 0.9.8.8

2023-01-02  Paul Emsley  <pemsley at mrc dash lmb dot cam ac dot uk>

	* Release 0.9.8.7

2022-12-05  Paul Emsley  <pemsley at mrc dash lmb dot cam ac dot uk>

	* Release 0.9.8.6

2022-10-01  Paul Emsley  <pemsley at mrc dash lmb dot cam ac dot uk>

	* Release 0.9.8.5

2022-09-17  Paul Emsley  <pemsley at mrc dash lmb dot cam ac dot uk>

	* Release 0.9.8.4

2022-05-31  Paul Emsley  <pemsley at mrc dash lmb dot cam ac dot uk>

	* Release 0.9.8.2

2022-03-18  Paul Emsley  <pemsley at mrc dash lmb dot cam ac dot uk>

	* Release 0.9.8.1

2022-03-01  Paul Emsley  <pemsley at mrc dash lmb dot cam ac dot uk>

	* Release 0.9.8

2022-01-24  Paul Emsley  <pemsley at mrc dash lmb dot cam ac dot uk>

	* Release 0.9.7

2021-07-02  Paul Emsley  <pemsley at mrc dash lmb dot cam ac dot uk>

	* Release 0.9.6

2021-03-16  Paul Emsley  <pemsley at mrc dash lmb dot cam ac dot uk>

	* Release 0.9.5

2021-02-02  Paul Emsley  <pemsley at mrc dash lmb dot ac dot uk>

	* Release 0.9.4.1

2021-01-29  Paul Emsley  <pemsley at mrc dash lmb dot ac dot uk>

	* Release 0.9.4

2020-10-18  Paul Emsley  <pemsley at mrc dash lmb dot ac dot uk>

	* Release 0.9.3

2020-10-02  Paul Emsley  <pemsley at mrc dash lmb dot ac dot uk>

	* Release 0.9.2

2020-09-25  Paul Emsley  <pemsley at mrc dash lmb dot ac dot uk>

	* Release 0.9.1

2020-04-01  Paul Emsley  <pemsley at mrc dash lmb dot ac dot uk>

	* Release 0.9

2018-04-01  Paul Emsley  <pemsley at mrc dash lmb dot ac dot uk>

	* Release 0.8.9.2

2018-03-18  Paul Emsley  <pemsley at mrc dash lmb dot ac dot uk>

	* Release 0.8.9.1

2018-01-09  Paul Emsley  <pemsley at mrc dash lmb dot ac dot uk>

	* Release 0.8.9

2017-03-13  Paul Emsley  <pemsley at mrc dash lmb dot ac dot uk>

	* Release 0.8.8

2016-11-07  Paul Emsley  <pemsley at mrc dash lmb dot ac dot uk>

	* Release 0.8.7

2016-08-18  Paul Emsley  <pemsley at mrc dash lmb dot ac dot uk>

	* Release 0.8.6

2016-08-08  Paul Emsley  <pemsley at mrc dash lmb dot ac dot uk>

	* Release 0.8.5

2016-07-28  Paul Emsley  <pemsley at mrc dash lmb dot ac dot uk>

	* Release 0.8.4

2016-04-01  Paul Emsley  <pemsley at mrc dash lmb dot ac dot uk>

	* Release 0.8.3

2015-08-27  Paul Emsley  <pemsley at mrc dash lmb dot ac dot uk>

	* Release 0.8.2

2013-12-10  Paul Emsley  <pemsley at mrc dash lmb dot ac dot uk>

	* Release 0.8.1

2013-05-14  Paul Emsley  <pemsley at mrc dash lmb dot ac dot uk>

	* Release 0.8

2013-05-14  Paul Emsley  <emsley@ysbl.york.ac.uk>

	* Release 0.7.1

2012-09-28  Paul Emsley  <emsley@ysbl.york.ac.uk>

	* Release 0.7

2010-01-26  Paul Emsley  <emsley@ysbl.york.ac.uk>

	* Release 0.6.1

2009-12-01  Paul Emsley  <emsley@ysbl.york.ac.uk>

	* Release 0.6

2008-12-15  Paul Emsley  <emsley@ysbl.york.ac.uk>

	* Release 0.5.2, fix silly shift labelling atoms bug.

	* Release 0.5.1

2008-09-24  Paul Emsley  <emsley@ysbl.york.ac.uk>

	* Release 0.5

2008-01-02  Paul Emsley  <paul.emsley@bioc.ox.ac.uk>

	* Release 0.4

2007-07-12  Paul Emsley  <emsley@ysbl.york.ac.uk>

	* src/graphics-info.h: add geom_p->add_planar_peptide_restraint()
	to graphics_info_t::init().

2007-07-11  Paul Emsley  <emsley@ysbl.york.ac.uk>

	* src/globjects.cc: changed smooth_scroll_step to 80 from 8.

2007-06-29  Paul Emsley  <emsley@ysbl.york.ac.uk>

	* Release 0.3.2

2007-06-26  Paul Emsley  <emsley@ysbl.york.ac.uk>

	* coot-utils/coot-shelx-ins.cc: (make_atom): set the U matrix
	correctly. There was a transposition of u12 and u23. Ouch.

2007-06-16  Paul Emsley  <emsley@ysbl.york.ac.uk>

	* src/molecule-class-info.cc: (add try/catch mechanism round
	file.open_read() in read_ccp4_map()).  Fixes a crash on reading a
	non-CCP4 map.

2007-06-21  Paul Emsley  <emsley@localhost>

	* db-main/db-main.cc (clear_results): clear the output fragment
	too.

2007-06-18  Paul Emsley  <emsley@localhost>

	* src/c-interface.cc: Add action view - as a direct view.  But,
	don't we really instead want to insert such a thing into a set of
	views that we already have?

2007-06-17  Paul Emsley  <emsley@localhost>

	* ligand/wiggly-ligand.cc: turn off debugging for wiggly ligands.

2007-06-07  Paul Emsley  <emsley@ysbl.york.ac.uk>

	* coords/Bond_lines.cc: (construct_from_atom_selection): Don't
	mark S, SE, CL, BR, or P as bonded.

2007-05-29  Paul Emsley  <emsley@localhost>

	* src/molecule-class-info-other.cc:
	change_chain_id_with_residue_range_helper_insert_or_add() the
	target_residue should simply be a residue that will appear in the
	pdb file before the inserted residue.
 
2007-05-18  Paul Emsley  <emsley@ysbl.york.ac.uk>

	* src/c-interface.cc: (hardware_stereo_mode): kill off the
	SIDE_BY_SIDE_STEREO widget, if it was active.

2007-05-12  Paul Emsley  <emsley@localhost>

	* src/c-interface-build.cc (get_monomer): check that the library
	does not provide the restraints for the given 3-letter-code before
	passing to the libcheck function [Judit Debreczeni].

2007-05-04  Paul Emsley  <emsley@localhost>

	* src/molecule-class-info.cc: (anisotropic_atoms): Add in cholesky
	decomposition to the matrix.

2007-05-03  Paul Emsley  <emsley@localhost>

	* src/graphics-info-modelling.cc: Added
	execute_simple_nucleotide_addition() function.

2007-05-01  Paul Emsley  <emsley@localhost>

	* src/molecule-class-info.cc: Kevin Cowtan provided a patch for
	CNS map reading.

2007-04-13  Paul Emsley  <emsley@localhost>

	* src/pick.cc: Added Segid info to picked atom output info
	[Christie Durnham]

2007-04-07  Paul Emsley  <emsley@ysbl.york.ac.uk>

	* Release 0.3.1 

	* enable NCS ghosts.  Add fractional matrix for LSQing. 

	* Release 0.3

2007-03-31  Paul Emsley  <emsley@ysbl.york.ac.uk>

	* src/graphics-info.cc: (destroy_edit_backbone_rama_plot): set
	edit_phi_psi_plot to null so that it is not left dangling when we
	do edit phi/psi the the N-terminal residue, where there is no
	Ramachandran plot made.  Fixes Richard Baxter bug.

	(update_molecule_to): don't call molecule_class_info_t's
	update_molecule_to if there are no atoms in the guide point
	vector.  This stops the creation of a molecule with no atoms in
	it, which causes problems because it seems to be closed.  Also
	this means that the model is not modified without creating a new
	atom selection.  Fixes Richard Baxter bug.

2007-03-19  Paul Emsley  <emsley@ysbl.york.ac.uk>

	* src/cc-interface.hh: Add USE_GUILE protection to
	dictionaries_read().

2007-03-06  Paul Emsley  <paulemsley@ysbl.york.ac.uk>

	* src/c-interface-build.cc: (replace_fragment): function added.

2007-03-05  Paul Emsley  <paulemsley@ysbl.york.ac.uk>

	* src/c-interface.h: (zoom_factor) function added.

2007-02-13  Paul Emsley  <emsley@ysbl.york.ac.uk>

	* mapview.glade: Fix typo in "No Restraints" window [Steven
	Sheriff].

2007-02-10  Paul Emsley  <emsley@ysbl.york.ac.uk>

	* configure.in: Changed to version 0.2.1-pre-2 as I manually apply
	diffs from Paris.

2007-02-08  Paul Emsley  <emsley@ysbl.york.ac.uk>

	* src/callbacks.c: Many functions: change return types from gchar*
	to const char * [typically from entries] to compile cleanly with
	GTK2.

	* src/c-interface-info.cc:
	(generic_string_vector_to_list_internal): needs USE_GUILE
	protection.

	* macros/guile-gtk.m4 (AM_PATH_GUILE_GTK): Use coot_gtk2 to set
	the version of libguilegtk-x.y.la for GUILE_GTK_LIBS.

2007-02-07  Paul Emsley  <emsley@ysbl.york.ac.uk>

	* src/Makefile.am (INCLUDES): reordered because we want GTK flags
	and GUILE flags to come first because they could be in a different
	directory - when test building.

	* src/molecule-class-info-other.cc: (get_term_type) return
	"singleton" as a possible terminal residue type.

	* ligand/residue_by_phi_psi.cc: (residue_by_phi_psi) and other
	functions: add support for terminus type "singleton".  Treat as a
	C-terminal addition.

	* src/graphics-info-modelling.cc:
	(execute_rotate_translate_ready): change the code path to check
	for atoms being in the same chain before putting up the GUI and
	making an intermediate molecule.

	* src/graphics-info-modelling.cc:
	(execute_rigid_body_refine): change the code path to check for
	atoms being in the same chain before doing rigid body refine. Does
	that fix Bob Nolte's bug?

2007-01-30  Paul Emsley  <emsley@ysbl.york.ac.uk>

	* ligand/rigid-body.cc: (rigid_body_fit): Assign a (0,0,0)
	grad_vec when the occupancy of the atom is 0, otherwise it was
	undefined.  Fixes crazy alpha helix placement?

2007-01-04  Paul Emsley  <emsley@ysbl.york.ac.uk>

	* Release 0.2

2006-12-05  Paul Emsley  <emsley@ysbl.york.ac.uk>

	* src/graphics-info-state.cc: (save_state_file) save the map
	sampling rate if it not the default.

2006-11-06  Paul Emsley  <emsley@ysbl.york.ac.uk>

	* src/c-interface.cc: (dragged_refinement_steps_per_frame): return
	the number of steps so that we can save them.

2006-11-02  Paul Emsley  <emsley@ysbl.york.ac.uk>

	* src/c-interface-build.cc: (set_show_chi_angle_bond): Add a
	redraw so that the new mode of chi angle drawing [typically called
	from callbacks.c functions] are made effective [green bond no
	longer left behind].

	* src/c-interface-preferences.cc:
	(save_accept_reject_dialog_window_position): only [dereference and]
	save the position if the dialog is not null.

2006-11-03  Paul Emsley  <emsley@ysbl.york.ac.uk>

	* src/molecule-class-info.cc: (handle_read_draw_molecule): only
	update the bond width if this is NOT a undo.

2006-09-17  Paul Emsley  <emsley@ysbl.york.ac.uk>

	* src/graphics-info-modelling.cc: (rot_trans_adjustment_changed):
	add in code to check for CA bonds in master molecule and find
	bonds appropriately.

	* src/molecule-class-info.cc: remove intermediate pair of Cartesians
	in draw_skeleton(), suggestion from Ezra Peisach.

2006-08-31  Paul Emsley  <paulemsley@ysbl.york.ac.uk>

	* src/globjects.cc (key_press_event): mark as handled GDK_Meta_L
	and GDK_Meta_R [for mac].

2006-08-23  Paul Emsley  <paulemsley@ysbl.york.ac.uk>

	* Release 0.1.2.

2006-08-24  Paul Emsley  <paulemsley@ysbl.york.ac.uk>

	* src/callbacks.c (on_auto_open_mtz_activate): correctly set the
	sort_button [fixes random crash maybe].

	* ligand/ligand.cc: ligand constructor: Change the default
	map_atom_mask_radius to 2.0A.

2006-08-20  Paul Emsley  <paulemsley@ysbl.york.ac.uk>

	* src/c-interface.cc: also c-interface-preferences.cc and
	globjects.cc, callback.c and graphics-info-state.cc: Add code to
	store, save and restore the position of the ramachandran plot.

2006-08-19  Paul Emsley  <emsley@ysbl.york.ac.uk>

	* src/molecule-class-info-ncs.cc: (copy_residue_range): completely
	re-written to fix bug noted by Panagis Filippakopoulos.

2006-08-14  Paul Emsley  <emsley@ysbl.york.ac.uk>

	* src/c-interface-preferences.cc: (Add functions to save the
	position of major widgets).

2006-08-08  Paul Emsley  <emsley@ysbl.york.ac.uk>

	* src/globjects.cc: (handle_scroll_event): abstracted from long
	glarea_button_press [More of the same please!].  Now scroll_events
	[GTK2?] are handled similarly.

2006-08-08  Paul Emsley  <emsley@ysbl.york.ac.uk>

	* src/geometry-graphs.cc:
	(render_geometry_distortion_blocks_internal): Use sane_occupancy
	to convert from shelx occupancies.  Stops geometry distortions
	going negative.

	* src/c-interface.cc: function to set the default bond thickness,
	saved/used in save_state_file().

	* src/c-interface-build.cc: (on_merge_molecules_check_button_toggled):
	  Use GPOINTER_TO_INT to type user data. LTE bug.

	* src/c-interface-build.cc (execute_refmac): Use GPOINTER_TO_INT
	to get user data from active item. LTE bug.

	* src/c-interface.cc (on_filename_filter_toggle_button_toggled):
	  Use GPOINTER_TO_INT to type user data. LTE bug.

	* src/graphics-info-modelling.cc: (rot_trans_adjustment_changed):
	Use GPOINTER_TO_INT to type user_data. LTE bug.

2006-08-07  Paul Emsley  <emsley@ysbl.york.ac.uk>

	* src/graphics-info.cc: (on_change_current_chi_button_clicked):
	use GPOINTER_TO_INT to type user data. LTE bug.

	(difference_map_peaks_neighbour_peak): user GPOINTER_TO_INT to
	type result of gtk_object_get_user_data(). LTE bug.

	(rotamer_dialog_neighbour_rotamer): user GPOINTER_TO_INT to type
	user_data. LTE bug.

	(bonds_colour_rotation_adjustment_changed): use
	GPOINTER_TO_INT. LTE bug.

2006-08-04  Paul Emsley  <emsley@ysbl.york.ac.uk>

	* src/graphics-info.cc: (float_to_string): Valgrind was
	complaining about uninitialized memory.  Not sure why.  Index the
	arrays to 99 instead when zeroing.

	* coords/Bond_lines.cc: (construct_from_asc): when outputing UDD
	error for atom [it sholdn't happen] index the correct array. Valgrind

2006-08-03  Paul Emsley  <emsley@ysbl.york.ac.uk>

	* src/molecule-class-info.cc: (label_atom): only draw the atom
	labels if the molecule is being displayed.

	* src/geometry-graphs.cc:
	(render_geometry_distortion_blocks_internal): Don't do things for
	atom index -1 [Not sure why atom index *is* -1 though].  This and
	below fixes bug on geometry validation of 1HJ9 [Ulrich Englich].

	* ideal/simple-restraint.cc: (distortion_score_plane_internal):
	Don't do things for atom index -1.

2006-07-24  Paul Emsley  <paulemsley@ysbl.york.ac.uk>

	* doc/user-manual.texi (masks): mask-map-by-molecule not
	mask-map-by-protein.

	* src/graphics-info-defines.cc: (check_if_in_pepflip_define): do a
	redraw of the graphics after a pepflip.

2006-07-22  Paul Emsley  <paulemsley@ysbl.york.ac.uk>

	* macros/glut.m4 (AM_PATH_GLUT): Add i686-apple-darwin* option.

2006-07-17  Paul Emsley  <paulemsley@ysbl.york.ac.uk>

	* coot-utils/coot-shelx-ins.cc: move the precision setting out of
	the format statement [ooops!] - fixes Doug Kuntz bug.

2006-07-28  Paul Emsley  <emsley@ysbl.york.ac.uk>

	* build-it: Fix position of test of status of making guile.

	* README: Removed the joke at the start of the README.  It is
	stale and misleading and I am not sure anyone got the joke (the
	URL no longer gave a useful page).

2006-06-23  Paul Emsley  <emsley@ysbl.york.ac.uk>

	* ligand/find-ligand.cc (main): add wiggly [flexible] ligand option.

	* src/molecule-class-info-other.cc: (delete_residue_with_altconf):
	when we have a shelxl molecule with just 1 alt conf left, set the
	remaining occs to 11.0.

2006-06-16  Paul Emsley  <emsley@ysbl.york.ac.uk>

	* coords/Bond_lines.cc: (construct_from_asc): Don't draw unbonded
	hydrogens if the we are not drawing hydrogens.  Fixed bug of
	Donnie B.

2006-06-22  Paul Emsley  <paulemsley@ysbl.york.ac.uk>

	* ligand/ideal-rna.cc: (make_molecule): put the antisense residues
	in the chain in reverse order [so that they appear in the pdb file
	in increasing order] by using a vector of residues.

2006-06-08  Paul Emsley  <emsley@localhost>

	* sequence-view/sequence-view.cc: (mol_to_canvas): check that
	strand is non-null before doing anything with it.  Fixes crash
	with 1h5w reported by Roeland Boer [rbocri@cid.csic.es].

2007-06-05  Paul Emsley  <emsley@ysbl.york.ac.uk>

	* ideal/simple-restraint.cc: (find_link_type): Allow D-peptides as
	well as L-peptides.

2006-06-05  Paul Emsley  <emsley@ysbl.york.ac.uk>

	* geometry/protein-geometry.cc: (init_standard): use CLIBD_MON if
	it is set.

2006-06-04  Paul Emsley  <emsley@ysbl.york.ac.uk>

	* src/molecule-class-info-widget-work.cc:
	(fill_ncs_control_frame_internal): don't test for display_it_flag
	before setting the toggle button.  [Actually, that whole frame
	should be desensitised according to display_it button state].

2006-05-24  Paul Emsley  <paulemsley@ysbl.york.ac.uk>

	* src/c-interface.h: enable documentation for superpose functions.

2006-05-22  Paul Emsley  <paulemsley@ysbl.york.ac.uk>

	* src/c-interface.cc:
	read_phs_and_make_map_using_cell_symm_from_mol renamed to
	read_phs_and_make_map_using_cell_symm_from_mol_using_implicit_phs_filename.
	read_phs_and_make_map_using_cell_symm_from_previous_mol created.
	read_phs_and_make_map_using_cell_symm_from_mol created.  So that
	putting phs data on the command line will use the given pdb.
	command line data handling needs to be call this function.

	(add_filename_filter_button): filter button created.

	(set_file_selection_pre_filtered): function created.  To satisfy
	Phil, I think.

	* coot-utils/coot-shelx-ins.cc: (write_ins_file): use precision(9)
	when outputting coords - stops [unreadable] accidental exponential
	output formatting.

	* src/c-interface-build.cc: (set_undo_molecule): Allow the setting
	of the undo molecule to a molecule that might have 0 selected
	atoms [e.g. we have a ligand as a molecule and accidently delete
	it]

2006-05-21  Paul Emsley  <paulemsley@ysbl.york.ac.uk>

	* src/c-interface-build.cc: (ideal_nucleic_acid): downcase the
	sequence.

2006-05-30  Paul Emsley  <emsley@ysbl.york.ac.uk>

	* src/c-interface.cc: (get_text_for_aniso_limit_radius_entry):
	don't write over the end of the malloced memory.

2006-05-19  Paul Emsley  <emsley@ysbl.york.ac.uk>

	* Release 0.1.1

2006-05-15  Paul Emsley  <emsley@ysbl.york.ac.uk>

	* src/c-interface-build.cc:
	(save_symmetry_coords_from_fileselection): remove origin pre-shift
	from trans of symm atom before writing coords.

2006-05-11  Paul Emsley  <emsley@ysbl.york.ac.uk>

	* coords/Bond_lines.cc: (construct_from_asc): Added in cross-bonds
	to hydrogens that don't have bonds.  Blasted hydrogens will no
	longer seem to disappear.

2006-05-10  Paul Emsley  <emsley@ysbl.york.ac.uk>

	* src/molecule-class-info.h: ghost_molecule_display_t, cleaned up
	usage of display_it_flag [valgrind was complaining [rightly]].

2006-05-09  Paul Emsley  <emsley@ysbl.york.ac.uk>

	* src/c-interface.cc: (set_show_unit_cells_all): Check maps too!
	[PRE].

	* src/callbacks.c (on_unit_cell_no_radiobutton_toggled): unit cell
	radio button callbacks added.  Now these radio button pair has
	immediate effect [PRE].

2006-04-25  Paul Emsley  <emsley@ysbl.york.ac.uk>

	* src/molecule-class-info.cc: (add_typed_pointer_atom): Set
	attributes correctly for user-typed pointer atom.

2006-04-24  Paul Emsley  <emsley@ysbl.york.ac.uk>

	* ligand/Makefile.am: Use libcoot-ligand.la throughout.

2006-04-24  Paul Emsley  <emsley@ysbl.york.ac.uk>

	* src/rama_plot.cc: (draw_2_phi_psi_sets_on_canvas): remove bad
	shadowing of loop variable. [FR].

	* src/molecule-class-info-other.cc: proper syntax for
	coot::nomenclature [remove extra qualification] [FR].

	* src/molecule-class-info-ncs.cc: make
	copy_residue_range_using_from_ncs_master_to_other_using_ghost()
	return a value [FR].

2006-04-19  Paul Emsley  <emsley@ysbl.york.ac.uk>

	* src/c-interface.cc: (set_graphics_window_size) add
	use_graphics_interface_flag protection.

2006-04-17  Paul Emsley  <emsley@ysbl.york.ac.uk>

	* src/c-interface-info.cc: (place_text), (remove_text) Added
	fuctions.  Add 3-d text [the text doesn't rotate, it stays
	readable].

	* src/c-interface.cc: Created function get_monomer() from the
	internals of handle_get_libcheck_monomer_code().  get_monomer()
	can be used from the scripting layer.

	* src/c-interface.cc (safe-scheme-command).  Now returns a value,
	SCM, which can be decoded in the calling function.  A good thing.
	[This means that libguile.h had to be included in c-interface.h].	    

2006-04-15  Paul Emsley  <emsley@ysbl.york.ac.uk>

	* coot-utils/peak-search.hh (coot): remove extra qualification for
	find_protein_to_origin_translations() [test compile with 4.1.0].

2006-04-14  Paul Emsley  <emsley@ysbl.york.ac.uk>

	* src/molecule-class-info.h: remove molecule_class_info_t from
	function declaration for change_chain_id_with_residue_range [DB].

	* src/rama_plot.hh: remove coot::rama_plot:: from function
	declaration for get_phi_psi [DB].

	* coot-utils/coot-map-heavy.hh (ffear_search): remove class
	component of function name for
	filter_by_distance_to_higher_peak() [also DB].

	* coords/Cartesian.h: add proper declaration of friend functions.
	Ancient broken code (however did it compile before?)!  Compilation
	problem spotted Donnie Berkholz.

2006-04-12  Paul Emsley  <emsley@localhost>

	* src/molecule-class-info-mutate.cc (mutate_base_internal): Allow
	Ud and Tr as possible bases from which to mutate.

2006-04-13  Paul Emsley  <paulemsley@ysbl.york.ac.uk>

	* ligand/wiggly-ligand.cc: Added #include for coot-utils.hh, it
	seems to be needed in the case where GSL is not defined?  Anyway,
	no harm in explicitly including it.

2006-04-11  Paul Emsley  <paulemsley@ysbl.york.ac.uk>

	* src/graphics-info-navigation.cc: (fill_go_to_atom_residue_list):
	make the 2000 residue item limit change to 20000.  Now the widget
	behaviour is different, but you can exapand chains past the G
	chain [the 2000th residue] individually.  This is better, I suppose.

2006-04-11  Paul Emsley  <emsley@ysbl.york.ac.uk>

	* src/graphics-info.cc: (apply_undo): Update the ramachandran plot
	[if it exists for this molecule].

	* coot-utils/coot-utils.cc: (create_directory): moved body of
	make_directory_maybe here and changed logic of fstat vs is_dir
	tests so that we don't test for a directory before file exists.

2006-04-04  Paul Emsley  <emsley@ysbl.york.ac.uk>

	Release 0.1

	* src/graphics-info-modelling.cc:
	(new_alt_conf_occ_adjustment_changed): Don't change the alt conf
	for fully occupied atoms.

2006-04-03  Paul Emsley  <emsley@ysbl.york.ac.uk>

	* src/callbacks.c (on_rotate_translate_obj_cancel_button_clicked):
	COOT_ROTATE_TRANSLATE_DIALOG remembers where it was put when we
	press the Cancel button.

2006-04-01  Paul Emsley  <emsley@ysbl.york.ac.uk>

	* src/c-interface-build.cc (delete_residue_range): check the
	status of the "Keep Active" dialog before trying to close the
	dialog.  Bug reported by Bernhard Lohkamp.

2006-03-30  Paul Emsley  <paulemsley@ysbl.york.ac.uk>

	* src/c-interface-waters.cc (renumber_waters): function added

	* src/molecule-class-info-other.cc (renumber_waters): function
	added. 

	* src/c-interface.cc: (auto_read_make_and_draw_maps): if "FWT",
	"DELFWT" column labels fail, try "2FOFCWT" and "FOFCWT" also.

	* src/rama_plot.cc: created function phi_psi_pair_helper_t
	make_phi_psi_pair() which is the engine for making phi/psi pairs
	from 2 chains.  Uses new utility function std::pair<short int,
	coot::phi_psi_t> get_phi_psi().  

	The GUI menu item has been renamed to "Kleywegt Plot" as per
	conversation with George Sheldrick.

2006-02-26  Paul Emsley  <emsley@ysbl.york.ac.uk>

	* ligand/Makefile.am (test_fffear_in_coot_LDADD): Add coot-compat
	to get the correct getopt_long() as suggested by Ezra.

	* src/main.cc and cmtz-cinterface.cc: Patch as Ezra suggests
	commenting out NLS code.

2005-12-02  Paul Emsley  <emsley@ysbl.york.ac.uk>

	* coords/Bond_lines.cc: (do_colour_by_chain_bonds) and
	(do_colour_by_molecule_bonds): both now look at the atom element
	and draw_hydrogens_flag.  Also removed atom selection indexing and
	just just atom pointers (which should be propogated to other
	functions in this class).

2005-12-01  Paul Emsley  <emsley@ysbl.york.ac.uk>

	* src/c-interface.cc: (apply_bond_parameters): remove looking for
	the "carbons only" checkbuton.

2005-11-30  Paul Emsley  <emsley@ysbl.york.ac.uk>

	* src/molecule-class-info.cc:
	(initialize_coordinate_things_on_read_molecule_internal): add
	setting of the [initial] bond colour map rotation step and "doit"
	flag.

2005-11-12  Paul Emsley  <emsley@ysbl.york.ac.uk>

	* src/molecule-class-info.cc: (insert_coords_chage_altconf) and
	(insert_coords_atoms_into_residue_internal): Add shelx occupancy.
	-1 is used when this is not from a shelx file.

	* coot-utils/coot-shelx-ins.cc: Add add_fvar function which added
	a free variable and returns the index of the new free variable

	* coords/mmdb.cc: (get_atom_selection): added ifdefs for
	HAVE_MMDB_IGNORE_HASH.  May need to sort this out by hand.

2005-11-11  Paul Emsley  <emsley@ysbl.york.ac.uk>

	* src/molecule-class-info-widget-work.cc:
	(ncs_control_change_ncs_master_to_chain_update_widget): created.
	When we change the NCS master the toggle buttons for the displayed
	ghost chains need to change too.

2005-11-10  Paul Emsley  <emsley@ysbl.york.ac.uk>

	* src/cmtz-interface.cc: (get_f_phi_columns): use try/catch
	mechanism to stop crash on trying to CCP4MTZfile::open_read a cif
	file.

2005-11-06  Paul Emsley  <emsley@ysbl.york.ac.uk>

	* The move to CCP4 distribution of fftw, cmtz, cmap, mmdb, ssm,
	clipper libraries.  Substantial changes not documented here.

	This diff is 38,000 lines.

	mmtz and mmtz-extras have gone.  New clipper-based mtz looking
	routine added (cmtz-interface.cc).

	Crystal and dataset info now appear in the mtz column chooser and
	this had to be accounted for, so much splitting and recombining of
	strings (new functions added).

	macros updates to match ccp4 placing of include files.
	
	The autobuilder is updated.


2005-11-05  Paul Emsley  <emsley@ysbl.york.ac.uk>

	* geometry/protein-geometry-mmdb.cc (comp_atom_pad_atom_name): I
	was getting the atom name wrong for "CCB" with element "C", so now
	a check is made to see if first letter is the element name.

2005-10-31  Paul Emsley  <emsley@ysbl.york.ac.uk>

	* macros/with-guile.m4, macros/with-python.m4: applied Ezra's
	patch to use AM_CONDITIONAL to get to the wrapped guile interface.

2005-10-30  Paul Emsley  <emsley@ysbl.york.ac.uk>

	* src/c-interface.cc: (handle_read_draw_molecule_with_recentre):
	add statusbar text when the molecule fails to read.

2005-10-29  Paul Emsley  <emsley@ysbl.york.ac.uk>

	* src/globjects.cc (key_press_event): add call to new scheme
	function graphics-general-key-press-hook for as yet undefined
	keys [Bryan Lepore].

2005-10-19  Paul Emsley  <emsley@localhost>

	* src/c-interface.cc: (another_level_from_map_molecule_number):
	only try to mess with the contor levels of molecule istat if istat
	is not an error [-1, e.g. from map, not mtz file].  Fixes
	another-level crash.

2005-10-18  Paul Emsley  <emsley@localhost>

	* coot-utils/coot-fffear.cc: file created.  For fffear class,
	moved out of coot-map-heavy.cc

	* coot-utils/coot-coord-utils.cc (pad_atom_name): copied from
	geometry class.  Should rationalize at some stage.

	* coot-utils/coot-shelx-ins.cc: (make_atom_name): new version
	which uses atom element and calls new util function
	pad_atom_name().

2005-10-16  Paul Emsley  <paulemsley@ysbl.york.ac.uk>

	* src/graphics-info.cc: (drag_refine_refine_intermediate_atoms):
	created.  Function for Frank von Delft.

	* src/globjects.cc: (glarea_motion_notify): if dragged refinement
	intermediate refinement set then refine intermediate atoms.

	* src/molecule-class-info-other.cc: (add_OXT_to_residue): instead
	of finding total 4 atoms, check that each of them has been
	found. Now we can add OXT to residues with an alt conf.

2005-10-04  Paul Emsley  <emsley@ysbl.york.ac.uk>

	* src/graphics-info-pick.cc
	(rotate_intermediate_atoms_round_screen_x): function created.
	Called by rotate_intermediate_atoms_maybe().

	* src/globjects.cc: (glarea_motion_notify):
	rotate_intermediate_atoms_maybe() now has axis argument and uses y
	diff for rotation round the screen X axis.

2005-09-23  Paul Emsley  <emsley@ysbl.york.ac.uk>

	* src/graphics-info-state.cc: (save-state_command): If
	contoured_by_sigma_p() I meant to push back command strings, not
	display strings.  Fixes saving contour state issue for Bob Nolte.

	* src/graphics-info-graphs.cc: (rotamers_from_mol): use dunbrack
	constructor that adds extra PHE/TYR.

2005-09-20  Paul Emsley  <emsley@ysbl.york.ac.uk>

	* coot-utils/peak-search.cc: (get_peaks): don't move the negative
	cluster centres to local peak.

	* ligand/ligand.cc: (fit_ligand_to_cluster): Try each orientation
	eigen.  Changed [created a version with extra args of the eigen
	ori] of transform_ligand_atom() and fit_ligand_copy().  

	(calculate_cluster_centres_and_eigens): After sorting the eigen
	values, check the matrix determinant.  If negative, swap axes 2
	and 3. No longer inverts [chiral] ligands.

	* coot-utils/peak-search.cc: (get_peaks): Don't used
	move_grid_to_peak on cluster centres of negative peaks.

2005-09-19  Paul Emsley  <emsley@ysbl.york.ac.uk>

	* coords/Bond_lines.cc: (handle_MET_or_MSE_case): Add alt conf
	testing to bonds.  Also changed CYS case.

	* ligand/ligand-extras.cc: (fit_water_internal): major rewrite.
	Now uses list for clusters rather than vector.  We only calculate
	clusters once.  Sphericity test has been removed.

2005-09-16  Paul Emsley  <emsley@ysbl.york.ac.uk>

	* ideal/simple-restraint.cc: (make_link_restraints): test for
	neighbouring residues [by residue seq number].  Fixes problem of
	refining next to residue with all atoms in alt confs.

	* src/molecule-class-info-other.cc:
	(do_180_degree_side_chain_flip): make the alt conf work by using a
	residue copy.

2005-09-15  Paul Emsley  <emsley@ysbl.york.ac.uk>

	* geometry/protein-geometry.cc: (try_dynamic_add): Add in logic to
	try to find "XXX-b-D.cif" or "XXX-a-L.cif"

	* ideal/simple-restraint.cc: (find_link_type): override the return
	value of find_glycosidic_linkage_type() until
	find_glycosidic_linkage_type() returns sensible result.  Fixing
	flying carbohydrate.

2005-09-12  Paul Emsley  <paulemsley@ysbl.york.ac.uk>

	* src/molecule-class-info-other.cc: (make_ball_and_stick): put the
	glMaterialfv() call for specular inside the bond loop to colour
	for bond type and comment out GL_AMBIENT_AND_DIFFUSE and
	GL_EMISSION [no idea why they were there - not clear thinking...].
	Ball and stick looks good now.  I need to be able to remove the
	object at some stage.
 
2005-09-11  Paul Emsley  <paulemsley@ysbl.york.ac.uk>

	* src/graphics-info-defines.cc:
	(other_modelling_tools_toggle_button_name_list): correct name of
	cis/trans button.

	* ligand/residue_by_phi_psi.cc: extract function
	build_C_terminal_ALA() and build_N_terminal_ALA() out of
	residue_by_phi_psi class [from
	construct_prev_res_from_rama_angles() and
	construct_next_res_from_rama_angles()].

	* ligand/helix-placement.cc: (build_on_N_end, build_on_C_end,
	trim_end, build_N_terminal_ALA, build_C_terminal_ALA): created to
	extend or trim the placed helix.

	* src/graphics-info-render.cc: (povray): Move the eye back.
	(povray_molecule): change the scale of the rendered objects to 1.0.

2005-09-08  Paul Emsley  <emsley@ysbl.york.ac.uk>

	* mini-mol/mini-mol.cc: add occupancy characteristic to a minimol
	atom.  Update pdb reading and writing.

	* ligand/ligand.cc: (get_rigid_body_angle_components): The scaling
	of the gradients to [angle] steps was too high, leading to
	overstepping the minimum and therefore oscillations.  0.03 changed
	to 0.01.  Resulting in more rapid and more robust rigid body
	refinement now.

2005-09-06  Paul Emsley  <emsley@ysbl.york.ac.uk>

	* ligand/find-ligand.cc (main): corrected usage text.

2005-09-05  Paul Emsley  <emsley@ysbl.york.ac.uk>

	* src/c-interface.cc: (parse_ccp4i_defs): line length limit was
	100 chars on read.  How *could* I have been so short-sighted?
	expanded to 1000.  Fixes crash reported by Lari Lehtiö I hope.

2005-09-02  Paul Emsley  <emsley@ysbl.york.ac.uk>

	* src/molecule-class-info-other.cc:
	(change_chain_id_with_residue_range): Fix crash reported by GSK's
	Nino: ie. crash when Change Chain ID residue range to a chain id
	that already exists [nresidues -> to_chain_nresidues].

2005-09-01  Paul Emsley  <emsley@ysbl.york.ac.uk>

	* src/callbacks.c (on_raster3d1_activate): and friends.  Added
	default filename.
	
	* ccp4mg-utils/Makefile.am: Clean up Makefile.am [remove the fink
	hardcoding of CXXFLAGS for png].  PNG is not available then.

	* src/graphics-info.cc: (update_residue_by_chi_change): update
	chi_ang.change_by() to use pointer to Geom.

	* src/c-interface-ligands.cc: (execute_ligand_search): update
	install_simple_wiggly_ligands call to pass the pointer to Geom.

	* geometry/protein-geometry.cc:
	(get_monomer_torsions_from_geometry): now we have dynamic add,
	this function is not const.

2005-08-31  Paul Emsley  <paulemsley@ysbl.york.ac.uk>

	* src/callbacks.c (on_screendump_image_ok_button_clicked):
	Created. Call the image creation functions according to
	fileselection type.

	* src/c-interface.cc: (make_image_raster3d) and
	(make_image_povray) functions created to be used by new Snapshot
	menu items.

	* coot-utils/coot-shelx-ins.cc: (make_atom): abstracted out to
	make the keyword conditions a bit more readable.  Fixed read of
	isotropic B factor and keep HKL card for output.  As per GMS
	instructions.

	(write_ins_file): use function remove_leading_spaces for the atom
	names.

	* coot-utils/coot-utils.cc: (remove_leading_spaces): function
	created [used for shelx output atom names].

	* src/graphics-info-defines.cc
	(check_if_in_reverse_direction_define): Created for new button on
	other modelling tools menu. (setup_reverse_direction) created too
	in c-interface-build.cc

2005-08-29  Paul Emsley  <paulemsley@ysbl.york.ac.uk>

	* geometry/protein-geometry.cc:
	(get_monomer_torsions_from_geometry): try_dynamic_add was not
	being used if the monomer_type was not found in the list.  It is
	now.  This needs to be passed read_number.

	* src/graphics-info.cc: (set_transient_and_position): a copy of
	the c-interface.cc's function - so that widgets created from
	inside graphics-info.cc can be transiented and positioned
	[e.g. chi angles and rotamers].  Needed the creation of
	(positioned-widgets.h) which is included by c-interface.cc,
	callbacks.c and graphics-info.cc.

	* high-res/high-res.cc: (buccafilter): removed the
	fragment-sort-by-length.

2005-08-25  Paul Emsley  <paulemsley@ysbl.york.ac.uk>

	* analysis/bfkurt.cc: Tidied up with unsigning the for loop ints.
	Also pass extra flag to write_table that allows the output of
	every residue, not just the questionables.

	* src/molecule-class-info.cc: (mutate): 5364 uncommented and
	repositioned the DeleteSelection().  Or it should be. check me.

2005-08-23  Paul Emsley  <paulemsley@ysbl.york.ac.uk>

	* doc/user-manual.texi (SHELX .ins/.res files): section created.

	* coot-utils/coot-shelx-ins.cc: (debug) added.

	* src/molecule-class-info-other.cc:
	(reverse_direction_of_fragment): Given a residue spec, find the
	fragment that that residue was in and reverse the direction of
	that fragment leaving only CAs.

	* src/c-interface-build.cc: (fill_partial_residues): function
	created.  Uses the new missing_atoms() function.

	* src/molecule-class-info-other.cc (missing_atoms): created.  Do a
	check against the atom names in the dictionary and return a class
	that contains a vector of CResidue *s of atoms that don't have all
	their atoms.

	* coot-utils/coot-coord-extras.hh: Added missing atom helper classes.

	* src/graphics-info-pick.cc: (symmetry_atom_pick): Kevin inserted
	some throw/catch code here on the setting of the space group name.
	Also, construct the space group from the symops, not the space
	group name.

	* coords/Bond_lines.cc: (handle_MSE_case) changed considerably.
	Also handled here now are CYS and MET.  The normal construct bond
	length limit has been reduced to 1.7A [whcih left Sulfur bonds
	which this routine deals with].

	* coot-utils/coot-shelx-ins.cc: (symm_card_composition_t): correct
	the indexing of the ele array to set the symmetry card correctly
	[rather than totally mis-indexed, as it had been].

	* src/graphics-info-defines.cc:
	(check_if_in_180_degree_flip_define): created and extensive
	changes.  Ligand fitting was moved out of the model/fit/refine
	dialog and the 180 degree flip moved in.  A mol is created from
	the residue, so that we can call update_geometry_graphs [which has
	presumed an intermediate atom molecule], so that 180 degree flips
	can upate the rotamer graph. A chi_angles function
	rotate_chi2_180() was created.

	* src/c-interface.cc: (handle_read_draw_molecule_with_recentre):
	rather than use the shelx split in get_atom_selection(), where a
	normal atom_sel is returned [and the ShelxIns is lost], we call
	read_shelx_ins_file directly and molecule_class_info_t keeps the
	ShelxIns.  Now shelx ins files can be output.

	* coords/Bond_lines.cc: (add_atom_centres): put a lower limit on
	the occupancy needed to have a zero occ spot, so that shelx
	molecule with occ -61 is correctly represented.

2005-08-21  Paul Emsley  <paulemsley@ysbl.york.ac.uk>

	* ligand/chi-angles.cc: (add_IUPAC_extras_PHE_and_TYR_rotamers):
	new function created. Used in intialization of chi angles.  We add
	extra rotamers for PHE and TYR to cope with the 180 degree flip to
	match IUPAC convention, but rotamer there didn't exist.

2005-08-13  Paul Emsley  <emsley@ysbl.york.ac.uk>

	* high-res/high-res.cc: buccafilter() function created and also
	function to add cbetas and o positions.  Had 2 goes at the
	filtering.  The first was to average the position of the similarly
	placed atom - but it was too complex.  So I then tried scoring by
	fragment length then just deleting the other atoms if they
	overlapped.

	* mini-mol/mini-mol-utils.cc (o_position, cbeta_position): created
	file and functions and added to Makefile.am These are called by
	post-buccaneer filtering.

2005-08-12  Paul Emsley  <emsley@ysbl.york.ac.uk>

	* setup/coot.sh.in: and coot.csh.in.  Don't override the
	PYTHONPATH if it was set already.

2005-08-08  Paul Emsley  <emsley@ysbl.york.ac.uk>

	* src/callbacks.c:
	on_residue_info_b_factor_apply_all_checkbutton_toggled and
	on_residue_info_occ_apply_all_checkbutton_toggled: toggle the
	sensitivity of the entries so that people can't make edits until
	the edits are active.
 
2005-08-04  Paul Emsley  <emsley@ysbl.york.ac.uk>

	* src/globjects.cc: scroll-wheel event handling altered - no
	longer can get maps that can be increased in level, but not
	decreased.

	* doc/user-manual.texi (Maps in General): Add documentation for
	"Expert mode".

2005-08-03  Paul Emsley  <emsley@ysbl.york.ac.uk>

	* src/read-phs.c: add stdio for clean compile.

	* src/c-inner-main.c: Add string.h and stdio for a clean compile.

	* src/gtk-manual.c: include stdio.h, stdlib.h and string.h to
	clean the compilation on GCC 4.0 (FC4).

	* src/read-cif.c: include stdio.h to declare printf()

	* src/c-interface-superpose.cc: (superpose_with_chain_selection)
	add ifdef HAVE_SSMLIB to this function [Jinghua Tang reported the
	compilation error].

2005-08-02  Paul Emsley  <emsley@ysbl.york.ac.uk>

	* coords/Bond_lines.cc: (do_Ca_plus_ligands_bonds): ooops, remove
	tmp debugging line that set atom_colour_type to COLOUR_BY_RAINBOW
	for everything.

2005-07-28  Paul Emsley  <emsley@ysbl.york.ac.uk>

	* high-res/globularize.cc: globularize_protein now takes
	--centre-x [etc] arguments.

2005-07-26  Paul Emsley  <emsley@ysbl.york.ac.uk>

	* geometry/protein-geometry.cc: now partial charges are not needed
	for the dictionary to read correctly.

2005-07-25  Paul Emsley  <paulemsley@ysbl.york.ac.uk>

	* Fixed: Alt conf split on water [ignores the value in the dialog].

	* Fixed: occupancy of remaining single atoms set to 1.0 on deletion.

	* Fixed: set the cell and symmetry in setup of minimol.

	* Fixed: remove the Control Delete description [it doesn't work].

	* The water distance validation check now works.

	* Update: Go To Atom window after renumber-residue-range.

	* scheme/fitting.scm: added fit-waters function.  Needed 
	  atom_index_first_atom_in_residue() function.

	* Fixed: waters added to protein model with no waters had the waters 
	  added to the last chain [instead of a new chain].
	
	* Created: high-res/globularize.cc 
	
2005-06-30  Paul Emsley  <paulemsley@ysbl.york.ac.uk>

	* Release 0.0.33

2005-06-29  Paul Emsley  <paulemsley@ysbl.york.ac.uk>

	* src/graphics-info-state.cc: (save_state_file): use
	molecule_count to find the go_to_atom_molecule for the output
	script [not i].

	* src/molecule-class-info.cc: (insert_waters_into_molecule):
	Create insert_waters_into_molecule() and rename old function of
	that name to append_to_molecule(). insert_waters_into_molecule()
	checks that we have a solvent chain, and if it does then add
	waters to that chain, not create a new chain.

	* analysis/bfkurt.cc: (stats) Add a new element to store the
	residue name [and then use it to label the b-factor validation
	graph blocks].

2005-06-28  Paul Emsley  <paulemsley@ysbl.york.ac.uk>

	* src/c-interface.cc: (new_close_molecules): it is not an error
	for the sequence view not to be displayed.

2005-06-28  Paul Emsley  <emsley@localhost>

	* ligand/chi-angles-autogen.cc (add_all_rotamers): generated new
	chi-angles-autogen.sh, but I needed to kludge in a MSE rotamer so
	that we didn't get 100s of the "Oops, MSE not found in
	typed_rotamers" messages in the console.

	* ligand/read-dunbrack.awk: if chi2 for TYR and PHE is > 90, take
	180 from the angle to fit to IUPAC nomenclature.

2005-06-28  Paul Emsley  <paulemsley@ysbl.york.ac.uk>

	* src/graphics-info.cc: (smooth_scroll_maybe) get an extra pair of
	args, a target zoom and a flag.  Now reset view has animate zoom
	too.

	* src/molecule-class-info.cc: (display_bonds): Put if test round
	set_bond_colour_by_mol_no(), suggested by Ezra Peisach.

2005-06-27  Paul Emsley  <paulemsley@ysbl.york.ac.uk>

	* src/molecule-class-info-other.cc: (cis_trans_convert) and
	(cis_trans_convertion) created for CIS <-> TRANS conversion and
	other graphics_info_t and c-interface infrastructure to deal with
	it.

	* "Other Modelling Tools" menu item and dialog created.

	* src/command-line.cc (handle_command_line_data): add --auto
	handler [which does auto_read_make_and_draw_maps].

	(parse_command_line): add --auto command-line option.

2005-06-26  Paul Emsley  <paulemsley@ysbl.york.ac.uk>

	* mapview.glade: move Residue/monomer to top of list.

	* src/callbacks.c (on_run_refmac_run_button_clicked): Add some
	debugging.

	* src/c-interface-build.cc: (wrapped_create_delete_item_dialog):
	If we were in water delete mode, then set the appropriate radio
	button.

	* src/graphics-info.cc: (execute_rotate_translate_ready): Swap
	from copying the whole of the molecule to using a residue
	selection and using create_mmdbmanager_from_res_selection().
	Fixes memory leak hopefully and allows CA mode for intermediate
	atoms without crashing on accept of the moving atoms.

2005-06-25  Paul Emsley  <paulemsley@ysbl.york.ac.uk>

	* src/graphics-info.cc: (make_moving_atoms_graphics_object): Make
	bonds in CA mode if the moving atoms molecule was in CA mode.

	* src/graphics-info-pick.cc:
	(move_moving_atoms_by_simple_translation): Make bonds in CA mode
	if the moving atoms molecule was in CA mode.

	* src/c-interface.cc (map_scroll_wheel_mol_selector_activate):
	Call activate_scroll_radio_button_in_diplay_manager() so that the
	display manager is consistent.

2005-06-24  Paul Emsley  <paulemsley@ysbl.york.ac.uk>

	* src/graphics-info-graphs.cc: (rotamer_graphs): in missing atoms
	case, set a string_user_data to signal missing data and in
	geometry-graphs.cc's plot_block change the colour of the block for
	missing atoms case.

2005-06-23  Paul Emsley  <paulemsley@ysbl.york.ac.uk>

	* ligand/dunbrack.cc: (probability_of_this_rotamer): Kludge the
	residue type to MET from MSE *after* the atom pairs have been
	assigned.  Fixes Juergen Bosch "MSE in rotamer graph bug".

	* geometry/protein-geometry.cc: (init_refmac_mon_lib): use the
	read_number_in to determine if this file should update the
	chem_comp info [in the refmac libs, the chem_comp information is
	given twice, in the mon_lib_list.cif and a/ALA.cif - we only want
	the second one or we get allresidues added to the dictionary
	[which may not be a bad thing for the future]].

	* ideal/simple-restraint.cc: (find_link_type): created.  Given 2
	residues and the dictionary, find the linkage type.  

	* (find_glycosidic_linkage_type): for pyranoses and furanoses.
	This is just a stub function at the moment.  It should be filled
	and return the correct linkage.  We need to find the anomericity
	of the linking oxygen.  There are issues of the linking oxygen -
	the convention in refmac might be different to conventional
	biochemistry.  Needs investigation at some stage.

2005-06-22  Paul Emsley  <paulemsley@ysbl.york.ac.uk>

	* src/graphics-info-navigation.cc: (split_resno_inscode): allow
	for residues with negative residue numbers.  Fixes bug reported by
	Qingping Xu.

	* geometry/protein-geometry.cc: (chem_comp),
	(mon_lib_add_chem_comp): created.  mon_lib_add_chem_comp() does
	the trashing of the old residue restraints so that a new file will
	update create a new usable library.  mon_lib_add_chem_comp() adds
	monomer information such as the group [e.g. "L-peptide"] used in
	determining the linkage type.

	(init_refmac_mon_lib): now takes a read_number argument.

	Why the read number?

	Currently [20050620] the way the restraints are found is FIFO.  we
	start from entry 0 and check upwards for the matching
	residue/monomer type.

	But we need to be able to "override" the current restraints by
	reading in a new file.  How do we do that?

	When reading in a restraint and trying to add it, we find that a
	dictionary entry for that residue type exists.  Do we want to
	override it?

	In init_refmac_mon_lib() we would want to check through
	dict_res_restraints for the existance of this restraint.  If it
	does exist, kill it by changing its name to blank.  However, we
	don't know the name of the restraint yet!  We only know that at
	the add_atom(), add_bond() [etc] stage.

	So, at each of those stages we need to know if this we are adding
	to an already existing dictionary entry or this restraint is from
	a different file to the previous entry.  We want to do different
	things they are different.

	* geometry/protein-geometry.cc: (clear_dictionary_residue): created.

	* src/graphics-info-pick.cc: (symmetry_atom_pick): On Kevin's
	advice add the string type to the constructor of the Spgr_descr.

	* coot-utils/coot-shelx-ins.cc: (read_file): On Kevin's advice add
	the string type to the constructor of the Spgr_descr.

2005-06-17  Paul Emsley  <paulemsley@ysbl.york.ac.uk>

	* src/c-interface-build.cc: (delete_atom): now calls simply
	go_to_atom_molecule() rather than look at the option menu to find
	the active position.  Fixes delete water crash [EJD, Bob Nolte].

	* src/c-interface.cc: (set_pick_cursor_index) added so that users
	can set their own pick cursor.

	* ideal/Makefile.am: noinst the programs here [test-indexing,
	with-map, with-geometry].

2005-06-16  Paul Emsley  <paulemsley@ysbl.york.ac.uk>

	* src/graphics-info.cc: (make_pointer_distance_objects): only draw
	pointer distances to displayed molecules.

2005-06-13  Paul Emsley  <paulemsley@ysbl.york.ac.uk>

	* ligand/find-waters.cc (main): add --chop functionality.

	* src/molecule-class-info-other.cc: (bad_chiral_volumes): return
	also a vector of residue types for which we fail to find
	restraints.  Use this to change the label of a warning pop-up.

	* coords/mmdb.cc: (get_atom_selection): IgnoreHash flag added.

	* db-main/db-main.cc: -Wall fixes.

	* geometry/protein-geometry-mmdb.cc (comp_atom_pad_atom_name):
	Properly pad hydrogen names of length 2. HH of TYR no longer
	explodes.

	* density-contour/CIsoSurface.cpp: (add): Ezra's suggestion 1 ->
	i.  2% better FPS.

2005-06-11  Paul Emsley  <paulemsley@ysbl.york.ac.uk>

	* ligand/ligand.cc: (mask_map): Make the mask_map functions
	consistent re: xmap_masked. 

	* coot-utils/trim.cc (trim_molecule_by_map): Add extra flag,
	waters_only.

	* ligand/find-waters.cc (main): add support for --chop flag,
	i.e. call trim_molecule_by_map() [with waters only].

2005-06-10  Paul Emsley  <paulemsley@ysbl.york.ac.uk>

	* ligand/find-waters.cc (main): Add --chop command line option.

	* src/main.cc: (show_citation_request): Add Refmac dictionary
	reference.

	* src/c-interface-info.cc: (output_residue_info): Handle Master
	Atom entries and check buttons.

	* src/graphics-info-defines.cc: (check_if_in_delete_item_define):
	Make checks for waters for residue and water modes.  Now waters
	can be deleted only in water mode, and residue in residue mode.

	* src/callbacks.c (on_delete_item_cancel_button_clicked): Add
	clear of pending picks on close [and also in the destroy
	callback], so that the graphics can rotate.

	* src/graphics-info.cc: (wrapped_create_edit_chi_angles_dialog):
	transiented dialog.

2005-06-09  Paul Emsley  <paulemsley@ysbl.york.ac.uk>

	* src/molecule-class-info.cc:
	(map_fill_from_mtz_with_reso_limits): Apply the *dataset* reso
	limit [rather than the mtz file reso limit] from Kevin for
	Eleanor.

2005-06-04  Paul Emsley  <paulemsley@ysbl.york.ac.uk>

	* src/molecule-class-info-ncs.cc: (fill_ghost_info) [and other
	upstream functions]: takes the argument of the [user-changable]
	homology level.

	* ideal/simple-restraint.cc: (minimize): change the meaning of the
	flag so that it controls the output of the *initial* chi squared.
	Now always on termination, we get to see the final chi squareds.

	* src/c-interface-info.cc: (apply_residue_info_changes): add a
	redraw when we finish.

	* src/Makefile.am move coot-shelx in the linking list.

	* ligand/Makefile.am add coot-shelx for findligand and findwaters.

2005-06-02  Paul Emsley  <paulemsley@ysbl.york.ac.uk>

	* src/graphics-info-state.cc: (save_state_file): Add [sleezy]
	molecule number usage to save the active and displayed state of
	molecules.

	* src/c-interface.cc (set_save_molecule_number): created for
	use in callback from callbacks.c 

	* src/callbacks.c (on_save_coordinates1_activate),
	graphics_info_t: change mechanism of passing the molecule number
	of coordinates to be saved, created graphics_info_t::save_imol.

	* src/c-interface-build.cc:
	(set_model_fit_refine_rotate_translate_zone_label) and
	(set_model_fit_refine_place_atom_at_pointer): add configurability
	to Model/Fit/Refine dialog.

	* src/molecule-class-info-other.cc: (find_water_baddies_OR): Added
	flags dependent on the value of the passed parameters.. maybe it
	would have been better to simply pass the flags too.

	* src/c-interface-validate.cc: (do_check_waters_by_widget): Add
	check buttons to Check/Delete water tests.  Add a list of usage
	flags that depend on the state of the "Active" checkbuttons.
	These alter the values that are passed to molecule_class_info_t's
	find_water_baddies().

2005-05-29  Paul Emsley  <paulemsley@ysbl.york.ac.uk>

	* src/c-interface-build.cc: (execute_refmac): Now that the
	coordinates use the conventional mechanism, I had to move from
	get_user_data on the active menu item and introduce and use a
	graphics_info_t static called refmac imol.

2005-05-28  Paul Emsley  <paulemsley@ysbl.york.ac.uk>

	* coot-utils/peak-search.cc: (get_peaks): New interface created
	that also uses a CMMDBManager. make_sample_protein_coords(),
	move_point_close_to_protein() and min_dist_to_protein() created to
	help out.

2005-05-27  Paul Emsley  <paulemsley@ysbl.york.ac.uk>

	* src/graphics-info-superpose.cc (superpose_with_atom_selection):
	Turn off symmetry on the molecule that has been superposed.

	* src/callbacks.c (on_save_coords_dialog_save_button_clicked):
	reworked the transfer of the save model info, from a pointer to a
	graphics_info_t static [save_imol].  Access is this static is
	provided at the c-interface:
	save_molecule_number_from_option_menu().
	
2005-05-26  Paul Emsley  <paulemsley@ysbl.york.ac.uk>

	* src/c-interface.cc: (fill_go_to_atom_window): completely gutted
	the option menu usage to make it conventional usage where we also
	pass the default molecule number.  Removed other version from the
	c-interface which did not use the molecule number.  Go To Atom and
	other option menus now work as they should [or seem to].

2005-05-25  Paul Emsley  <paulemsley@ysbl.york.ac.uk>

	* src/molecule-class-info-other.cc: (bad_chiral_volumes): added
	console message when the restraint was not found for that
	residue/monomer type.

2005-05-24  Paul Emsley  <paulemsley@ysbl.york.ac.uk>

	* src/molecule-class-info.cc: (draw_unit_cell_internal): change to
	segmented lines.

	* src/globjects.cc (key_press_event): add hooks for dot and comma
	pressed.

	* src/graphics-info-superpose.cc (superpose_with_atom_selection):
	After atom transformation, no longer show the symmetry of the
	moved molecule.

2005-05-23  Paul Emsley  <paulemsley@ysbl.york.ac.uk>

	* src/molecule-class-info.cc: (name_sans_extension): No longer
	ignore the include_path_flag.

	* src/c-interface.cc: (print_sequence_chain): Filled the stub.

	* setup/Makefile.am: moved coot.csh and coot.sh from bin_SCRIPTS
	to EXTRA_DIST.

2005-05-22  Paul Emsley  <paulemsley@ysbl.york.ac.uk>

	* src/c-interface.cc: (wrapped_create_display_control_window): The
	display manager was changed to a pane and the size parts of it get
	saved in a static.  Here we create the widget dependent on its
	bits [included the pane position].

	* src/callbacks.c (on_show_symmetry_ok_button_clicked): Use
	set_show_symmetry_master().

2005-05-19  Paul Emsley  <paulemsley@ysbl.york.ac.uk>

	* mapview.glade: removed "Import all Dictionary CIFs" too slow.
	Not needed now that we have "dynamic" addition of dictionary.

	* src/callbacks.c (on_model_refine_dialog_delete_button_clicked):
	If not atom mode, then set the residue delete mode [it may have
	been in residue hydrogens mode and previously it was getting stuck
	there].

2005-05-18  Paul Emsley  <paulemsley@ysbl.york.ac.uk>

	* cootrc: Buttons put in order and recoloured.

	* src/graphics-info-defines.cc:
	(model_fit_refine_button_name_list): add refmac button to list.

	* coot-utils/coot-shelx-ins.cc: (read_shelx_ins_file): substantial
	changes.  The latt card is used to generate the strings to init
	the clipper space group.

	* src/callbacks.c
	(on_mutate_sequence_do_autofit_checkbutton_toggled): fix the typo
	so that this checkbutton works correctly.

2005-05-17  Paul Emsley  <paulemsley@ysbl.york.ac.uk>

	* src/read-phs.c: (try_read_phs_file): pha [from SHELX] is a phs
	file too.

2005-05-15  Paul Emsley  <paulemsley@ysbl.york.ac.uk>

	* src/graphics-info.cc: (display_geometry_distance_symm): added
	distance to status bar.

2005-05-12  Paul Emsley  <paulemsley@ysbl.york.ac.uk>

	* coot-utils/coot-shelx-ins.cc: (read_file): added more shelx
	keywords so that Coot knows they are not atoms.

2005-05-11  Paul Emsley  <paulemsley@ysbl.york.ac.uk>

	* doc/user-manual.texi (set-scroll-by-wheel-mouse): add Ezra's doc
	fixes.

	* Release 0.0.32

2005-05-10  Paul Emsley  <emsley@localhost>

	* src/globjects.cc: (glarea_button_press): z_is_pressed
	non-clickable atoms problem fixed?

2005-05-09  Paul Emsley  <paulemsley@ysbl.york.ac.uk>

	* coords/Cartesian.cc: (on_a_face): include Ezra's NO_FACE
	cleanup.

	* build/Makefile.am (testcabuild_LDADD): Use .la linking [Ezra].

	* ligand/Makefile.am (findwaters_LDADD): better not to use the lib
	dir when the lib is in this directory [SMP - Ezra].

	* geometry/Makefile.am: As Ezra suggests, use .la linking.

	* src/globjects.cc: (display_density_level_maybe): apply Ezra's
	suggestion of removing the depth cueing for the density level
	text.

2005-04-26  Paul Emsley  <paulemsley@ysbl.york.ac.uk>

	* src/molecule-class-info.cc: (make_maybe_backup_dir): use umask
	to set the permission on coot-backup.

	(handle_map_colour_change): check for swapped difference map
	colours [fixes Dirk's bug].

	* src/callbacks.c (on_save_state_ok_button1_clicked): save state
	now connected to a fileselection for the state file.  This sets
	the static save_state_file_name.

2005-04-23  Paul Emsley  <paulemsley@ysbl.york.ac.uk>

	* coords/Bond_lines.cc: (addSymmetry_whole_chain): delete the
	atoms of transsel too.

2005-04-19  Paul Emsley  <paulemsley@ysbl.york.ac.uk>

	* src/callbacks.c (on_model_refine_dialog_delete_button_clicked):
	now this calls set_transient_and_position for the delete item
	dialog so it is recreated where it was last time.

	* src/c-interface.cc: (undo_last_move): created.  uses
	old_rotation_centre_? variables.  Bound to keyboard U.

2005-04-18  Paul Emsley  <emsley@localhost>

	* src/c-interface-preferences: add_status_bar_text() created.

	* pixmaps/coot-16-bevel.xpm make the hat top more orange [Neil
	Paterson].

2005-04-18  Paul Emsley  <paulemsley@ysbl.york.ac.uk>

	* src/graphics-info.cc: (execute_rotate_translate_ready): Use
	gtk_window_set_transient_for to keep rotate_translate on top.

	(do_accept_reject_dialog): Use gtk_window_set_transient_for to keep
	accept/reject window on top.

2005-04-15  Paul Emsley  <paulemsley@ysbl.york.ac.uk>

	* src/geometry-graphs.cc: close_yourself(); set the block to null
	in the vector if it has been deleted.

2005-04-09  Paul Emsley  <paulemsley@ysbl.york.ac.uk>

	* src/molecule-class-info.cc: (change_contour): allow contouring
	of negative peaks that are lower than the highest positive peak
	[Charlie Bond].

2005-04-08  Paul Emsley  <paulemsley@ysbl.york.ac.uk>

	* src/c-interface.cc: (auto_read_make_and_draw_maps): Make the FWT
	map be the one that scrolls, not the difference map [Randy Read].

2005-04-05  Paul Emsley  <paulemsley@ysbl.york.ac.uk>

	* src/c-interface.cc: (reset_view): Go to next molecule if we are
	already centred on one.

2005-04-02  Paul Emsley  <paulemsley@ysbl.york.ac.uk>

	* src/c-interface-superpose.cc: (superpose_with_atom_selection):
	created - you can superpose any atom selection now given an mmdb
	atom selection string.

	* src/molecule-class-info-other.cc: (find_water_baddies_AND): use
	map_sigma not map_sigma_in;

	* src/graphics-info-defines.cc:
	(check_if_in_edit_backbone_torsion_define) change = to == in if
	statement [sharp intake of breath when that was discovered!].

2005-04-01  Paul Emsley  <paulemsley@ysbl.york.ac.uk>

	* src/graphics-info.cc: (load_needed_monomers): fix indexing error
	- how did it ever work before?

2005-03-31  Paul Emsley  <paulemsley@ysbl.york.ac.uk>
		
	* Release 0.0.31

	* src/callbacks.c (on_delete_item_cancel_button_clicked): set the
	stored delete_item_widget pointer to NULL, fixed a crash when this
	was referenced by do_refine().

	* src/c-interface-build.cc: (wrapped_create_add_OXT_dialog): fixed
	option menu so internal status variable matched the displayed
	molecule option.

	* src/graphics-info-state.cc: (save_state_file): add status
	messages.

	* src/c-interface-build.cc:
	(wrapped_create_merge_molecules_dialog): fix option menu so
	internal variable matches the displayed molecule option.

2005-03-28  Paul Emsley  <paulemsley@ysbl.york.ac.uk>

	* src/graphics-info-pick.cc: (symmetry_atom_pick): override
	distance to centre limit when CA mode or whole chain mode [Fixes
	PRE bug?].

2005-03-25  Paul Emsley  <paulemsley@ysbl.york.ac.uk>

	* src/graphics-info-state.cc: (save_state_file): put show-symmetry
	after the molecules have been read.

	* src/c-interface.cc: (set_show_symmetry): display no symmetry
	popup warning only if there were models available.
 
2005-03-21  Paul Emsley  <paulemsley@ysbl.york.ac.uk>

	* skeleton/BuildCas.cc: (setup_internal): Fixed Ezra non-inited
	variable.

	* ideal/simple-restraint.cc: Ezra notes problems.  Fixed.

2005-03-20  Paul Emsley  <paulemsley@ysbl.york.ac.uk>

	* src/c-interface-build.cc (fit_loop_from_widget): created.  Now
	we can call scheme function (fit-gap ..) from interface.

	* src/c-interface.cc: (refine_zone): add valid model molecule
	protection [fixes fit-gap crash].

	(set_show_symmetry): Test for zero molecules that symmetry
	available [called from Cell & Symmetry OK button callback].

	* src/molecule-class-info.cc: (set_bond_colour_by_mol_no):
	rotation size multiplier is now non-zero for imol=0, so the colour
	map can be [is] also rotated for the 0th molecule.

	(draw_map_unit_cell): turn off the cell drawing when the map is not
	displayed.

	(draw_coord_unit_cell): turn off the cell drawing when the coords
	are not displayed.

2005-03-16  Paul Emsley  <paulemsley@ysbl.york.ac.uk>

	* src/gtk-manual.c:
	on_display_control_mol_displayed_button_toggled and friends
	gslist_for_scroll_in_display_manager_p() and scroll_radio_button_1
	in the display manager now gives us clickable scrollable map,
	rather than having to use the menus.  Horrah - within a minute I
	realise that it's a Good Thing.  Will this please Charlie Bond?

2005-03-15  Paul Emsley  <paulemsley@ysbl.york.ac.uk>

	* src/molecule-class-info.cc: (make_backup): don't test on
	n_selected_atoms, use mol [Joel Bard ligand deleting bug].

	(save_molecule_filename): use name_for_display_manager() if
	unpathed_backup_file_names_flag is set.

	* coords/Bond_lines.cc: (add_atom_centres) Don't add H atom
	centres when hydrogens are not drawn [Robin Owen bug].

2005-03-11  Paul Emsley  <paulemsley@ysbl.york.ac.uk>

	* src/main.cc: (check_reference_structures_dir): Created.

	* Release 0.0.30

	* doc/Makefile.am (user-manual.html): various fixes here to make
	things go on bubbles too.

	* ligand/dunbrack.cc: Add MSE special cases - now we have MSE
	rotamers.

2005-03-09  Paul Emsley  <paulemsley@ysbl.york.ac.uk>

	* ccp4mg-utils/mgtree.cc: (RecurseCalculateTree): Fix suggested by
	Joel Bard in the case where
	(coordk->GetParentID()==-1&&scanned[*k]!=1) fails.

2005-03-08  Paul Emsley  <paulemsley@ysbl.york.ac.uk>

	* db-main/db-main.hh (coot): remove class name from
	mainchain_fragment() declaration [Ezra Peisach].

	* coords/mmdb-crystal.cc: (point_is_in_box): add coot namespace
	for dot_produc [Ezra Peisach].

	* coot-utils/coot-fasta.hh: remove coot::fasta:: from declaration
	of is_fasta_aa [Ezra Peisach].

	* angles/AngleInfo.h: moved definition of nint inline and into
	class.

	* src/molecule-class-info-other.cc: (bad_chiral_volumes):
	is_bad_chiral_atom_p is in namespace coot [Ezra Peisach].

	* skeleton/BuildCas.cc: Remove unused variables [Ezra Peisach].

	* configure.in: add -LANG:std to CXXFLAGS if CC on irix if not
	there already [Ezra Peisach].

	* coords/Bond_lines.cc: (addSymmetry_whole_chain) Use PCAtom not
	(CAtom *) [which could be mis-understood as a casting] for
	transsel [Ezra Peisach].

	* coords/Bond_lines_ext.cc (find_molecule_middle): Use vector of
	int not dynamic [g++ extention] array of ints [Ezra Peisach].

	* coords/Bond_lines.h: (Bond_lines_container) removed class name
	in front of make_graphical_bonds() [Ezra Peisach].

	* src/c-interface.cc: (handle_cns_data_file) should return a value
	[Ezra Peisach].

	* high-res/high-res.hh (high-res): fill_globular_protein should
	have differently named args [Ezra Peisach].

	* src/graphics-info.h: state_command string should have
	differently named args [Ezra Peisach].

2005-03-03  Paul Emsley  <paulemsley@ysbl.york.ac.uk>

	* src/c-interface.cc: add pick_cursor [how can it not have been
	there before!] and use it for delete item.

2005-03-02  Paul Emsley  <paulemsley@ysbl.york.ac.uk>

	* src/Makefile.am (COOT_EXTRA_LIBS): Use .la linking

	* other Makefile.ams: Use .la linking as Ezra suggests.

2005-03-01  Paul Emsley  <paulemsley@ysbl.york.ac.uk>

	* src/molecule-class-info.cc: (add_typed_pointer_atom): Changed 
	" OW1" to standard " O " here too.

	* ligand/ligand-extras.cc: Changed " OW1" to standard " O ".
	Spotted by PRE.

2005-02-28  Paul Emsley  <paulemsley@ysbl.york.ac.uk>

	* Release 0.0.29

2005-02-25  Paul Emsley  <paulemsley@ysbl.york.ac.uk>

	* db-main/db-main.cc: (match_target_fragment): Add ires protection
	from start of fragment [bug found when fragment didn't contain any
	Calphas].

2005-02-24  Paul Emsley  <paulemsley@ysbl.york.ac.uk>

	* ligand/ligand.cc: (ligand class): changed xmap_masked to
	xmap_cluster and now use xmap_masked to score ligands, not
	xmap_pristine.

	* ligand/ligand.cc: (import_map_from): the version with sigma
	added also should set xmap_masked.

2005-02-24  Paul Emsley  <emsley@localhost>

	* src/molecule-class-info.cc: (export_coordinates): added statusbar text.

	* ligand/wiggly-ligand.cc: (install_simple_wiggly_ligands): don't
	write 1.pdb 2.pdb etc for wiggly ligands.

2005-02-23  Paul Emsley  <emsley@localhost>

	* src/molecule-class-info.cc: (add_typed_pointer_atom): use
	max_resno_in_chain to find the resno off added water/thing.

	* coot-utils/coot-coord-utils.cc: (max_resno_in_chain): created.
	To be used by add pointer atom function so that we don't get
	pointer atoms/SO4s in the same chain with the same residue number.

	* ligand/ligand.cc: changed map_masked to map_clustered and
	introduced map_masked.  ligand-extras.cc now uses map_masked [not
	map_cluster, how did it ever work before?].

2005-02-22  Paul Emsley  <paulemsley@ysbl.york.ac.uk>

	* src/pick.cc: (atom_pick): moved the console pick info.

	* src/c-interface.cc: (new_close_molecules): update go to atom
	molecule if it had been set to a deleted molecule [Phil Evans
	bug].

	* doc/coot.tex (subsection{Raster3D output}): Add F8 to doc.

	* src/callbacks.c (on_model_refine_dialog_dismiss_button_clicked):
	Use close_model_fit_dialog() to destroy the hbox and let us know
	if the dialog needs destroying.

	* src/c-interface.cc: (): created [sometimes the
	model/refine/dialog has been sucked in - we need to hide the frame
	for dialog's hbox in that case].

	* src/density-score-by-residue.cc: (density_score_molecule): add
	scored residue class and scored atom class fix up output.  Joel
	Bard request.

2005-02-21  Paul Emsley  <paulemsley@ysbl.york.ac.uk>

	* src/molecule-class-info-other.cc: (merge_molecules): add the
	adding_chain chain_id to this molecules chain ids, so that new
	[other] molecules don't come up with the same chain id.  Fixes
	Harvard bug.

2005-02-20  Paul Emsley  <paulemsley@ysbl.york.ac.uk>

	* src/c-interface-build.cc added functions for scripting
	translation/refinement/rotamers: chain_n_residues(),
	molecule_centre_internal(), resname_from_serial_number(),
	seqnum_from_serial_number(), insertion_code_from_serial_number(),
	chain_id(), n_chains().

	* src/c-interface.cc: (set_colour_by_molecule): created.  fixed up
	gtk-manual.c and .h and Bond-lines.cc/.hh and molecule_info_class
	too.

2005-02-19  Paul Emsley  <paulemsley@ysbl.york.ac.uk>

	* src/graphics-info-state.cc (save_state_file) Add vt-surface to
	the state file.

	* Makefile.am (SUBDIRS): Moved high-res after ideal. 

	* src/graphics-info.cc: (display_geometry_torsion): Created code
	for Torsions too, needed do_torsion_define() and gui elements [as
	per angle].  Angles and distances are now displayed on the
	graphics.

	* src/graphics-info-defines.cc: (clear_pending_picks): clears the
	a_is_pressed flag too which is often what we want [even though it
	is possible that it may not be true].

2005-02-16  Paul Emsley  <paulemsley@ysbl.york.ac.uk>

	* src/graphics-info.cc: (refine): Removed annoying "That water
	molecule doesn't have restraints" message.

2005-02-15  Paul Emsley  <paulemsley@ysbl.york.ac.uk>

	* src/molecule-class-info.cc: (save_molecule_filename): Disaster!
	People report crashing on Accept moving atoms. reverted to version
	that worked and patched up.  Still not sure what the problem was.
	Thank goodness for svn.

2005-02-13  Paul Emsley  <paulemsley@ysbl.york.ac.uk>

	* Release 0.0.28

2005-02-13  Paul Emsley  <paulemsley@ysbl.york.ac.uk>

	* src/globjects.cc: (glarea_button_press): Bin [synthetic] double
	click events which were giving us 2 "Accept Refinement" dialogs.

	* src/molecule-class-info.cc: Various changes involving
	WINDOWS_MINGW to make Bernhard's job easier.

2005-02-12  Paul Emsley  <paulemsley@ysbl.york.ac.uk>

	* src/xmap-utils.cc: (map_density_distribution): bins to vector.
	Berhard bug.

2005-02-10  Paul Emsley  <paulemsley@ysbl.york.ac.uk>

	* src/c-interface.cc: Filled the read_shelx_ins_file() and
	write_shelx_ins_file() stubs.

2005-02-08  Paul Emsley  <paulemsley@ysbl.york.ac.uk>

	* src/graphics-info-graphs.cc (density_fit_from_residues):
	Created. called both density_fit_graphs and density from mol [the
	update of the graph from intermediate atoms].

	(update_geometry_graphs): created.  Moved out out
	accept_moving_atoms.  We need 2 version of this, one for moving
	atoms molecule and the other a residue/residue range for things
	like pepflip or auto-fit rotamer [i.e. things which don't create
	intermediate atoms].

2005-02-07  Paul Emsley  <paulemsley@ysbl.york.ac.uk>

	* src/c-interface.cc: residue_density_fit_scale_factor() add
	interface to set this [useful for CNS/mapman users?]

2005-02-04  Paul Emsley  <paulemsley@ysbl.york.ac.uk>

	* ideal/regularize-minimol.cc (regularize_minimol_molecule):
	created.  Called from wiggly-ligands install_wiggly_ligands().
	Fixed up Makefile.am and various headers.  Cool - minimized
	torsioned ligands. This took about an hour on the train to Oxford.

	* ideal/simple-restraint.cc: Change the chain_id in the restraints
	constructor and the init_from_mol chain_id to const char *.

	* ligand/wiggly-ligand.cc: (install_simple_wiggly_ligands): change
	RotateAboutBond() to SetDihedralAngle() now that ccp4mg tree has
	changed the function.

	* ligand/dunbrack.cc: (ordered_residue_atoms): Remove "needs
	reordering" debugging line.

	* ccp4mg-utils (mgtree): Un-apply adjustments suggested by Joel
	Bard [rotamers on prolines don't return - it gets stuck in a tree
	function].

2005-02-03  Paul Emsley  <emsley@localhost>

	* src/graphics-info.cc: (execute_edit_chi_angles): If MSE change
	clicked atom to C to set the tree right [Phil Evans bug].

	* ligand/chi-angles.cc: (change_by): all these functions return
	the angle now as well as the status [now in a pair].

	* src/graphics-info.cc: (update_residue_by_chi_change): Display
	the chi angle [like Dirk asked for].

	* src/gtk-manual.c (on_map_col_sel_cancel_button_clicked): update
	to pass tmd [and change create_map_colour_selection_window() to
	pass it].  Along with molecule_info_class and c-interface save and
	restore_previous_map_colour() we eventually get the colour map
	selection cancel button to Do The Right Thing.

	* src/molecule-class-info.cc: (save_previous_map_colour)
	(restore_previous_map_colour): created.

2005-02-03  Paul Emsley  <paulemsley@ysbl.york.ac.uk>

	* doc/coot.tex (section{Environment Variables}): add reference
	structures to index.

2005-02-02  Paul Emsley  <emsley@localhost>

	* src/Makefile.am (coot_wrap_python_pre.cc): coot.i should be
	prefixed by top_srcdir for out of tree building.

2005-02-02  Paul Emsley  <paulemsley@ysbl.york.ac.uk>

	* ccp4mg-utils (mgtree): apply adjustments suggested by Joel Bard.

2005-01-30  Paul Emsley  <paulemsley@ysbl.york.ac.uk>

	* src/molecule-class-info.cc: (store_refmac_params): Fixed screen
	output typo.

	* ligand/ligand.cc: (find_clusters): Tell us the distance limits
	too.

	* src/molecule-class-info.cc: (delete_atom), (delete_atoms),
	(delete_residue), (delete_residue_with_altconf): update the
	symmetry too on object deletion.

	* src/graphics-info-defines.cc: (check_if_in_delete_item_define):
	delete by symmetry atom click now enabled.

	* src/c-interface-build.cc: (clear_pending_delete_item): added
	zeroing of delete_item_residue_hydrogens [too].  Fixes bug in
	notes.

	(delete_atom_by_atom_index): Use [also] the dialog's checkbuton to
	see if the dialog should be destroyed.

	* src/c-interface-validate.cc: (unset_geometry_graph): added null
	graphs protection.

	(free_geometry_graph): added null graphs protection.

	* src/globjects.cc:
	(graphics_info_t::display_lists_for_maps_flag): now that map
	colour update works, make display list for maps the default.

	* src/molecule-class-info.cc: (compile_density_map_display_list):
	created - so that we can make update_map separate from the
	compilation of the display list.  Caled from
	molecule-class-info.cc's handle_map_colour_change().

2005-01-29  Paul Emsley  <paulemsley@ysbl.york.ac.uk>

	* macros/mmdb-ssm.m4 (AM_WITH_MMDBSSM): use $with_ssmlib_prefix in
	MMDBSSM_CXXFLAGS [Oops].  Hopefully fixes problems spotted by Joel
	Bard and Joseph Toth.

	* src/graphics-info-pick.cc: (symmetry_atom_pick): tried to add
	null protection going from mmdb char * spacegroup to clipper
	Sprg_descr.

2005-01-28  Paul Emsley  <paulemsley@ysbl.york.ac.uk>

	* src/globjects.cc (key_release_event): Added GDK_CONTROL_MASK
	checking and setting of internal params.

2005-01-27  Paul Emsley  <paulemsley@ysbl.york.ac.uk>

	* src/molecule-class-info-ncs.cc (ncs_chains_match_p): Fix for
	non-consistant chain additions - should find NCS more consistantly
	now.

	* src/molecule-class-info-mutate.cc: (align_on_chain): more
	tinkerining with the array indexing [fixes crashes].

2005-01-25  Paul Emsley  <paulemsley@ysbl.york.ac.uk>

	* src/molecule-class-info-surface.cc (make_surface): put surface
	graphics object into a display list.

	* src/c-interface.cc: (set_display_lists_for_maps): created.
	Tinkers with graphics info variable and is [now] used in
	molecule-class-info.cc's update_map() and draw_density_map().

2005-01-24  Paul Emsley  <paulemsley@ysbl.york.ac.uk>

	* doc/coot.tex (section{Scripting}): say that parentheses are
	important.

2005-01-18  Paul Emsley  <paulemsley@ysbl.york.ac.uk>

	* Release 0.0.27

	* src/graphics-info.cc: (moving_atoms_graphics_object): Make Ns be
	blueish and oxygens redish.

	* src/c-interface-build.cc:
	(wrapped_create_align_and_mutate_dialog): deal with pathological
	case of closed first molecule when filling chain optionmenu.
	INFO:: All chain option menu dialogs should use this construction.

2005-01-14  Paul Emsley  <paulemsley@ysbl.york.ac.uk>

	* src/graphics-info.h: Added brief_atom_labels_flag for Ian
	Tickle.

	* src/molecule-class-info.cc: (mutate) I deleleted the
	DeleteSelection().  Not sure this is safe - should test on PC
	[seems OK on Mac - yep seems OK].

	* coot-utils/coot-coord-utils.cc: (get_ori_to_this_res): updated
	error message.

	* ligand/ligand.cc: (make_sample_protein_coords): Use proper
	minimol limits to residues vector.  Fixes Marianne's water/ligand
	addition crash.

2005-01-13  Paul Emsley  <paulemsley@ysbl.york.ac.uk>

	* src/molecule-class-info-other.cc: (recent_backup_file_info):
	Added COOT_BACKUP_DIR configurability.

2005-01-11  Paul Emsley  <paulemsley@ysbl.york.ac.uk>

	* src/graphics-info.cc: (new_alt_conf_occ_adjustment_changed):
	callback from [altconf] rotamer occupancy hscale sets the occ of
	intermediate atoms.

2005-01-10  Paul Emsley  <paulemsley@ysbl.york.ac.uk>

	Release 0.0.26

2005-01-05  Paul Emsley  <paulemsley@ysbl.york.ac.uk>

	* ligand/dunbrack.cc: use SetDihedralAngle not RotateAboutBond for
	as the Tree function [Urgh.. this needs a fix].

2005-01-04  Paul Emsley  <paulemsley@ysbl.york.ac.uk>

	* src/molecule-class-info.cc: (show_spacegroup): don't try to
	construct a string from a null char *.  Fixes crash [thanks Michal
	Jakob].

	* coot-utils/coot-coord-lsq.cc: Created for lsq interface.  Called
	by graphics-info-lsq.cc function.

2004-12-23  Paul Emsley  <paulemsley@ysbl.york.ac.uk>

	* Release 0.0.25 [At long last]

2004-12-20  Paul Emsley  <paulemsley@ysbl.york.ac.uk>

	* src/c-interface-build.cc: (align_and_mutate),
	(do_align_mutate_sequence): and friends created.

	* src/molecule-class-info-mutate.cc created for "align and mutate"
	functions.
	
2004-12-20  Paul Emsley  <paulemsley@ysbl.york.ac.uk>

	* ligand/ligand-extras.cc: removed high-res.hh dependencies.
	high-res now depends on ligand libs so is moved after ligand dir.

	* src/molecule-class-info.cc: (make_map_from_cif): Added state commands.

2004-12-14  Paul Emsley  <paulemsley@ysbl.york.ac.uk>

	* db-main/db-main.cc: (get_fragment_ca_atoms): change to new style
	minimol indexing.

	(mainchain_ca_coords_of_db_frag): ditto.

	* coot-utils/coot-coord-utils.cc (get_ori_to_this_res): moved from
	molecule_class_info_t.  Tedious.

	* src/molecule-class-info-ncs.cc: (ncs_averaged_maps): extend the
	extends by 5A.

	* src/molecule-class-info.cc: (mutate): tinkered with the
	DeleteSelection placement.

	* src/molecule-class-info-other.cc: (apply_atom_edits): created -
	new interface used by apply_residue_info_changes() changing
	several atoms at once.

	* src/graphics-info.cc: (apply_residue_info_changes): complete
	re-written to instead check the values of the widget at "Apply"
	time rather than keep a list of edits as they happen [and that was
	failing because the edits were not recorded if the entry widget
	didn't have focus - which was quite possible with a swipper like
	Tracey].  Make a list of edits and apply them all at one.

2004-12-13  Paul Emsley  <paulemsley@ysbl.york.ac.uk>

	* coot-utils/coot-coord-utils.cc: (extents): function
	created. Return a pair of Coord_orths [top left and bottom right -
	not face centres].

	* src/molecule-class-info-ncs.cc: Use Coord_orth extents to box a
	map [as per density contouring] to use in NCS averaging.

	* src/graphics-info-defines.cc: Added atom name labelling [as per
	refine check] for check_if_in_db_main_define(), rigid_body and
	totate/translate checks.

2004-12-07  Paul Emsley  <paulemsley@ysbl.york.ac.uk>

	* src/c-interface-info.cc: (do_residue_info): Added check of
	pending residues edits before generating the widget.

	* src/graphics-info.cc: (refine): trap refinement of a water and
	use Rigid body Fit Zone instead.

2004-12-06  Paul Emsley  <paulemsley@ysbl.york.ac.uk>

	* src/c-interface-validate.cc: do_check_waters_by_widget(),
	wrapped_create_check_waters_dialog(),
	wrapped_checked_waters_baddies_dialog() created to make a water
	checking interface.

2004-12-04  Paul Emsley  <paulemsley@ysbl.york.ac.uk>

	* coords/Bond_lines.cc: (trans_sel): in the trans_selection atoms
	set those atoms residues to be the same as the atom from which
	they are copied.

	* src/graphics-info-pick.cc: (symmetry_atom_pick): changed
	min_dist to 0.4 [like regular pick].  Now we don't get
	suprious/unexpected symmetry atom click hits.

2004-12-03  Paul Emsley  <paulemsley@ysbl.york.ac.uk>

	* db-main/db-main.cc: (match_target_fragment): changed max_devi
	from 2.0 to 2.6, less gaps now when converting to mainchain?

	(fit_reference_structures): change from 0.3 to 0.4 for
	similar_eigens() similarity test.

	* ligand/ligand.cc: (mask_map): introduced new version with
	Selection Handle that does the mask inversion [i.e. only leave map
	around the atom selection].  It's cool.

	* coords/Bond_lines.cc: (do_normal_bonds_no_water): Use SKEY_NEW
	for atom selection to exclude waters - not the naive way it was
	done before causing atom indexing problems [thanks Ward Smith].

2004-12-01  Paul Emsley  <paulemsley@ysbl.york.ac.uk>

	* src/molecule-class-info.cc: delete_residue,
	delete_residue_with_altconf, delete_residue_hydrogens, delete_atom
	all now have a call to delete_ghost_selections().  Are we stable
	now?

	* src/molecule-class-info-ncs.cc: (delete_ghost_selections):
	created.  To be called whenever we do a deletion of the atom_sel.
	Followed by an update_ghosts() after the modification.

2004-11-30  Paul Emsley  <paulemsley@ysbl.york.ac.uk>

	* src/graphics-info.cc: (fill_bond_parameters_internals): Set the
	adjustment for the new hscale - a much better interface than the
	text entry box.

2004-11-29  Paul Emsley  <paulemsley@ysbl.york.ac.uk>

	* coords/Bond_lines.cc (Bond_lines_container): Changed 1.82 to
	1.86.

	* src/graphics-info.cc: (rot_trans_adjustment_changed): change to
	mmdb-idiomatic CAtom * for rotation centre holder rather than its
	index [Fixes Stephen Graham's alt conf rot/trans bug].

	* coot-utils/coot-coord-utils.cc: (get_selection_handle): from a
	coot::atom_spec_t.  Used first in rot/trans.  Hopefully useful in
	future.

	* coot-utils/coot-coord-utils.hh: (atom_spec_t): added constructor
	from a hierarchy CAtom *.

	* src/graphics-info.cc: (flash_selection): added DeleteSelection().

2004-11-26  Paul Emsley  <paulemsley@ysbl.york.ac.uk>

	* src/c-interface-waters.cc: (execute_find_waters_real): mask
	waters is no longer optional.

	* src/c-interface-build.cc: (execute_refmac_real): add extra
	params so that we can choose to swap the map colour of post refmac
	maps to be the same as the pre-refmac map.

	* src/main.cc: (show_citation_request): enable this code [at last,
	yey!]

	* src/callbacks.c (on_model_refine_dialog_refmac_button_clicked):
	Set the difference map check button to be on by default.

2004-11-25  Paul Emsley  <paulemsley@ysbl.york.ac.uk>

	* src/c-interface.cc: (do_refine) and (do_regularize): kill off
	the delete item dialog and unset the pending delete state if state
	is on.

	* src/graphics-info-superpose.cc (superpose_with_atom_selection):
	Tinker with atom limits.  Not sure if it's correct to be
	honest. Stops Miguel's crash though.

	* src/c-interface.cc: (fill_option_menu_with_skeleton_options):
	call the version of the option_menu filter that also sets the
	active position. [Skeletonization problems gone, I hope].

	* src/graphics-info.cc: (skeleton_map_select): Set the radio
	buttons according to the skeletonization state of the current map.

	* src/molecule-class-info.cc: (close_yourself): also turn off the
	skeleton.

	* density-contour/CIsoSurface.cpp: (returnTriangles): fix typo in
	line checking [thanks Ezra].

2004-11-24  Paul Emsley  <paulemsley@ysbl.york.ac.uk>

	* src/pick.cc: (atom_pick): added a test on number of pickable
	molecules and display a dialog if there are none.

	* src/graphics-info-defines.cc: (check_if_in_delete_item_define):
	added check to see if a symmetry atom was picked and if so give a
	warning.

	* mini-mol/mini-mol.cc: (setup): completely re-written.

	* src/graphics-info-render.cc: (render_molecule): Use atom centre
	info also to add balls to sticks.

	* coords/Bond_lines.cc: (add_atom_centres): graphical bonds
	container now contains atom centre info.

	* src/molecule-class-info.cc: (set_bond_colour_by_mol_no): When we
	run out of colours make some up based on i - fixed may grey Ca
	chains problem.

2004-11-21  Paul Emsley  <paulemsley@ysbl.york.ac.uk>

	* src/molecule-class-info.cc: (make_map_from_phs): changed the
	default return status [as error] to -1.

2004-11-20  Paul Emsley  <paulemsley@ysbl.york.ac.uk>

	* coords/Makefile.am (INCLUDES): Added CLIPPER_CXXFLAGS [for
	coot-close.cc usage].

2004-11-19  Paul Emsley  <paulemsley@ysbl.york.ac.uk>

	* sequence-view/Makefile.am (INCLUDES): added CLIPPER_CXXFLAGS

	* analysis/Makefile.am (INCLUDES): Added CLIPPER_CXXFLAGS

2004-11-16  Paul Emsley  <emsley@localhost>

	* src/molecule-class-info.cc: (add_typed_pointer_atom): check for
	chain that is chain only of the same type as added residue type
	before creating new chain.
 
2004-11-15  Paul Emsley  <emsley@localhost>

	* coot-utils/Makefile.am: add MMDB_CXXFLAGS to INCLUDE [thanks 
          Joseph Toth].

	* surface/CXXSphereNode.h: removed the ; again!

2004-11-14  Paul Emsley  <paulemsley@ysbl.york.ac.uk>

	* ligand/Makefile.am (findligand_LDADD): use $(top_builddir)
	(findwaters_LDADD): Use $(top_builddir).

	* high-res/Makefile.am (testatomgraph_LDADD): corrected
	testatomgraph_LDADD.
	(tracehighres_LDADD): corrected for coot-coord-utils usage.

	* src/globjects.cc: (glarea_motion_notify): Tinkered with key
	modifier mask - should remove being stuck in "Translate Only"
	mode.
	(key_press_event): Added anomaly corrector here too.

	* src/molecule-class-info.cc: (add_typed_pointer_atom): Check for
	a chain of a type before creating a new chain.

	* coot-utils/coot-coord-utils.cc (chain_only_of_type): Find a
	chain in a molecule that is only of the given type.  If not,
	return NULL.

2004-11-13  Paul Emsley  <paulemsley@ysbl.york.ac.uk>

	* src/pick.cc: (atom_pick): check the molecules back to front to
	select atoms "on top" first.

	* src/molecule-class-info.cc: (set_initial_contour_level): created
	- map creating functions [e.g. from ccp4 map file and from mtz]
	should call this function - which makes more sensible decisions
	about how to set the starting contour leve [e.g. for E-maps].

2004-11-10  Paul Emsley  <paulemsley@ysbl.york.ac.uk>

	* src/graphics-info-state.cc: (save_state_file): save also the go
	to atom info.

	* src/molecule-class-info-ncs.cc: created.  With functions
	update_ghosts(), update_bonds [for ghost_molecule_display_t],
	fill_ghost_info(), find_ncs_matrix(),
	make_dynamically_transformed_maps(), install_map(),
	add_ncs_ghost() for first stab at NCS functions.  Also various
	ghost display on/off flags and accessor functions in
	molecule_class_info_t and c-interface-preferences [for now].
	Glade NCS dialogs created and static GUI elements added to
	graphics-info.

	* src/c-interface.cc: (valid_labels): check for null return of
	get_f_cols(), get_phi_cols() and get_weight_cols().

	* src/mtz-bits.c: (get_f_cols), (get_phi_cols), (get_weight_cols):
	check for success of get_f_phi_columns and return NULL on badness.

	* mmtz-extras/mmtz-extras.c: (get_f_phi_columns): now stat and
	return NULL on error.

2004-11-09  Paul Emsley  <paulemsley@ysbl.york.ac.uk>

	* src/graphics-info-state.cc: Added set go to atom info.

2004-11-08  Paul Emsley  <paulemsley@ysbl.york.ac.uk>

	* src/c-interface-info.cc: (set_show_pointer_distances),
	(toggle_pointer_distances_show_distances),
	(execute_pointer_distances_settings) created for pointer distances
	functions - good for use when running through difference map peaks
	[but no symmetry checking].

	* src/molecule-class-info-other.cc (distances_to_point): Created
	for pointer distances support.

	* src/main.cc: tinkered with gtk pending events for splash screen.

	* src/callbacks.c (on_open_coordinates1_activate): make
	add_filename_filter_button() return the button and call
	gtk_signal_emit_by_name with clicked argument.  Added state flag
	to graphics-info and accessor function to c-interface.h/cc.

2004-11-07  Paul Emsley  <paulemsley@ysbl.york.ac.uk>

	* setup/coot.csh.in: uncommented COOT_RESOURCES_FILE.

2004-11-05  Paul Emsley  <paulemsley@ysbl.york.ac.uk>

	* src/graphics-info.cc: (rotamer_dialog_neighbour_rotamer):
	created: makes a sythetic "clicked" event on next/prev rotamer
	radio buttons when keyboard , or . pressed.

	* src/gtk-manual.c: (display_control_molecule_combo_box) and
	(display_control_map_combo_box), no expand, no fill on the
	molecule number [padding 3].

2004-11-04  Paul Emsley  <paulemsley@ysbl.york.ac.uk>

	* coords/Cartesian.h: moved getStart and getFinish into the header
	for in-lining - should speed up map rotation?

2004-11-03  Paul Emsley  <paulemsley@ysbl.york.ac.uk>

	* coords/Bond_lines.cc (Bond_lines_container): [constructor with
	no distance args] changed 1.9 to 1.82, does this fix MSE bonding
	problems?

2004-10-30  Paul Emsley  <paulemsley@ysbl.york.ac.uk>

	* src/c-interface-superpose.cc: (superpose_with_chain_selection):
	created for use with [new] chain selection to SSM.  Moved actual
	invocation of ssm to graphic-info-superpose.cc. Added chain GUI
	elements, with a generic chain chooser.

2004-10-29  Paul Emsley  <paulemsley@ysbl.york.ac.uk>

	* src/graphics-info-state.cc: (state_command) fix for python
	commands with no args [thanks Bernhard].

	* src/molecule-class-info-other.cc: (map_chains_to_new_chains):
	removed debugging code.

2004-10-27  Paul Emsley  <paulemsley@ysbl.york.ac.uk>

	* Release 0.0.24

	* src/molecule-class-info.cc: (close_yourself): move the setting
	to NULL of the atom pointers until after they have been deleted
	[d'oh!]

	* setup/coot.csh.in: Added IRIX case.

	* setup/coot.sh.in (systype): Added IRIX cse.

	* src/molecule-class-info.h: (set_draw_hydrogens_state): use
	make_bonds_type_checked() not simply makebonds() - and don't even
	do that if the state is the same as it had been.

	* src/molecule-class-info-other.cc: (add_OXT_to_residue): added a
	GUI warning.

	* geometry/protein-geometry.cc: comp_bond, comp_angle, comp_plane,
	comp_chiral: added get_padded_name() to create the atom names.
	Note: links not done.

2004-10-26  Paul Emsley  <paulemsley@ysbl.york.ac.uk>

	* geometry/protein-geometry.cc: (atom_id_mmdb_expand): reference
	the argument [oops!] and return early if atom name is 4 chars
	already.

	* src/graphics-info-navigation.cc: (fill_go_to_atom_residue_list):
	don't call cb_chain_tree_itemsignal() on deselect.

2004-10-25  Paul Emsley  <paulemsley@ysbl.york.ac.uk>

	* src/c-interface.cc: (add_on_map_colour_choices),
	(map_scroll_wheel_mol_selector_activate),
	(add_on_map_colour_choices), (add_map_colour_mol_menu_item): much
	tediousness adding dynamic an enumerated options to the scroll map
	menu and map colour chooser. Still, I've been wanting to do it for
	months.  You can no longer choose to change the colour of a closed
	map.

	* src/graphics-info.h: removed the array initialization to null
	for the various canvases and validation graphs as suggested by Tim
	Gruene.

	* src/c-inner-main.c: (c_inner_main): Altered logic of scheme file
	loading, now COOT_SCHEME_DIR if defined, has priority.

	* src/c-interface.cc: (set_symmetry_size): Added symmetry updating
	and redisplay.

	(graphics_to_ca_representation) and other graphics_to_* functions:
	added valid molecule protection.  Fixes scripting crash.

	* src/graphics-info-navigation.cc:
	(update_widget_go_to_atom_values): added inscode to residue's
	entry string.

	(split_resno_inscode): created.  Used by
	apply_go_to_atom_from_widget() which interprets the widget's entry
	texts.

2004-10-24  Paul Emsley  <paulemsley@ysbl.york.ac.uk>

	* src/molecule-class-info.cc: (save_coordinates): added error
	dialog.

	(read_ccp4_map): Added non ext,map,msk extension error dialog.

2004-10-23  Paul Emsley  <paulemsley@ysbl.york.ac.uk>

	* src/molecule-class-info.cc: (make_atom_label_string): Added ins
	code to atom label.

	(model_view_residue_tree_labels): Add ins code to residue label.

2004-10-21  Paul Emsley  <emsley@localhost>

	* src/graphics-info.cc: (place_typed_atom_at_pointer): Added
	closed molecule protection.  Fixes crash.

	* src/graphics-info: (pointer_atom_molecule): added has_model()
	protection.

	* src/c-interface-ligands.cc moved ligand stuff here and fixed the
	"test for ligand" bug on "reading" the widget at execute time.

2004-10-20  Paul Emsley  <emsley@localhost>

	* setup/coot.sh.in export COOT_REF_STRUCTS.  Argh.  Is this the 
	  end to it?

2004-10-19  Paul Emsley  <emsley@localhost>

	* Release 0.0.23

	* high-res/Makefile.am linking libraries order changes.

2004-10-19  Paul Emsley  <emsley@localhost>

	* Release 0.0.22

	* src/callbacks.c (on_show_symmetry_ok_button_clicked): symmetry
	whole chain button should call symmetry_whole_chain(), not
	set_symmetry_atom_labels_expanded() - cutn'paste error, I guess
	[Dirk K's bug].

2004-10-17  Paul Emsley  <paulemsley@ysbl.york.ac.uk>

	* sequence-view/sequence-view.cc: (draw_mol_chain_label): Add a
	space when molecule name is blank.  Thanks Ezra.

2004-10-16  Paul Emsley  <paulemsley@ysbl.york.ac.uk>

	* src/gtk-manual.c
	(on_display_control_mol_displayed_button_toggled): Toggle the
	active button when the display button is toggled.

	* src/c-interface.cc: (handle_read_draw_molecule_with_recentre):
	uses expand_molecule_space_maybe() now [a strubi-induced feature].

2004-10-15  Paul Emsley  <paulemsley@ysbl.york.ac.uk>

	* src/graphics-info-pick.cc: (symmetry_atom_pick): don't allow
	symmetry atom picking if the atoms are not pickable.

	* src/graphics-info.cc: (Imol_Refinement_Map): return the map
	number only if the map has not been closed - otherwise we search
	for a map as before.

2004-10-14  Paul Emsley  <paulemsley@ysbl.york.ac.uk>

	* setup/coot.csh.in (COOT_REF_STRUCTS): added - Again.  Likewise.
	
	* setup/coot.sh.in (COOT_REF_STRUCTS): added - Again!  I can't
	believe it.

	* analysis/bfkurt.cc: (stats): numerical instability - with potential
	of sqrt of a negative number trapped.  Also add occupancy weighting.

2004-10-13  Paul Emsley  <paulemsley@ysbl.york.ac.uk>

	* src/callbacks.c (on_save_coords_dialog_save_button_clicked):
	Don't set the directory for this widget to be the directory of the
	last fileselection. Save files should by default now be saved in
	the directory in which coot was started - which is The Right
	Place.

	* macros/clipper.m4 (AM_PATH_CLIPPER): removed fftw/lib and mccp4
	-L args, they are never used these days and the linker grumbles
	about them not existing.

2004-10-12  Paul Emsley  <paulemsley@ysbl.york.ac.uk>

	* src/rama_plot.cc: converted abs to fabs [for SGI build].

	* src/Makefile.am (density_score_by_residue_LDADD): Added compat
	libs [for SGI build].

2004-10-08  Paul Emsley  <paulemsley@ysbl.york.ac.uk>

	* Release 0.0.21

	* src/c-interface-preferences.cc: Created.

	* ligand/dunbrack.cc: (GetResidue): return NULL if no rotamers
	available for this residue [type].

	* src/graphics-info.cc: (generate_moving_atoms_from_rotamer):
	Added protection for d.GetResidue(irot) returning NULL;

	* src/molecule-class-info-other.cc: (auto_fit_best_rotamer): added
	protection for probabilities.size() == 0.

	* src/molecule-class-info.cc: (mutate): Added DeleteSelection.

2004-10-07  Paul Emsley  <paulemsley@ysbl.york.ac.uk>

	* src/gtk-manual.c (rama_plot_mol_selector_activate): Used
	dynarama_is_diplayed_state to get the old widget, and if not null,
	raise [or map] it.  We can have only one ramachandran plot per
	molecule now - Hope this fixes Maks's bug.

	* src/c-interface.cc: (dynarama_is_diplayed_state): created - so
	that we can check if the window exists before we create a new one.

2004-10-06  Paul Emsley  <paulemsley@ysbl.york.ac.uk>

	* src/globjects.cc: (draw_hardware_stereo): fixed angle factor.
	Stereo reasonable now [but not shearing].

	* src/molecule-class-info.cc: (make_map_from_cif_nfofc): added.
	In Virginia, Marcel wanted 2Fo-Fc and Fo-Fc reading from a cif
	file that had calculated structure factors [this was not possible
	before, strangely enough].  Also added state strings for this
	method.

2004-10-05  Paul Emsley  <paulemsley@ysbl.york.ac.uk>

	* sequence-view/Makefile.am (AM_CXXFLAGS): Added GSL_CFLAGS.

	* ideal/Makefile.am (AM_CXXFLAGS): Moved GSL_CFLAGS to here.

2004-10-04  Paul Emsley  <paulemsley@ysbl.york.ac.uk>

	* coords/Bond_lines.cc: (handle_MSE_case): created to handle
	non-bonded atoms that are in MSE.  Check geometry params...

2004-09-30  Paul Emsley  <paulemsley@ysbl.york.ac.uk>

	* src/graphics-info.cc: (check_dictionary_for_residues): change
	"Tr " to "Tr" [etc.] before checking.

	* geometry/protein-geometry.cc: (try_dynamic_add): Take account of
	2 letter residue names.

2004-09-29  Paul Emsley  <paulemsley@ysbl.york.ac.uk>

	* coords/mmdb.cc: (fix_nucleic_acid_residue_names): added to
	change nucleic acid residue names to match refmac monomer
	restraints type.

2004-09-28  Paul Emsley  <emsley@localhost>

	* macros/coot-windows.m4 (AM_MINGW_WINDOWS): created. Editted
	src/Makefile.am and sequence-view/Makefile.am to use this
	variable.

2004-09-27  Paul Emsley  <paulemsley@ysbl.york.ac.uk>

	* src/rama_plot.cc: (setup_internal): fiddled with contour levels.

2004-09-26  Paul Emsley  <paulemsley@ysbl.york.ac.uk>

	* src/c-interface-waters.cc:
	(wrapped_create_check_waters_diff_map_dialog): added warning
	dialog when missing maps or coordinates.

	* src/c-interface.cc: (fill_ligands_dialog_ligands_bits): also
	check for ligand molecule having less than 400 atoms.

	* src/graphics-info-defines.cc: (check_if_in_delete_item_define):
	now takes a GdkModifierType argument so that we can check if Cntrl
	was pressed and destroy the Delete Item accordingly.  Also had to
	change check_if_in_range_defines() [passing the state], and
	c-interface_build's delete_atom* functions [passing the flag].

	* src/c-interface.cc: (do_refine): Test that the imol_map has not
	been closed. Fixes crash.

	* src/graphics-info.cc: (refine): Test that the imol_map has not
	been closed.

2004-09-25  Paul Emsley  <paulemsley@ysbl.york.ac.uk>

	* setup/coot.csh.in: Added SYMINFO to coot.csh.in [AGAIN! Argh!].

	* setup/coot.sh.in : Likewise added SYMINFO [AGAIN!].

	* ideal/simple-restraint.hh: removed [commented] time_diff()
	function.

	* ideal/simple-restraint.cc: (make_link_restraints): removed
	timeval variable usage.

	* coot-utils/coot-coord-utils.cc
	(intelligent_this_residue_mmdb_atom): Added [a copy of the one
	that is in molecule_class_info_t].  I guess that I should delete
	the molecule_class_info_t at some stage.

	* src/molecule-class-info.cc: (intelligent_next_atom): added
	DeleteSelection.

2004-09-22  Paul Emsley  <paulemsley@ysbl.york.ac.uk>

	* mini-mol/mini-mol.cc: (unused_chain_id): A crash was causes when
	a fragment_id was "".  Fixed.  Maybe Ezra's problem.

	* Release 0.0.20

	* src/callbacks.c (on_antialiasing1_activate): set the Yes radio
	button if anti-aliasing is on.

	* Removed chiral volumes from the Calculate menu.  Reordered SSM
	Superpose.

	* src/graphics-info.cc: (fill_go_to_atom_residue_list): removed
	superfluous call to show residue_sub_tree means that [as per the
	default for gtk trees] the residue tree is now initiated
	collapsed.  We shall see how they like that... :)

	* c-interface-validate.cc, geometry-graphs.cc, geometry-graphs.hh
	created. [Currently experimental] validation features [geometry,
	omega, B factor variance].

2004-09-17  Paul Emsley  <paulemsley@ysbl.york.ac.uk>

	* src/graphics-info-defines.cc (check_if_in_save_symmetry_define):
	created.  Along with save_symmetry_coords_dialog, its button
	callbacks, c-interface-build.cc's setup_save_symmetry_coords(),
	save_symmetry_coords_from_fileselection(), save_symmetry_coords()
	provide saving of symmetry coordinates.

2004-09-16  Paul Emsley  <paulemsley@ysbl.york.ac.uk>

	* ideal/simple-restraint.cc: (make_restraints): We set the
	restraints usage flag here [earlier than minimize()]. Now we don't
	randomly get [or fail to get] non-bonded contact restraints.

	* src/c-interface.cc: (mono_mode) and (hardware_stereo_mode):
	added null vbox protection. Removed spurious setting of the
	display mode in mono_mode() that messed up the following logic and
	results in the internal variable representing the GL widget to be
	different to the actual GL widget.

	* ideal/simple-restraint.cc: added alt conf tests to the middle of
	add_bonds, add_angles, add_planes.  This helps geometry graphs
	speed up.

	* coords/Bond_lines.cc: (construct_from_atom_selection): added
	Model test when bonding - for NMR structures.

2004-09-15  Paul Emsley  <paulemsley@ysbl.york.ac.uk>

	* ideal/simple-restraint.cc: (make_flanking_atoms_restraints):
	enable the DeleteSelection().

	* src/c-interface.cc: (handle_read_draw_molecule_with_recentre):
	created.  handle_read_draw_molecule() is now a wrapper to this.

	* (add_recentre_on_read_pdb_checkbutton): created - now we can
	optionally not recentre on reading new coordinates.

	* src/graphics-info.cc: (fill_go_to_atom_residue_list): Some
	tinkering with tree items and subtrees.

2004-09-14  Paul Emsley  <paulemsley@ysbl.york.ac.uk>

	* src/pick.cc: (unproject) remove casting to GLdouble

	* src/main.cc: (setup_symm_lib): reworked the symmetry error
	reporting code.

	* setup/coot.sh.in : Added COOT_RESOURCES_DIR and
	COOT_RESOURCES_FILE as per the suggestion of Christian
	Biertuempfel.

	* src/molecule-class-info-other.cc: (split_residue): removed
	incorrect usage of delete [] residue_atoms after GetAtomTable()
	[Fixed Tracy's Bug, I think].

2004-09-08  Paul Emsley  <paulemsley@ysbl.york.ac.uk>

	* src/molecule-class-info.cc: (unused_chain_id): take out the
	'while' as per Ezra's suggestion.

	* surface/Makefile.am (INCLUDES): Change the order to put the
	local includes before the clipper cxxflags.

2004-09-04  Paul Emsley  <paulemsley@ysbl.york.ac.uk>

	* Release 0.0.19

	* sequence-view/sequence-view.cc: (setup_canvas): Did some
	tinkering with the canvas scroll limits.  It should be better
	placed now for most things - but still doesn't work for ribosome
	particle and I don't know why.

	* src/c-interface.cc: (set_map_line_width) and
	(map_line_width_state): created to allow the changing of the width
	of the denity mesh lines.

	* src/graphics-info.cc:
	(on_go_to_atom_residue_tree_selection_changed): So we have a tree
	in fill_go_to_atom_residue_list now.  Several tree functions
	created - which obsoletes list functions.  The collapsing doesn't
	work properly and it doesn't fill properly using ribosome particle
	[grr].  Don't know why.
	
	* src/callbacks.c (on_antialias_dialog_yes_radiobutton_toggled):
	Added anti-aliasing GUI, now that it works.

2004-09-03  Paul Emsley  <paulemsley@ysbl.york.ac.uk>

	* src/molecule-class-info.cc: (read_ccp4_map): add ".msk" as an
	acceptable CCP4 map extention.

	* src/graphics-info.cc: (set_do_anti_aliasing): add glBlendFunc()
	on the suggestion of Stuart McNicholas.  Antialiasing works now
	for me with no performance [frames/sec] degredation.  Density
	lines look a bit strange due to blending with background.

2004-08-31  Paul Emsley  <paulemsley@ysbl.york.ac.uk>

	* sequence-view/sequence-view.cc: "fixed" -> fixed_font variable -
	which gets changed [or should do] to "monospace" if we are in
	MINGW windows.

2004-08-24  Paul Emsley  <paule@chem.gla.ac.uk>

	* coot-utils/coot-map-utils.cc (map_score): fix initialization of
	variables [thanks Ezra].

	* src/globjects.cc (key_press_event): Added view Z translation to
	keypad 3 and .

	* src/molecule-class-info.h: we don't have sensible refmac
	parameters if this is a closed map.

	* setup/coot.csh.in and coot.sh.in: Further tinkerage.  Now we only
	need to set the COOT_PREFIX line.

2004-08-21  Paul Emsley  <paule@chem.gla.ac.uk>

	* src/molecule-class-info.cc: (draw_unit_cell_internal): label the
	axes, A, B, C.

2004-08-19  Paul Emsley  <paule@chem.gla.ac.uk>

	* ideal/pepflip.cc: (pepflip): extensive changes the atom
	selection and deletion and function arguments to account for alt
	confs.

	* Ramachandran Plot now moved to Validate menu.

	* src/c-interface-waters.cc:
	(wrapped_create_unmodelled_blobs_dialog): along with
	(execute_find_blobs_from_widget) and (execute_find_blobs) provide
	blob validation feature.

	* src/globjects.cc: In line with sigma level of input map changes,
	the default level is changed to 1.0 sigma - which is sensible for
	2FoFc maps, but not, perhaps, for difference maps.

2004-08-18  Paul Emsley  <paule@chem.gla.ac.uk>

	* src/c-interface.cc: (filtered_by_glob): Apply Ezra's fix for
	correct map globbing.

	* src/molecule-class-info.h: removed reset_draw_vecs() function.

	* src/globjects.cc: (glarea_motion_notify): removing "changin
	state" debuging line.

	* src/graphics-info-pick.cc:
	(move_moving_atoms_by_shear_internal): use new/delete [] not GNU
	extension for variable d_to_moving_at.

	* src/xmap-utils.cc: (map_density_distribution): move to
	new/delete [] usage not GNU extension for variable bin.

	* src/molecule-class-info.cc: (insert_coords_internal): remove
	shadowing of asc_chain variable [ChBa bug].

	* coords/Bond_lines.cc: (do_Ca_plus_ligands_bonds): remove GNU
	style dynamic memory allocation for ligand_atoms_selection:
	replace with new and delete [].

	* Multiple Makefile.am patches for out-of-tree building from Ezra
	Peisach.

2004-08-17  Paul Emsley  <paule@chem.gla.ac.uk>

	* src/rama_plot.cc: (setup_internal): changed ramachandran levels
	to something less liberal.

	* src/c-interface.cc: (new_close_molecules) and
	(wrapped_create_new_close_molecules_dialog): created.  Provide a
	new dialog that's much better for multiple molecule closing [which
	is what real crystallographers tend to do].

	* src/globjects.cc: add_alt_conf_show intermediate atoms now set
	to 0 [fixes JPT/FV usability problem].

	* src/callbacks.c (on_phs_cell_choice_ok_button_clicked): added
	have_unit_cell protection.  Fixes a crash.

2004-08-16  Paul Emsley  <paule@chem.gla.ac.uk>

	* src/graphics-info.cc: (fill_rotamer_selection_buttons): Change
	to radio buttons, not normal buttons.  We can see the "active"
	rotamer now.

	* src/c-interface.cc: (execute_find_blobs): created - so you don't
	need to find waters to get this interesting info.  Another
	validation function.

	* high-res/Makefile.am (tracehighres_LDADD): applied Ezra's patch
	to link with coot-compat too.

	* src/c-interface.cc: (safe_python_command): pass a const char *,
	not a string.

	* geometry/protein-geometry.cc: when trying CLIB, don't put an
	extra "lib" in the string.

	* setup/coot.sh export COOT_STANDARD_RESIDUES too.

	* src/graphics-info.cc: (rot_trans_adjustment_changed): Rotate a
	bit more, so we can get more than 100 degree rotation. Fixes KD
	problem.

	(set_bond_thickness_intermediate_atoms): created [along with
	c-interface].

	* src/globjects.cc: return TRUE for draw() and draw_stereo(),
	rather than nothing.

2004-08-11  Paul Emsley  <paulemsley@ysbl.york.ac.uk>

	* ligand/ligand.cc: (find_clusters): change the cut-off level to
	be n sigma of the input map, not n sigma of the map after masking.

2004-08-10  Paul Emsley  <paulemsley@ysbl.york.ac.uk>

	* db-main/db-main.cc: ref_struct_dir should have a coot dir after
	$prefix/share [DATADIR] and before "reference-structures".

2004-08-04  Paul Emsley  <paulemsley@ysbl.york.ac.uk>

	* ideal/simple-restraint.cc: replaced several pow()s.

2004-08-01  Paul Emsley  <paulemsley@ysbl.york.ac.uk>

	* Release 0.0.18

	* src/globjects.cc: (glarea_motion_notify): Add code to rotate
	view for in_edit_chi_mode_flag with the Ctrl key.

	* src/globjects.cc: (gl_extras): If we get a widget when we are
	trying hardware stereo set the display_mode flag [to be used in
	the draw method].

2004-07-31  Paul Emsley  <paulemsley@ysbl.york.ac.uk>

	* src/graphics-info.cc:
	(renumber_residue_range_molecule_menu_item_select): together with
	renumber_residue_range_chain_menu_item_select(),
	fill_renumber_residue_range_dialog(),
	fill_renumber_residue_range_internal() and c-interface-build's
	renumber_residues_from_widget() and
	wrapped_create_renumber_residue_range_dialog() provide the GUI
	inteface to residue range renumbering.

2004-07-30  Paul Emsley  <emsley@localhost>

	* src/mtz-bits.c: (get_f_cols) and (get_phi_cols) and
	(get_weight_cols): the malloc brackets allocating v[i] were
	misplaced causing random crashes.  

2004-07-29  Paul Emsley  <paulemsley@ysbl.york.ac.uk>

	* coords/Bond_lines.cc: (Bond_lines_container constructor for
	environment distances): fixed typo in ch2 contact id - so that now
	atoms in differrent chains will be given distances reguardless of
	residue number [fixes occasional missing environment distance to
	other atom in a different chain].

2004-07-28  Paul Emsley  <paulemsley@ysbl.york.ac.uk>

	* src/molecule-class-info-other.cc (last_residue_in_chain):
	created for use with add_OXT GUI.

	* src/graphics-info.cc: (fill_add_OXT_dialog_internal) created.
	Along with add_OXT_chain_menu_item_activate,
	fill_chain_option_menu, add_OXT_molecule_item_select and
	c-interface-build's apply_add_OXT_from_widget,
	wrapped_create_add_OXT_dialog it provides GUI for add_OXT
	functionality.

	* doc/coot.tex: Applied Ezra Peisach's typo patches.

2004-07-27  Paul Emsley  <paulemsley@ysbl.york.ac.uk>

	* Release 0.0.17

	* Release 0.0.16

	* ligand/dunbrack.cc: (GetResidue): fix it again.

	* Release 0.0.15

	* ligand/dunbrack.cc: (GetResidue): fix the delete of
	ordered_residue_atoms_ppcatom. [Rotamer problem fixed]

2004-07-26  Paul Emsley  <paulemsley@ysbl.york.ac.uk>

	* Release 0.0.14

	* src/c-interface.cc: (wrapped_create_bond_parameters_dialog):
	created.  Along with
	graphics_info_t::fill_bond_parameters_internals() add Bond
	Parameters dialog functionality.

	Note: when adding menu items, the active item can be set only
	after all the items are added - not during the process.

	* src/molecule-class-info.cc: (handle_read_ccp4_map): added
	save_state_command_string codes [the reading of ccp4 maps is now
	saved in the state file].

2004-07-25  Paul Emsley  <paulemsley@ysbl.york.ac.uk>

	* src/command-line.cc: (parse_command_line): add --help argument.

	* geometry/protein-geometry.cc: (init_refmac_mon_lib): Ezra
	Peisach noted that the result of stat() should be tested before
	buf's content is examined.  Fixes potential crash/error on reading
	refmac dictionary when file not found.

	* src/callbacks.c (on_background_colour1_activate): Created. This
	function is used to fix, at long last, the problem of the
	background colour menu radio items [used
	gtk_check_menu_item_set_active].

2004-07-21  Paul Emsley  <paulemsley@ysbl.york.ac.uk>

	* ligand/chi-angles.cc: moved coot::operator<< for simple_rotamer
	here [from dunbrack.cc].

	* setup/coot.csh: make COOT_REFMAC_LIB_DIR be in share/coot/lib

	* setup/coot.sh: make COOT_REFMAC_LIB_DIR be in share/coot/lib

	* src/graphics-info-pick.cc:
	(move_moving_atoms_by_shear_internal): use const int d_array_size
	to dimension d_to_moving_at array.

2004-07-20  Paul Emsley  <paulemsley@ysbl.york.ac.uk>

	* src/graphics-info.cc: (fill_option_menu_with_undo_options):
	added has_model() protection.  Stops undo option menu overing
	options of closed molecules.

	* src/molecule-class-info-other.cc:(renumber_residue_range):
	created.  Also c-interface wrapper. No GUI yet.

	(copy_and_add_residue_to_chain): filled [from stub].  Not tested.

2004-07-19  Paul Emsley  <paulemsley@ysbl.york.ac.uk>

	* src/command-line.cc: (parse_command_line): added --stereo
	argument to turn on hardware stereo.

	* src/globjects.cc: (draw_hardware_stereo) created.  Also draw()
	was renamed to draw_mono and an extra argument was added.
	draw_hardware_stereo() calls draw_mono() twice.

	* src/main.cc: () Don't do most things if gl_extras returns null.

	* src/globjects.cc: (gl_extras): Add an extra arg:
	try_hardware_stereo_flag.  Fiddle with the attribute list if
	trying stereo.  Don't do most things in this function if glarea
	was created null.

	* src/command-line.h: added hardware_stereo flag to class.  More
	stereo support.

	* src/c-interface.cc: mono_mode() and hardware_stereo_mode() added.
	Starting stereo support.

	* setup/coot.csh SYMINFO: added syminfo.  The default place for
	syminfo.lib is in PKGDATADIR.  However, this is not available when
	users do a binary install.  So, we set SYMINFO in the setup file
	and coot will use that [instead of failing to find it where in the
	non-existant directory where it was originally built].  Fixes
	problem with non-existant symmetry library in binary install.
	
	* setup/coot.sh SYMINFO: added syminfo. See above.

2004-07-17  Paul Emsley  <paulemsley@ysbl.york.ac.uk>

	* src/c-interface-info.cc: (output_residue_info): [call] reset to
	zero size the residue edits info vector.  Fixes the [ignored]
	residue info edits problem.

	* coords/mmdb-extras.cc: (get_first_atom_with_atom_name): Fix the
	format of the function definition [from Charles Ballard].

	* src/molecule-class-info.cc: (change_contour): use the max
	contour level to stop the changing of the contour level over the
	maximum of the map.

	* src/xmap-utils.cc: (map_density_distribution): set the min and
	max of the map density.

2004-07-16  Paul Emsley  <paulemsley@ysbl.york.ac.uk>

	* src/c-interface-build.cc: (run_refmac_real): fix problem of
	directory/filename when no ccp4i project set.  Also rewrote so
	that we use a vector of strings that gets converted to an
	executable string just before execution [Python support].

	* src/gtk-manual.c: (update_map_colour_menu_manual): remove a
	strlen debugging line.

2004-07-10  Paul Emsley  <paulemsley@ysbl.york.ac.uk>

	* src/graphics-info.cc: (set_moving_atoms): created.  So that
	molecule_class_info_t function split_residue() can create a moving
	atom object [intermediate atoms are enabled in this case].  Fixes
	crash, fixes alt conf back to how it used to be [with intermediate
	atoms, not drop straight into rotamer].

2004-07-09  Paul Emsley  <paulemsley@ysbl.york.ac.uk>

	* src/callbacks.c (on_rotate_translate_obj_cancel_button_clicked):
	removed graphics_unsetup_rotate_translate_buttons() call and the
	function and its declarations.

	* src/c-interface.cc: (valid_labels): fixed so that the frees are
	commented.  Otherise we get a "double free" [so says Paris]. I
	don't understand why.  Auto-open with invalid labels no longer
	causes a crash.

2004-07-08  Paul Emsley  <paulemsley@ysbl.york.ac.uk>

	* geometry/protein-geometry.cc: (init_standard): make the default
	place be DATADIR/coot/lib/data/monomers/list [where DATADIR is
	PREFIX/share] [i.e. it is moved into package_data_dir].  Use CCP4
	only if there is no other alternative.

2004-07-04  Paul Emsley  <paule@chem.gla.ac.uk>

	* src/graphics-info.cc: (add_cb_to_terminal_res): Added some error
	checking and fixed the looping issues.  Now no crash when also
	adding 2nd residue in add terminal residue.

	(execute_rigid_body_refine): Added missing definition of chain in
	the case of auto_rangle_flag true.  Fixes crash, I hope.

	* src/c-interface.cc: (average_temperature_factor) return a value.

	(median_temperature_factor): return a value.

2004-07-03  Paul Emsley  <paule@chem.gla.ac.uk>

	* Release 0.0.13

	* src/molecule-class-info.cc: (make_backup): use __WIN32__ defines
	to stop the addition of .gz and compression of backup files.  And
	the time in the filename.

	* macros/glut.m4 (AM_PATH_GLUT): Added cygin support for freeglut
	linking.

2004-07-02  Paul Emsley  <emsley@localhost>

	* Release 0.0.12

	* src/command-line.cc (handle_command_line_data): remove not
	running script output.

2004-07-01  Paul Emsley  <emsley@localhost>

	* setup/coot.csh: and coot.sh move reference-structures to
	prefix/coot/share.
	
2004-06-29  Paul Emsley  <paulemsley@ysbl.york.ac.uk>

	* src/c-interface.cc: (fill_option_menu_with_coordinates_options):
	use dotted_chopped_name().

	* src/molecule-class-info.cc: (dotted_chopped_name): created.

	* Release 0.0.11

2004-06-28  Paul Emsley  <paulemsley@ysbl.york.ac.uk>

	* Mutate Sequence work [which calls a scheme [mutate.scm]
	function].  Now available in the gui.

	* src/gtk-manual.c: (update_sequence_view_menu_manual): and
	(update_ramachandran_plot_menu_manual): added extra argument to
	pass the name - so that we can have a name on these menu items
	too.

2004-06-27  Paul Emsley  <paulemsley@ysbl.york.ac.uk>

	* Makefile.am (install-data-local): typo scrdir to srcdir for
	scheme files.

	* geometry/protein-geometry.cc: (try_dynamic_add): change CCP4_LIB
	to CLIB - needed for CCP4 v5.0.

	* src/c-interface-build.cc: (make_backup): externally make a
	backup.

	(set_have_unsaved_changes): externally set have unsaved changes.

	* src/molecule-class-info.h: Add turn_on_backup function.

2004-06-25  Paul Emsley  <paulemsley@ysbl.york.ac.uk>

	* Makefile (install-data-local): Add a fi for scheme's outside if.

	* src/graphics-info.cc: Function to enable anti-aliasing.  Doesn't
	seem to do the job on this mac... it just makes the bonds/density
	lines thicker.

2004-06-24  Paul Emsley  <emsley@localhost>

	* Makefile.am (install-data-local): Added scheme files to coot
	distribution and added code here to install the files.

2004-06-24  Paul Emsley  <paulemsley@ysbl.york.ac.uk>

	* src/molecule-class-info-other.cc: (map_chains_to_new_chains):
	after far too long, I've got a version that I'm happy with.  Now
	doesn't hang.  Merge molecules made available from the gui.

	* Auto-read MTZ file work.

2004-06-23  Paul Emsley  <paulemsley@ysbl.york.ac.uk>

	* setup/coot.sh.in export DYLD_LIBRARY_PATH too!
	(GUILE_LOAD_PATH): Add guile/site [for goosh].  At long last!

2004-06-22  Paul Emsley  <paulemsley@ysbl.york.ac.uk>

	* coot-utils/peak-search.cc: (mask_around_coord): copy, paste and
	fiddle with the function from ligand class.  

	(mask_map): add coordinate masking function to peak_search.

	* high-res/trace-high-res.cc (main): Added the option to use
	weights.

	(main): Use new masked peak searching of peak_search function.

	* src/graphics-info.cc: (show_select_map_dialog): pre-set the
	default [refinement] map to the top of the list.

2004-06-18  Paul Emsley  <paulemsley@ysbl.york.ac.uk>

	* mmtz-extras/mmtz-extras.c: (get_f_phi_columns): Add in anomalous
	data too.

	* mmtz-extras/mmtz-extras.h: Added anomalous data to
	f_phi_columns_t.

	* src/callbacks.c (on_column_label_ok_button_clicked): Added
	anomalous label logic [somewhat contorted - due to mix of mtz f
	column and widget menu item index mixing].

	* src/molecule-class-info.cc: (test_label_symm_atom): apply
	has_model test.

2004-06-16  Paul Emsley  <paulemsley@ysbl.york.ac.uk>

	* src/c-interface.cc: (fill_ligands_dialog): add the setting of
	the "Mask Waters?" checkbutton[s].

2004-06-15  Paul Emsley  <paulemsley@ysbl.york.ac.uk>

	* src/graphics-info.cc: (imol_for_skeleton): changed to match
	Imol_Refinement_Map() model [i.e. is set if only one map present].

	* src/callbacks.c (on_dynarama_cancel_button_clicked): and
	(on_dynarama_ok_button_clicked) removed the call to
	set_dynarama_is_displayed(0), because this is done [again
	otherwise] now that we have the destroy window callback.

	* src/rama_plot.cc: (add_phi_psi): added DeleteSelection.  Quite a
	bit faster now for big molecules.

2004-06-14  Paul Emsley  <paulemsley@ysbl.york.ac.uk>

	* src/molecule-class-info-other.cc: split_residue and its siblings
	moved from graphics-info.cc to here - where they should be. Added
	extra code so that by default rotamers are run immediately after
	Add Alt Conf.  A good thing.
		
2004-06-12  Paul Emsley  <paulemsley@ysbl.york.ac.uk>

	* src/c-interface.cc: (median_temperature_factor): and
	(average_temperature_factor) added interfaces to utility
	functions.

	* geometry/protein-geometry.cc:
	(have_dictionary_for_residue_type): Added try_dynamic_add - not a
	const function any more.

	* coot-utils/coot-coord-utils.cc: (median_temperature_factor): added.
	(average_temperature_factor): Added.

2004-06-11  Paul Emsley  <emsley@localhost>

	* src/globjects.cc: (rotate_rgb):

2004-06-10  Paul Emsley  <emsley@localhost>

	* coords/Bond_lines.cc: (do_Ca_bonds_internal): added
	bonds_size_colour_check() before addBond().

	* src/graphics-info.cc: (show_select_map_dialog): use the option
	map filler which sets the default menu item too.

	(update_go_to_atom_window_on_changed_mol): changed if
	(go_to_atom_imol == imol) to if (1)

	(fill_option_menu_with_map_options): created - this version has
	also is passed an int that is the molecule for the default
	position.

2004-06-09  Paul Emsley  <emsley@localhost>

	* src/callbacks.c (on_show_symmetry_ok_button_clicked): Added the
	analysis of the new checkbuttons [symmetry colouring, symop
	colouring, symmetry whole molecule and symmetry expanded labels ].

2004-06-08  Paul Emsley  <emsley@localhost>

	* src/callbacks.c (on_dynarama_window_destroy): Glade created
	signal. Added for people who close this widget with window
	manager, not buttons.

	* src/graphics-info.cc: (execute_rigid_body_refine): rearranged
	code for case of auto_rangle_flag being true.

2004-06-07  Paul Emsley  <emsley@localhost>

	* src/c-interface-info.cc: (output_residue_info): added model? 
	protection.

2004-06-04  Paul Emsley  <paule@chem.gla.ac.uk>

	* src/graphics-info.cc: (wrapped_check_chiral_volumes_dialog),
	(on_bad_chiral_volume_button_clicked): created for bad chiral atom
	vbox dialog.  OK, we have chiral volume analysis - hooked into the
	Calculate menu.

	* geometry/protein-geometry.cc: (get_monomer_chiral_volumes):
	created [used in bad chiral testing].

	* src/molecule-class-info-other.cc (bad_chiral_volumes): created. 

2004-06-01  Paul Emsley  <paulemsley@ysbl.york.ac.uk>

	* db-main/db-main.cc: (fill_with_fragments): moved to
	n_filled_residues() usage and a few other things.  Makes the
	"oops: zero atoms for residue 1 in molecule number 27" [etc]
	dissappear.

	* GLOBAL change of minimol's fragment n_residues() to
	max_residue_number().  Also found many loops over residues of a
	fragment and set their start point to min_res_no() replacing 1.

2004-05-30  Paul Emsley  <paulemsley@ysbl.york.ac.uk>

	* coords/Bond_lines.cc: (do_Ca_bonds_internal): Add altconf check
	so we don't get wrong altconf bonding.

2004-05-28  Paul Emsley  <paule@chem.gla.ac.uk>

	* ligand/ligand.cc: (mask_map [short int]): Change the water logic.

	* src/callbacks.c (on_symmetry_colour_patch_button_clicked): set
	the colour of the symmetry [at long last!].

	* src/molecule-class-info.cc:
	(set_symm_bond_colour_mol_rotate_colour_map): put the colour map
	rotation outside the colour merge - so that symmetry colours are
	always rotated [when
	graphics_info_t::symmetry_rotate_colour_map_flag is set].

2004-05-27  Paul Emsley  <paule@chem.gla.ac.uk>

	* geometry/protein-geometry.cc: (standard_protein_monomer_files):
	added MSE [selenomet].

	* src/mtz-bits.c: (manage_column_selector): set the phases to -1
	initially.

	* src/callbacks.c (on_column_label_ok_button_clicked): added test
	for unset [-1] phi col - print an error message do nothing in such
	a case.

	* coot-utils/trim.cc: (trim_molecule_by_map): created [namespace
	util].
	
2004-05-25  Paul Emsley  <emsley@localhost>

	* src/molecule-class-info.cc: (draw_molecule): added has_model()
	protection.

	(draw_skeleton): added has_map() protection.

	(draw_map_unit_cell): added has_map() protection.

	(anisotropic_atoms): added has_model() protection.

	These protections may make close molecule go away [for good this
	time?].  All the molecule functions of globject.cc's draw have
	protection now.

	* coords/Bond_lines.h: (bonds_size_colour_check): expand bonds if
	we need to.

2004-05-24  Paul Emsley  <emsley@localhost>

	* src/graphics-info-state.cc: (save_state): save 0-coot.state.py
	if we are using python.

2004-05-19  Paul Emsley  <paulemsley@ysbl.york.ac.uk>

	* src/graphics-info.h: added symmetry_atom_labels_expanded_flag so
	we can have "-X,Y+1/2,-Z" and the like in an atom label - this is
	just the flag to do that - not the implementation.

	* src/c-interface.cc: (set_symmetry_whole_chain): Do we want the
	whole chain of a symmetry related molecule, rather than just a
	sphere of its atoms?

	* src/molecule-class-info.h: move symmetry_bonds_box to vector of
	graphical_bonds_containers [so that we can have colour-by-symop].

	* high-res/sequence-assignment.hh: created [along with
	sequence-assignment.cc of course].

2004-05-18  Paul Emsley  <paulemsley@ysbl.york.ac.uk>

	* coords/Bond_lines.cc: (do_Ca_bonds_internal): make the bond
	colour use the commented [strangely] code for chain colouring
	rather than atom type colouring [which is how it used to be].

	(addSymmetry_vector_symms): created, a wrapper round individual
	symmetry operators, so that we return an entity that can be
	coloured by symmetry operator.

	* src/c-interface.cc: Add CCP4_SCR to ccp4i project directories.

2004-05-17  Paul Emsley  <paulemsley@ysbl.york.ac.uk>

	* src/c-interface.cc: (set_background_colour): redraw after
	setting the colour.

2004-05-14  Paul Emsley  <emsley@localhost>

	* src/molecule-class-info.cc: (handle_read_draw_molecule): added
	test for initially unset bonds type [and set it to normal if
	unset] - we do this because undo does a
	handle_read_draw_molecule() which otherwise reset the bond type to
	normal.

2004-05-13  Paul Emsley  <emsley@localhost>

	* Release 0.0.8

	* mini-mol/mini-mol.cc: (setup) Don't try to store residues with
	negative or 0 residue numbers [which caused a crash].  Print out a
	warning instead.

2004-05-11  Paul Emsley  <emsley@localhost>

	* src/molecule-class-info.cc: (close_yourself): set the number of
	labels and symmetry labels to 0.

	(label_atoms): put in has_model() protection.  No more labels for
	closed molecule.

	(test_label_symm_atom): put in range protection to atom index.

2004-05-08  Paul Emsley  <paule@chem.gla.ac.uk>

	* src/graphics-info-defines.cc: (check_if_in_regularize_define):
	Added a call to add/remove a label when an atom is clicked [and a
	redraw].  Visual feedback. 

	* src/graphics-info-defines.cc: (check_if_in_refine_define): Ditto
	above.
	
2004-05-07  Paul Emsley  <paule@chem.gla.ac.uk>

	* src/c-interface.cc: (run_command_line_scripts): created.  Using
	new data member of graphics_info_t [command_line_scripts].  We can
	now run scripts from the command line.

	* src/c-inner-main.c: (c_inner_main): moved run_state_file_maybe()
	here.  Also run_command_line_scripts() here.

2004-05-06  Paul Emsley  <paule@chem.gla.ac.uk>

	* high-res/Makefile.am (INCLUDES): Add compat [bug found when
	trying to compile on Mac OS X].

	* setup/coot.csh: moved the place of the reference structures.
	Now in $prefix/share/coot/reference-structures

	* setup/coot.csh: Ditto.

	* src/molecule-class-info-other.cc: (assign_fasta_sequence): 

2004-05-05  Paul Emsley  <paule@chem.gla.ac.uk>

	* src/molecule-class-info.cc: (set_skeleton_bond_colour): moved to
	this class - deleted from globject.cc.  Added colour rotation.

	* src/graphics-info.cc:
	(fill_option_menu_with_coordinates_options_internal):
	created. There is a wrapper without the set_last_active_flag [set
	to 0] which is how the old function worked.  The
	update_go_to_atom_window_on_new_mol() now calls this function
	directly rather than going through a wrapper.  The result is that
	when a new molecule is read and the Go To Atom Window is up, then
	the option menu moves to the new molecule [and the residue list
	too, of course].
	
	* src/c-interface.cc: (free_memory_run_refmac): put protection
	round usage of gtk_object_get_user_data(active_item) - we don't
	want to do that if the option_menu is empty and active_item is
	therefore null.

2004-05-04  Paul Emsley  <paule@chem.gla.ac.uk>

	* src/graphics-info-state.cc: (save_state_file): add sigma step
	info if appropriate.

	* src/molecule-class-info.cc: (install_model): add extra argument
	display_in_display_control_widget_status, so that "terminal
	residue" doesn't appear there.

	(get_map_contour_sigma_step_strings): created so that we can pass
	it's value to the state saver.

	* macros/mmdb-ssm.m4 (AM_WITH_MMDBSSM): If there is no ssm, let it
	say so [result: no].

	* coot-utils/Makefile.am (libcoot_utils_la_SOURCES): moved
	peak-search here from ligand, so that high-res doen't depend on
	ligand lib [because ligand lib depended on high res].

	* high-res/coot-atom-graph.cc (peptide_search): experimenting...

2004-05-02  Paul Emsley  <paule@chem.gla.ac.uk>

	* src/callbacks.c (on_single_map_sigma_checkbutton_toggled):
	created.  Now there is a property of maps that so that it can be
	contoured by sigma.  Auxillary functions
	set_contour_by_sigma_step_by_mol(), set_contour_by_sigma_step()
	and variables in molecule_class_info_t [contour_by_sigma_flag,
	contour_sigma_step].

2004-05-01  Paul Emsley  <paule@chem.gla.ac.uk>

	* src/callbacks.c (on_libcheck_monomer_ok_button_clicked):
	handle_get_libcheck_monomer_code needs the entry widget, not the
	top-level.

	(on_libcheck_monomer_ok_button_clicked): No need to destroy
	widget, that's done in handle_get_libcheck_monomer_code().

	* src/c-interface.cc: (handle_get_libcheck_monomer_code): the
	widget is "libcheck_monomer_dialog" not "accession_code_window"

	* mmtz-extras/mmtz-extras.c: (mmtz_get_column_headers): malloc one
	more column [ncol+1] prevents valgrind write error. Fixes KD
	problem? [Can't see how, to be honest].

	* src/graphics-info.cc: (make_moving_atoms_graphics_object):
	regularize_object_bonds_box.clear_up() added - valgrind saying we
	are loosing 200K here.

2004-04-29  Paul Emsley  <paule@chem.gla.ac.uk>

	* Release 0.0.6

	* src/main.cc (main): uncomment setup_symm_lib() call.  Grr - must
	have been left in from testing. New release required then.

	* Release 0.0.5

	* db-main/Makefile.am (testdbmain_LDADD): top_scrdir not
	top_scrdir.  [not enough testing before putting release on
	web-site - rushing to go to Trossachs].

2004-04-27  Paul Emsley  <paule@chem.gla.ac.uk>

	* Release 0.0.4

	* db-main/db-main.cc: Add a default place
	DATADIR/reference-structures that can be over-ridden by an
	environment variable.  Non-so-nimble footwork sorting out the
	directory and stating added.  Also fixed up Makefile.am here to
	add coot-utils.

2004-04-22  Paul Emsley  <paule@chem.gla.ac.uk>

	* src/globjects.cc (key_press_event): When in baton mode, a Cntl-Z
	is baton_build_delete_last_residue().

	* src/molecule-class-info.cc: (delete_atom): Add altconf argument
	- the mind boggles how I didn't include this before now...

	* src/callbacks.c (on_close_molecule_close_button_clicked): Don't
	destroy the widget when close molecule button is hit [easier now
	to close lots of molecules].

	* Makefile.am (install-data-local): install syminfo.lib.

	* src/main.cc: (setup_symm_lib): setenv SYMINFO if it is not set
	already and point it to pkgdatadir/syminfo.lib.

	* src/callbacks.c (on_libcheck_monomer_ok_button_clicked): Add
	handle_get_libcheck_monomer_code() call, so that this button
	actually works now [oops :-)].

	* src/molecule-class-info.cc: (map_fill_from_mtz): removed
	Map_stats() usage, replaced with map_density_distribution() usage
	[12ms for statistics now - somewhat better].

	* src/molecule-class-info.cc (Have_unsaved_changes_p): return 0
	when there is no model [stops maps and closed molecules returning
	true [no method to save maps yet [not even sure there should be]]].

2004-04-18  Paul Emsley  <paule@chem.gla.ac.uk>

	* Release 0.0.3

	* coords/Bond_lines.cc: (atom_colour): Use DISULFIDE_COLOUR not
	DISPHIDE_COLOUR [in the header also].  When DISPHIDE_COLOUR return
	green [Fixed non-sulfur-coloured disulphide bonds now].
	
	* src/globjects.cc (key_press_event): Added key bindings for zoom
	and clipping.

2004-04-17  Paul Emsley  <paule@chem.gla.ac.uk>

	* src/molecule-class-info.cc: (get_term_type): can now return "MC"
	[middle residue treat as C term] and "MN" [middle residue treat as
	N term] depending on where the user clicked. Fixes EJD's add
	terminal residue bug.

	* ligand/residue_by_phi_psi.cc: (best_fit_phi_psi): Here and
	everywhere else in the class where we test for "C", the test now
	included "MC".

2004-04-16  Paul Emsley  <paule@chem.gla.ac.uk>

	* mini-mol/mini-mol.cc (set_cell_symm): moved mmdb_cell to
	std::vector usage so that implicit copy operator works on a
	minimol.

	* ligand/ligand-extras.cc: (flood): created.  No mixing and
	messing with water fit now.

	* Release 0.0.2
	
	* src/c-interface.cc: (close_molecule): remove void * usage.  Does
	this help?

2004-04-15  Paul Emsley  <paule@chem.gla.ac.uk>

	* src/graphics-info.cc: (create_mmdbmanager_from_res_selection):
	added extra arg so that we don't confuse mmdbmanager from altconf
	split with that from refinement [the whole-residues rules are
	different].  Closes JPT's altconf split bug [but not the feature
	requests].

	* setup/coot.sh.in move prefix before the no-modifications line.

	* setup/coot.csh.in: move prefix before the no-modifications line.

	* src/molecule-class-info.cc: (unused_chain_id): return a status
	too so that we know if the chain is usable. No more crashing when
	trying to add 27th chain.  Extended to lowercase chain usage.

	* src/c-interface.cc: (run_script): removed macroed code and
	instead choose the script-running function based on extension
	[everything is scheme unless it ends in ".py"].  Still python
	SWIGged functions not available however.  [Might need some
	on-the-fly patching].

	* src/main.cc (main): Put PYTHON macroed code before GUILE, so
	that python is initialized when we have --with-guile
	--with-python, which deals with "Fatal Python error:
	PyThreadState_Get: no current thread".

	* src/molecule-class-info.cc: (map_fill_from_mtz): Added GLUT
	timers round MTZ to map conversion.  Now we can get some numbers
	for how fast is Macintosh.

	* src/Makefile.am (INCLUDES): Added GSL_CFLAGS GSL_LIBS properly
	[as set by configure] - not my made-up guess.

2004-04-14  Paul Emsley  <paule@chem.gla.ac.uk>

	* src/globjects.cc (key_press_event): Added keyboard equivalents
	for rotations [for Luca].

	* coords/Bond_lines.cc (construct_from_atom_selection): to this
	and several other routines was added atom_colour_type argument.
	The atom colour type in the centre of the loop now calls the
	member function atom_colour().  (do_colour_sec_struct_bonds):
	created using this system - also
	(do_Ca_plus_ligands_colour_sec_struct_bonds) [which looks quite
	cute - nice one Stuart].

	* Src/c-interface.cc: (handle_read_ccp4_map): added extra arg
	is_diff_map_flag which takes the value from the new map filefilter
	checkbutton.

	* src/molecule-class-info.cc: (change_contour): Fixed contour
	level logic for difference map.

2004-04-10  Paul Emsley  <paule@chem.gla.ac.uk>

	* high-res: created.  Just playing for now.
	
2004-04-09  Paul Emsley  <paule@chem.gla.ac.uk>

	* src/c-interface.cc: (close_molecule): Added extra trap for null
	*imol [should never happen].  Does this catch the close molecule
	crash bug?

	* src/molecule-class-info.cc: (read_ccp4_map): Return 0, not
	nothing - how could this bug have existed for so long? Mind
	boggling. No longer random apparent failure to read map.

2004-04-01  Paul Emsley  <emsley@localhost>

	* src/graphics-info.cc: (geometry_objects): brightened the line
	and label colour.

	* src/molecule-class-info.cc: (label_symm_atom): Brighten symmetry
	label colour.

	* src/molecule-class-info.cc (get_map_contour_strings): and
	(set_contour_level), with changes in c-interface.h and
	graphics-info-state.cc (save_state_file): allow the setting/saving
	of the map contour level.

	* Release 0.0

2004-03-30  Paul Emsley  <paule@chem.gla.ac.uk> 
	* Release coot-0.0.0-pre-9

	* src/c-interface-superpose.cc: (execute_superpose): reordered macros.

	* ligand/find-ligand.cc: Added getopt portability gubbins.

	* ligand/find-waters.cc: Likewise.

2004-03-29  Paul Emsley  <paule@chem.gla.ac.uk>

	* macros/glut.m4 (AM_PATH_GLUT): Added /usr/X11R6 args to GLUT
	prefixes for powerpc-apple-darwin*.

	* src/c-interface-superpose.cc: (superpose): Also
	(execute_superpose) (wrapped_create_superpose_dialog) created for
	SSM superposition interface.  Nice.

2004-03-27  Paul Emsley  <paule@chem.gla.ac.uk>

	* src/molecule-class-info.cc: (full_atom_spec_to_atom_index): Deal
	with the case that selection with atom name "*HO2" finds all the
	atoms in the residue.

2004-03-26  Paul Emsley  <paule@chem.gla.ac.uk>

	* src/molecule-class-info.cc: (name_for_display_manager): created.
	Used to give a name of the molecule to the Display Manager.  We
	can optionally truncate the pathsnames.

	(stripped_save_name_suggestion): created [for use with save
	fileselection.

	* src/globjects.cc: change rotamer_fit_clash_flag default to on (1).

2004-03-25  Paul Emsley  <paule@chem.gla.ac.uk>

	* src/c-interface.cc: (fill_option_menu_with_coordinates_options):  
	Changes to the active menu item.  If the molecule is not being
	draw, don't allow it to be the default [active] molecule [unless
	all molecules are undisplayed]. Concomitant test in
	graphics-info_t::go_to_atom_residue().

	* src/main.cc (main): If no symmetry pop-up a dialog saying so.

2004-03-24  Paul Emsley  <paule@chem.gla.ac.uk>

	* src/graphics-info.cc: (do_rot_trans_adjustments): The widget for
	rotations and translations was changed to use hscales.  This
	functions sets the adjustments and the callback [which was pretty
	much the same as rot_trans buttons code except we added a float
	array to store the previous hscale adjustments.

	* src/graphics-info-state.cc: (save_state_file): diff_map_iso_level_increment
	uses function that uses specified dec pl.

2004-03-14  Paul Emsley  <paule@chem.gla.ac.uk>

	* src/c-interface.cc: (fill_go_to_atom_window): Added
	gtk_container_set_focus_vadjustment call to connect the scolled
	window adjustment to the residue_list adjustment. Bingo! Scrolling
	residue list on synthetic residue selction! Woohoo! [At last].
 
	* coords/mmdb.cc: (get_atom_selection): Added MMDBF_IgnoreRemarks
	to MMDB reading flags.

2004-03-12  Paul Emsley  <paule@chem.gla.ac.uk>

	* ligand/ligand.cc: (cluster_ligand_size_match): Changed limit for
	big ligand vs small density from 10.0 to 7.0

2004-03-11  Paul Emsley  <paule@chem.gla.ac.uk>

	* ligand/ligand.cc: (find_clusters): Completely re-written.
	Introduced new concept: stl::queue, the use of which avoids
	requiring recursion [trace_along() no longer required, therefore].

2004-03-10  Paul Emsley  <paule@chem.gla.ac.uk>

	* Menubar updated: Measures changed so that distances and angles
	creates a pop-up.  Pop-up toggle buttons for angles and distances.

	* src/c-interface.cc: (handle_filename_filter): Created - now we
	have filename filter - "hooray!" say the users.  Called after a
	"Return" in the entry's on_filename_filter_key_press_event().

	* src/c-interface.cc: (pre_directory_file_selection): created -
	used by above.

2004-03-04  Paul Emsley  <emsley@localhost>

	* geometry/protein-geometry.cc: (comp_torsion): If this has an id
	that contains "CONST" let's not include it in variable torsions.

2004-02-28  Paul Emsley  <paule@chem.gla.ac.uk>

	* coords/Bond_lines.cc: (do_normal_bonds_no_water): Created.  

	(add_ligand_bonds): which is called by
	(created.do_Ca_plus_ligands_bonds): [created].  Now we have
	no_water and ca+ligand representations.

2004-02-27  Paul Emsley  <paule@chem.gla.ac.uk>

	* Release 0.4.84.  I've made lots of changes - many undocumented
	to fix the issues of Tue Feb 17 16:09:16 GMT 2004.

2004-02-23  Paul Emsley  <paule@chem.gla.ac.uk>

	* src/molecule-class-info.cc: (unalt_conf_residue_atoms): Where we
	delete conformation B, conformation "A", the only one remaining
	should be renamed with altconf "".  Called from
	delete_residue_with_altconf().

	* src/graphics-info.cc: (find_atom_index_from_goto_info): Added
	DeleteSelection(). Use UDD to find atom index.

	* (intelligent_near_atom_centring): set also the altLoc from the
	intelligent atom return index.

	* coords/Bond_lines.cc: (do_disulphide_bonds): Added altLoc test.

	* src/globjects.cc: (do_screen_z_rotate): created.  Called from
	mouse motion callback (glarea_motion_notify).  Z-rotation on
	shift-rightmouse.

2004-02-22  Paul Emsley  <paule@chem.gla.ac.uk>

	* ligand/residue_by_phi_psi.cc: (get_connecting_residue_atoms):
	updated to account for the fact tht if there are 2 atoms in a
	residue with the selected name [which happens if there is an
	altconf], then GetAtom() returns NULL.  So we do some rather
	long-winded altconf testing. We can now attach a terminal residue
	to a residue that has an altconf.

	* src/graphics-info.cc: (copy_mol_and_refine): make it return a
	short int rather than void so that we know if we have found
	restraints. Likewise copy_mol_and_regularize.

 	(create_mmdbmanager_from_res_selection): For flanking residues,
	set whole_res_flag to 1 so that alt confs of previous atoms are
	found even if "" is not.

	* ideal/simple-restraint.cc: (make_restraints): only calculate NBC
	restraints if there were restraints already [no more blowing up
	minimal description ligands].

	(construct_non_bonded_contact_list):
	filter_non_bonded_by_distance() changed to 8.0.  Will [hopefully]
	stop crashes from atoms that move big distances in
	pull-refine/regularize.

	* coords/Bond_lines.cc: (construct_from_atom_selection): only add
	udd_handle for "found bond" if we actually draw the bond [was
	failing in Florences case of a split water - close to the alt conf
	of itself].

	Also changed the if (1) to the commented
	are_different_atom_selections.  Not sure why it had been commented
	[testing some other thing?].

2004-02-21  Paul Emsley  <paule@chem.gla.ac.uk>

	* ideal/simple-restraint.cc: (is_nucleotide): added.  Called by
	functions that previously presumed that the link type was "TRANS".

	* sequence-view/sequence-view.cc: (setup_canvas): set the usize_y
	of the canvas according to the number of chains [n_chains added to
	function args].

2004-02-20  Paul Emsley  <paule@chem.gla.ac.uk>

	* src/graphics-info-state.cc: (save_state_file): Added cif
	dictionary reader.

2004-02-19  Paul Emsley  <emsley@localhost>

	* doc/coot.tex (section{Rotate/Translate Zone}): Updated - now
	with control click info and alt conf info.

	* src/graphics-info.cc: (execute_rotate_translate_ready): Use the
	atom1 alt conf in the atom selection.

	* src/molecule-class-info.cc:
	(initialize_map_things_on_read_molecule): brighten differnce map.

	* src/graphics-info.cc: (split_residue_internal): Set the
	occupancy of the new atoms.

	* src/molecule-class-info.cc: (delete_residue_with_altconf):
	created - now only atoms with the same altconf [as the selected
	atom] get deleted.

	* src/c-interface-build.cc: (delete_residue_with_altconf): created
	as interface to the molecule_class_info_t function.

2004-02-13  Paul Emsley  <emsley@localhost>

	* src/globjects.cc: (gl_extras): add GDK_GL_DEPTH_SIZE to the
	attrlist - hooray depth-testing problem solved!

2004-02-11  Paul Emsley  <emsley@localhost>

	* macros/glut.m4 (AM_PATH_GLUT): Add mips special case

	* Release 0.4.81

	* src/molecule-class-info.cc: (is_mmcif): created: we test for
	.cif or .mmcif so that, in that case, we write a cif file, not a
	pdb file.  Added a tooltip to the save coordinates fileselection
	to that effect.

	* mapview.glade: various changes to improve the MTZ/refmac
	parameters dialogs [help button created].

	* src/graphics-info.cc:
	(go_to_atom_atom_list_signal_handler_event): created.  Just the
	same as the residue version.  We now have double click on atom
	names too, woohoo!

	* src/graphics-info-pick.cc: (move_single_atom_of_moving_atoms):
	created.  So that we can move just one atom [obviously].  Called
	by globject.cc's mouse motion handler.

2004-02-10  Paul Emsley  <paule@chem.gla.ac.uk>

	* Release 0.4.80

	* src/graphics-info.cc: (execute_setup_backbone_torsion_edit): Added
	search_altconf and chain_id in atom selection parameters [d'oh].

2004-02-09  Paul Emsley  <paule@chem.gla.ac.uk>

	* mini-mol/mini-mol.hh: (atom constructor): added data item altLoc
	- and made minor changes in the program elsewhere to compensate.
	Autofit rotamer alt conf now works.

2004-02-08  Paul Emsley  <paule@chem.gla.ac.uk>

	* src/graphics-info.cc: (split_residue), (get_residue_alt_confs),
	(make_new_alt_conf), (split_residue_internal), together with:

	* src/molecule-class-info.cc (insert_coords_chage_altconf).  Big
	push to get residue splitting to work.  I think it does now.
	That's great.

2004-02-07  Paul Emsley  <paule@chem.gla.ac.uk>

	* src/graphics-info.cc: (split_atom_name): created - called by
	find_atom_index_from_goto_info, which reads a gtk entry for the
	atom name [and that could have a , in it to specify the alt conf].

	* src/molecule-class-info.cc: (insert_coords_chage_altconf):
	created.  Change the altconf of atoms in the already-existing-set
	that correspond to new atoms to altconf "A".

2004-02-06  Paul Emsley  <paule@chem.gla.ac.uk>

	* ideal/simple-restraint.cc: (make_monomer_restraints): removed
	the DeleteSelection(selHnd) [causes crash.  It should be in the
	destructor].

2004-02-05  Paul Emsley  <paule@chem.gla.ac.uk>

	* ligand/dunbrack.cc: (GetResidue): changed the indexing order of
	pscontact -> vector<int> fixes contact indices order. Hoorah -
	correct rotamers!

	* src/graphics-info.cc: (update_go_to_atom_window_on_changed_mol):
	Added a signal handler
	(go_to_atom_residue_list_signal_handler_event) to each menu item,
	the handler calls apply_go_to_atom_from_widget() - which I carved
	out of callback.c's on_go_to_atom_apply_button_clicked [which
	calls this new function via the c-interface].  So you can now
	double click on a residue name in the go to atom list and it goes
	there.

	* Release 0.4.78

	* src/globjects.cc: (glarea_button_press): Added code to check if
	was in range define - only if not, do we then
	check_if_moving_atom_pull().

	* ideal/simple-restraint.cc: (construct_non_bonded_contact_list):
	added code to remove OXT from non-bonded contact list.

2004-02-04  Paul Emsley  <paule@chem.gla.ac.uk>

	* src/molecule-class-info.cc: (remove_atom_labels): created.  Also
	remove_all_atom_labels in graphics-info and c-interface.cc

	* coords/Bond_lines.cc: (addSymmetry_calphas): remove debugging
	statement.

	* ideal/simple-restraint.cc: (make_monomer_restraints): add
	DeleteSelection at the end.

	* src/c-interface.cc:
	(read_phs_and_make_map_using_cell_symm_from_mol): Add have_map()
	protection.  Also use d2rad on converting from mmdb cell to
	clipper cell.

	* src/molecule-class-info.cc: (make_map_from_phs): Use d2rad on
	converting from mmdb cell to clipper cell.

2004-02-03  Paul Emsley  <paule@chem.gla.ac.uk>

	* ligand/residue_by_phi_psi.cc:
	(construct_prev_res_from_rama_angles): use next_ca next_n, this_c
	to position this_o, not some garbage geometry that I had
	previously.

2004-02-01  Paul Emsley  <paule@chem.gla.ac.uk>

	* ligand/ligand-extras.cc: (move_atom_to_peak): Change shift_len
	limit to 0.001 [from 0.01] and add a counter max to the while loop
	just in case.  Also change to refining against the map passed as a
	parameter - not the pristine map [d'uh!].

	* ligand/ligand.cc: (import_map_from): create a new form of the
	function that sets th e rms of the map, when then gets used in a
	kludgey way to set the gradient scale.

	* ligand/ligand.cc: (calculate_gradient_scale): use the rms [if it
	has been set] to set the gradient_scale.

2004-01-31  Paul Emsley  <paule@chem.gla.ac.uk>

	* src/molecule-class-info.cc: (draw_coord_unit_cell): Don't do
	this if there n_selected_atoms == 0;

	* src/globjects.cc: (glarea_motion_notify): If we are not in
	refine mode [last_restraints_size > 0] then simple translate
	moving coords.

	* ligand/ligand.cc: (make_pseudo_atoms): Use the mmdb write
	function not the clipper::MMDB for aniso-ligand-centres.pdb so
	that the clipper fatal error is not called.

2004-01-30  Paul Emsley  <paule@chem.gla.ac.uk>

	* Release 0.4.77

	* src/molecule-class-info.cc: (zero_occupancy_spots): display zero
	occupancy spots.

	* coords/Bond_lines.cc: (add_zero_occ_spots): created for both
	graphical_bonds_container and Bond_lines_container as a container
	for zero occupancy spots.

	* Release 0.4.76

	* src/graphics-info-defines.cc:
	(check_if_in_geometry_range_defines): add symmetry atom pick so we
	can have distances to symmetry atoms [obviously]. Created
	display_geometry_distance_symm() as support.

2004-01-29  Paul Emsley  <paule@chem.gla.ac.uk>

	* Release 0.4.75

	* ligand/ligand-extras.cc: (water_fit): Created a copy of xmap
	post mask [xmap_pre_cluster].  Use that to refine against - not
	the pristine map.

	* src/c-interface.cc: Change set_map_atom_mask_radius value to 1.9 from 1.2

	* ligand/ligand.cc: ligand::ligand Change map_atom_mask_radius to
	1.2 (from 0.8).

	* src/c-interface-build.cc: (clear_pending_delete_item): created -
	used in callback of delete_item cancel button - deletes the
	atom/residue-to-be-delete flags.

	* src/callbacks.c (on_rotate_translate_obj_ok_button_clicked): use
	clear_up_moving_atoms() not just clear_moving_atoms_object().

	(on_rotate_translate_obj_cancel_button_clicked): use
	clear_up_moving_atoms() not just clear_moving_atoms_object().

2004-01-28  Paul Emsley  <paule@chem.gla.ac.uk>

	* ligand/ligand.cc: Change the masking radius to 1.9. 1.2
	[previous value] made the maps look skruffy - much better now.

2004-01-26  Paul Emsley  <emsley@localhost>

	* src/molecule-class-info.cc: (add_typed_pointer_atom): correct
	the positioning of the atom names for BR, CA, CL, MG, OW1.

	* src/c-interface.cc: (execute_find_waters_real) update the goto
	atom widget's molecule and residue list if appropriate.

	* src/molecule-class-info.cc: (install_model): add
	have_unsaved_changes_flag.

2004-01-25  Paul Emsley  <emsley@localhost>

	* ligand/ligand-extras.cc: (water_fit): write out the coordinates
	of the cluster centre that are too big to fit waters.

	* src/graphics-info.cc: (import_all_refmac_cifs) only close a
	subdir if it opened successfully and silently skip over files that
	are not directories.

	* src/c-interface.cc: (make_and_draw_map): If weights were not
	useds, weights_col was not defined, but was used to make a string
	to pass to map_fill_from_mtz - now defaults to "" when there are
	no_weights.

2004-01-23  Paul Emsley  <emsley@localhost>

	* coords/mmdb-extras.h: clear_contact_info(): created to give back
	the PSContact memory after we have finished with a contact_info.

	* Release 0.4.71

	* macros/glut.m4 (AM_PATH_GLUT): Fixes for fedora.

2004-01-22  Paul Emsley  <emsley@ysbl.york.ac.uk>

	* src/molecule-class-info.cc: (get_standard_residue_instance)
	Return null on failure.  Add protection against standard residues
	not being read by using read_success.

2004-01-21  Paul Emsley  <emsley@ysbl.york.ac.uk>

	* src/command-line.cc: (parse_command_line) chars are not ints! -
	change ch to an int - solves SGI unaccounted optarg condition.

	* src/c-inner-main.c: (c_inner_main) change error message to match
	searched-for scm file [coot.scm].

2004-01-19  Paul Emsley  <paule@chem.gla.ac.uk>

	* Release 0.4.68

2004-01-15  Paul Emsley  <paule@chem.gla.ac.uk>

	* atom-utils/Makefile.am (INCLUDES): added ideal directory too.

2004-01-14  Paul Emsley  <paule@chem.gla.ac.uk>

	* Release 0.4.67

	* src/graphics-info-pick.cc: (do_post_drag_refinement_maybe) Added
	idle function to do minimization.

	* src/graphics-info-pick.cc: (check_if_moving_atom_pull): created:
	This is called by globject's button_press callback, and sets up
	moving atom drag.  This is called by mouse motion callback.

	* src/graphics-info-pick.cc: (move_moving_atoms_by_shear_internal)
	created - so that the other "moving" atoms move when we move the
	picked moving atom.

2004-01-10  Paul Emsley  <paul@chem.gla.ac.uk>

	* ligand/chi-angles.cc: (setup_chi_atom_pairs) change CG to CG1
	    for ILE - Ooops.

2004-01-07  Paul Emsley  <paul@chem.gla.ac.uk>

	* src/pick.cc: (moving_atoms_atom_pick) created so that we can
	    pick the atoms of the moving atoms molecule.  This will allow
	    click and drag of moving atoms - hopefully with some
	    refinement thrown in...

	* src/pick.h: Add function moving_atoms_atom_pick();

2003-12-31  Paul Emsley  <paul@chem.gla.ac.uk>
	
	* macros/gtkgl.m4: changed GL_LIBS to be GL_LDOPTS - which includes 
		the -L for the directory if needed.

	* macros/glut.m4: added powerpc special case because it can't find 
			libXmu.

	* Release 0.4.66

	* macros/guile.m4 (GUILE_PROGS): AC_MSG_ERROR for guile-config and
	    guile removed - so that we don't fail to configure when guile
	    is not present.

	* src/c-interface.cc: Added various HAVE_CANVAS preprocessor tests
	    that I found to have problems when building on new Mac OS X
	    laptop.

2003-12-26  Paul Emsley  <paul@chem.gla.ac.uk>

	* src/c-interface.cc: (make_and_draw_map) return int, not void so
	    that we can use the molecule number in a script.

2003-12-24  Paul Emsley  <paul@chem.gla.ac.uk>

	* Release 0.4.65

	* src/graphics-info.cc: (show_select_map_dialog) created.  I split
	    out the map selection from the old refine parameters dialog -
	    and changed functions that called show_refine_params_dialog()
	    to call this function instead.  No there is no confusion about
	    refinement parameters [torsions control] when user should be
	    simply selecting a map. This was easier than I thought it was
	    going to be [I've known that I've needed to make this fix for
	    months].

	* src/c-interface.cc: (show_select_map_dialog) created for
	    model/fit/refine dialog button callback - passthough to
	    graphics-info function.

	* Release 0.4.64

	* macros/glut.m4 (AM_PATH_GLUT): Added -lXmu to GLUT_LDOPTS for
	    Vanilla unix.

2003-12-23  Paul Emsley  <paul@chem.gla.ac.uk>

	* Release 0.4.63

	* sequence-view/sequence-view.hh: vector -> std::vector

	* sequence-view/Makefile.am (include_HEADERS): Added
	    seq-view-interface.h [Packaging error]

2003-12-22  Paul Emsley  <paul@chem.gla.ac.uk>

	* Release 0.4.62

	* ligand/residue_by_phi_psi.cc: (fit_terminal_residue_generic)
	    Added terminus_type "M" which creats a fragment of 1 residue
	    instead of 2.

	* mini-mol/mini-mol.cc: (constructor from atom_list): use the
	    passed chain_id, not "W", to construct a fragment.

	* src/c-interface.h: Changed many of the setup_* functions called
	    from model/fit/refine togglebutton callback to take a state
	    argument which usets the flag in graphics-info.h and returns
	    to a normal cursor [for toggle button toggled off].

	* src/c-inner-main.c: Changed mapview.scm to coot.scm

2003-12-19  Paul Emsley  <paul@chem.gla.ac.uk>

	* src/graphics-info.cc: (geometry_objects) Created.  Also
	    (clear_simple_distances) created.  These [together with the
	    odd static vector pointer] create on-screen distances - and
	    the removal thereof.

2003-12-17  Paul Emsley  <paul@chem.gla.ac.uk>

	* configure.in, Makefile.am, src/Makefile.am, ligand/Makefile.am:
	    changed to reflect new directory ccp4mg-utils, which is where
	    ccp4mg stuff will go, rather than in the ligand directory

	* Release 0.4.60

	* sequence-view/sequence-view.cc: Created [along with sequence-view.hh]

2003-12-10  Paul Emsley  <paule@chem.gla.ac.uk>

	* Release 0.4.59

	* src/molecule-class-info.cc: (insert_coords) Add AddResidue when
	serial_number returned -1.

	* Release 0.4.58

	* surface/Makefile.am (libcoot_isosurface_la_SOURCES): make
	library name have coot- prefix.

2003-12-09  Paul Emsley  <paule@chem.gla.ac.uk>

	* Release 0.4.57

	* ideal/simple-restraint.cc: (init_from_mol) re-include the
	istart_minus_flag and iend_plus_flag that I had foolishly removed
	before.  Now flanking atom restraints work.

	* src/c-interface.h: Added save_state_file()

2003-12-08  Paul Emsley  <paule@chem.gla.ac.uk>

	* ideal/simple-restraint.hh: Added enumeration of
	BONDS_ANGLES_TORSIONS_PLANES_AND_NON_BONDED.

	* Makefile.am (subpkgdata_DATA): Add standard-residues.pdb

	* Release 0.4.56

	* src/graphics-info.cc: (execute_rotate_translate_ready): move
	over to make_asc usage.

	(execute_rigid_body_refine) moved over to make_asc usage.

2003-12-07  Paul Emsley  <paule@chem.gla.ac.uk>

	* src/graphics-info.cc: (copy_mol_and_refine) Massive re-write yet
	again.  We didn't want the flanking residues to appear in the
	moving atoms.

	* ligand/dunbrack.hh: dunbrack constructor: don't run
	add_all_rotamers and setup_chi_atom_pairs, because we already do
	that in the base class.  Rotamers fixed.

2003-12-06  Paul Emsley  <paule@chem.gla.ac.uk>

	* new libtool.

	* src/c-interface.cc: (read_phs_and_make_map_using_cell_symm)
	created to re-generate a phs map from phs data.

	* src/molecule-class-info.cc: (make_map_from_phs) Added
	save_state_command_strings_ push backs.

	* src/globjects.cc: (glarea_button_press) added freeglut conditional
	compilation for the contouring timer.

	* src/graphics-info.cc: (SetShowFPS): added freeglut conditional
	compilation for the FPS timer.

2003-12-05  Paul Emsley  <paule@chem.gla.ac.uk>

	* Release 0.4.55

	* src/globjects.cc: (display_density_level_maybe) Sorted out the
	matrix mode change with pops - now you can click on the
	coordinates immediately after density has changed.  Documentation
	amended.

	* src/molecule-class-info.cc: (close_yourself) Removed delete []
	atom_sel.atom_selection usage - using
	DeleteSelection(SelectionHandle) instead.

2003-12-04  Paul Emsley  <paule@chem.gla.ac.uk>

	* Release 0.4.54

	* Makefile.am (install-data-local): changed the destination of
	pixmaps so that it is in PKGDATADIR which is a passed variable in
	the compilation.

	* Release 0.4.53

	* src/c-interface.cc: (set_refine_max_residues) Created - so that
	not too many residues are refined by accident [default fencepost
	20].

	* src/graphics-info.cc: (copy_mol_and_refine) and
	(copy_mol_and_regularize) removed copy molecule and generate a
	moving_atoms_asc "by hand".  Seems faster.

2003-12-03  Paul Emsley  <paule@chem.gla.ac.uk>

	* coords/mmdb-extras.cc (add_atom_index_udd_as_old): Created - so
	that we can have a fast lookup of atoms
	(full_atom_spec_to_atom_index) when we accept regularization and
	refinement.

	* Release 0.4.52

	* macros/glut.m4 (AM_PATH_GLUT): Move GL_LIBS into default
	GLUT_LDOPTS.

2003-12-02  Paul Emsley  <paule@chem.gla.ac.uk>

	* Release 0.4.51

	* src/graphics-info.cc: (change_peptide_carbonyl_by): created.
	(change_peptide_peptide_by): created.  Along with new dialog and
	button on model/fit/refine dialog - provides backbone torsion
	angle manipulation.

	* src/graphics-info-state.cc: (save_state_file) added a test for
	non-Closed molecule before saved parameters are written.

	* src/c-interface.cc: (run_state_file_maybe) created.  Along with
	a state file dialog and a set_run_state_file_status()
	c-interface.cc function.

	* src/graphics-info.cc: (set_last_map_colour) Created.

2003-11-29  Paul Emsley  <paule@chem.gla.ac.uk>

	* Release 0.4.51-pre-3 [trying cvs]

	* ligand/ligand.cc: (mask_around_coord) Added distance check to
	atom.  Needs testing.

2003-11-25  Paul Emsley  <emsley@ysbl.york.ac.uk>

	* src/c-interface.cc: (set_graphics_window_size): added
	gtk_window_set_default_size call and argument setting in reshape
	in glarea.cc so that the window shape is saved in the state file.

2003-11-23  Paul Emsley  <emsley@ysbl.york.ac.uk>

	* src/molecule-class-info.cc: make_map_from_cif [just the filename
	version].  Added warning about no calculated structure factors
	[rather than silently failing].

2003-11-18  Paul Emsley  <paule@chem.gla.ac.uk>
	
 	* Release 0.4.49

	* Makefile.am added suppressions [for valgrind].

	* Release 0.4.48

	* src/molecule-class-info-other.cc: (residue_edit_phi_psi)
	created. (edit_phi_psi_pull_residue) created. (get_phi_psi)
	created.  All for edit phi/psi support.

2003-11-17  Paul Emsley  <paule@chem.gla.ac.uk>

	* src/graphics-info-defines.cc (check_if_in_edit_phi_psi_define):
	Created.

	* src/callbacks.c (on_dynarama_ok_button_clicked): Added support
	for edit phi/psi window closure.

	* macros/mmdb.m4 (AM_PATH_MMDB): Added check for old mmdb by using
	SetAtomName(const char *).  Exit if this fails.

2003-11-15  Paul Emsley  <paule@chem.gla.ac.uk>

	* Release 0.4.46.  Some pretty substantial changes here [display
	control widget, posting from state, symm atom picking and
	non-bonded contacts in refinement].

	* coords/mmdb-crystal.cc: (translate_atom) has an invalid read -
	fixed by not deleting the atom before we construct the returned
	Cartesian [duh!].  Also removed the cryst_p usage.

	* src/globjects.cc (key_press_event): Added postings of the most
	useful windows from F5, F6, F7.

	* src/c-interface.cc: (wrapped_create_goto_atom_window) Created.
	(fill_go_to_atom_window) created [functionality pulled out of
	callbacks.c] - because it was needed by
	post_display_control_window() too.

	* src/graphics-info-state.cc: (save_state_file) added to to post
	model/fit/refine window if it was up.

	* src/graphics-info-pick.cc: (symmetry_atom_pick) Make clipper
	spacegroup and construction depend on there being at least one
	box.

	* ideal/simple-restraint.cc: (distortion_score_non_bonded_contact)
	Added.  Also my_df_non_bonded and various functions and
	constructors of simple_restraint.  Now we have working [I hope]
	non-bonded contacts too.

	* src/molecule-class-info.cc: (read_ccp4_map) Put in directory or
	missing file protection [at the suggestion of Charlie Bond].

2003-11-14  Paul Emsley  <paule@chem.gla.ac.uk>

	* ideal/simple-restraint.cc: (make_non_bonded_contact_restraints)
	now we have non-bonded contacts from the active residues.

2003-11-12  Paul Emsley  <paule@chem.gla.ac.uk>

	* Release 0.4.46-pre-3

	* src/graphics-info-pick.cc (fill_hybrid_atoms): Changed to use
	mmdb to get the matrix because mmdb and clipper symops are not in
	the same order.  The matrix generates a mat33 and a coord_oth,
	which are then used to create an rtop which transforms the atom
	position.

2003-11-07  Paul Emsley  <paule@chem.gla.ac.uk>

	* coords/mmdb-crystal.cc: sym_trans_t::str(): initialize t with \0s.
	Changed the delete to delete [] at the end. [Both from valgrind].

2003-11-07  Paul Emsley  <emsley@ysbl.york.ac.uk>

	* Release 0.4.46-pre-2

        * src/main.cc: Add stuff for splash_screen.

	* ideal/simple-restraint.cc: (make_non_bonded_contact_restraints):
	started added in non-bonded contacts.

2003-11-06  Paul Emsley  <emsley@ysbl.york.ac.uk>

	* coords/mmdb-crystal.cc: (which_box): Converted to to suggestion
	of Kevin - apply symm to centre, apply trans shift to point,
	finding closest *then* the +/- 1 along a, b, c.  Fixes the Adrian
	158A problem.

2003-11-05  Paul Emsley  <emsley@ysbl.york.ac.uk>

	* macros/gtkgl.m4 (AM_PATH_GTKGL): Put -lgtkgl before the
	$GTK_LIBS [MacOS X sensitive to this].

2003-11-02  Paul Emsley  <paule@chem.gla.ac.uk>
		
	* Release 0.4.44

	* src/gtk-manual.c: (display_control_molecule_combo_box) Removed
	extra toggle-button callbacks [active and displayed], which caused
	event recurring hell.

2003-11-01  Paul Emsley  <paule@chem.gla.ac.uk>

	* Makefile.am (EXTRA_DIST): Added cootrc.

	* ligand/ligand-extras.cc: Fixed several errors. First use the
	right map, second use doubles for the statistics, third step from
	1 not 0. Change the stop to 0.3, so that the outer shell is now 0.9

	* src/globjects.cc: Changed ligand_water_variance_limit to 0.7

2003-10-30  Paul Emsley  <paule@chem.gla.ac.uk>

	* Release 0.4.42

	* src/pick.cc: (symmetry_atom_pick) the p_i.success test was
	coming too early.  Now we finish all the boxes before testing.

	Long-standing symmetry picking bug gone!?
		
	* doc/Makefile.am (EXTRA_DIST): Added reference.tex

2003-10-29  Paul Emsley  <paule@chem.gla.ac.uk>

	* src/Makefile.am (coot_SOURCES): Use macros to expand the
	coot_wrap source files.

	(libcoot_wrap_python_la_SOURCES):
	(libcoot_wrap_guile_la_SOURCES): Create libraries for the wrapper
	code so that coot_SOURCES does not depend on a macro - which I
	could not get to expand so that the objects for coot were
	correctly generated.  Now the executable depends on the libraries,
	which gets expanded OK.  Also changes in macros/with-guile.m4 and
	macros/with-python.m4 were needed.

	* Release 0.4.41

	* src/gtk-manual.c: (display_control_molecule_combo_box) Add Bond
	Colour by Atom button.

	* Release 0.4.40

	* src/Makefile.am (coot_SOURCES): Ooops - packaging error - now
	includes select-atom-info.hh

2003-10-27  Paul Emsley  <paule@chem.gla.ac.uk>

	* src/c-interface-build.cc: (setup_mutate_auto_fit) added, with
	callback and graphics-info-defines:check_if_in_mutate_auto_fit()

	* src/globjects.cc: (draw_crosshairs_maybe) Fixed for non-square
	aspect ratios.

2003-10-24  Paul Emsley  <paule@chem.gla.ac.uk>

	* Release 0.4.37

	* src/graphics-info.cc: (fill_output_residue_info_widget_atom)
		(on_residue_info_occ_entry_key_release_event)
		(on_residue_info_b_factor_entry_key_release_event)
		(residue_info_edit_b_factor_apply_to_other_entries_maybe)
		(residue_info_edit_occ_apply_to_other_entries_maybe)
		(residue_info_add_b_factor_edit) (residue_info_add_occ_edit)
		(apply_residue_info_changes) (residue_info_release_memory)

	   Phew.  A long day's work. These functions created
	   (fill_output_residue_info_widget_atom was extended) to
	   implement residue info [occupancy and temp factor] editting.
	   By checking the dialog's checkbutton the changes are applied to
	   the whole residue.  residue_info_release_memory causes a memory
	   error when the deletes are uncommented.

2003-10-23  Paul Emsley  <emsley@ysbl.york.ac.uk>

	* src/c-interface.cc:
	    (set_ligand_water_to_protein_distance_limits) set min and max,
	    not max twice [d'oh!].

	* ligand/ligand-extras.cc: (move_atom_to_peak) Get values from the
	pristine map, not the masked one.

	* src/c-interface.cc: (wrapped_create_model_fit_refine_dialog)
	created, so that there is only one Model/Fit/Refine window.

2003-10-22  Paul Emsley  <emsley@ysbl.york.ac.uk>

	* ligand/ligand-extras.cc: Use 4 character atom names in
	write_waters and make_pseudo_atoms().

2003-10-18  Paul Emsley  <emsley@ysbl.york.ac.uk>

	* src/c-interface.cc: (execute_find_waters_real) Added raw waters
	writing (set_write_raw_waters).

2003-10-16  Paul Emsley  <emsley@ysbl.york.ac.uk>

	* src/graphics-info.cc: (add_cb_to_terminal_res) return an
	atom_selection_container_t because the number of atoms in the
	molecule has changed.  Fixes terminal residue bug [I hope].

	* geometry/protein-geometry.cc: (init_refmac_mon_lib) It seems
	that ReadMMCIFFile goes into an infinite loop when asked to read a
	directory.  So put directory protection round it [using stat]].

2003-10-14  Paul Emsley  <emsley@ysbl.york.ac.uk>

	* src/molecule-class-info.cc: (insert_coords).  Added
	make_backup();

	* src/mtz-bits.c: (f_button_select) Added "DEL" and "FOFC" logic
	to switch to difference map.

2003-10-09  Paul Emsley  <paule@chem.gla.ac.uk>

	* src/molecule-class-info.cc (add_multiple_dummies - both
	scored_skel_coord and Cartesian interface) added
	FinishStructEdit().  Error below goes away.

	* src/molecule-class-info.cc: (model_view_atom_button_labels)
	Added null protection for chains. This should not be necessary.
	It seem to be a result of mmdb corruption elsewhere - possibly
	DeleteChain in update_molecule_to().

	* src/molecule-class-info.cc: (model_view_residue_button_labels)
	Added null protection for chains.

2003-10-06  Paul Emsley  <paule@chem.gla.ac.uk>

	* Release 0.4.33

	* src/molecule-class-info.cc: (previous_baton_atom) Use direction
	to generate the vector of [previous] coordinates.

	* src/graphics-info.cc (baton_next_directions) use
	baton_build_direction_flag.

	* src/graphics-info.cc: (set_baton_build_params) Created.  We need
	to be able to build backwards - even with negative residue
	numbers.  So we need an external function that sets the starting
	residue number and the direction.
	

2003-10-02  Paul Emsley  <paule@chem.gla.ac.uk>

	* Release 0.4.32

	* src/c-interface.cc: (set_max_skeleton_search_depth) and code in
	graphics-info.cc to set the static so that the skeleton search
	depth is publically available.

	* build/CalphaBuild.hh: (CalphaBuild) new constructor so that
	max_skeleton_search_depth is publically available.

	* src/graphics-info.cc: (shorten_baton), Don't change direction
	when in b-mode.

	* src/graphics-info.cc: (lengthen_baton), Don't change direction
	when in b-mode.

	* src/callbacks.c (on_virtual_trackball_menu_pops): use
	gtk_check_menu_item_set_active to set the virtual trackball status
	on popup of Virtual Trackball menu.
	
2003-10-01  Paul Emsley  <paule@chem.gla.ac.uk>

	* src/graphics-info-state.cc: (save_state): save also the
	diff_map_iso_level_increment and the iso_level_increment.

	* src/graphics-info.cc: (unskeletonize_map) and
	src/c-interfac.cc's (skeletonize_map_by_optionmenu) are new
	skeletonization code so that you can skeletonize any map, not just
	the first one.

	* ideal/with-geometry.cc (main): added without GSL protection

	* ideal/with-map.cc: (main) added without GSL protection.

2003-09-30  Paul Emsley  <paule@chem.gla.ac.uk>

	* src/c-interface.cc: (skeletonize_map_by_optionmenu) and
	associated code in c-interface.cc, graphics-info.cc, callbacks.c.
	Support for skeletonization of any map.

	* compat/getopt1.c: include coot-getopt.h [that's what we supply]
	not getopt.h.

	* mini-mol/mini-mol.cc: (pcmmdbmanager) remove the casting to char
          for SetAtomName argument.

2003-09-25  Paul Emsley  <emsley@ysbl.york.ac.uk>

	* src/graphics-info.h: (init) Move the initialization of
	dynarama_is_diplayed here rather than in the static setup.

2003-09-24  Paul Emsley  <paul@chem.gla.ac.uk>

	* src/graphics-info.cc: (set_residue_range_refine_atoms) created
	    for calling of rigid_body fit by scripting.

	* src/rama_plot.cc: (init_internal) use gtk_object_set_data_full
	    on the window so that we can look up the canvas.

	* src/c-interface.cc: (get_mol_from_dynarama) Use the canvas to
	    lookup the molecule number, not the [top-level] window.

2003-09-23  Paul Emsley  <paul@chem.gla.ac.uk>

	* Release 0.4.28

	* src/c-interface.cc: (handle_read_draw_molecule) fill the option
	    menu of the Go To Atom window, if it exists.

	* src/molecule-class-info.cc: (restore_from_backup) save the state
	    commands and the imol_no from before calling
	    handle_read_draw_molecule().

	* src/graphics-info-defines.cc: (clear_pending_picks). Created.

2003-09-22  Paul Emsley  <paul@chem.gla.ac.uk>

	* src/callbacks.c (on_delete_item_cancel_button_clicked): Filled
	    in this function.

	* src/molecule-class-info-other.cc (residue_serial_number): added
	    null residue protection code.

	* src/c-interface-build.cc: (delete_item_mode_is_atom_p) created
	    to support (on_model_refine_dialog_delete_button_clicked).

	* src/callbacks.c (on_model_refine_dialog_delete_button_clicked):
	    If we were in delete_atom_mode, then the atom checkbutton
	    should be hilighted.

	* src/graphics-info.cc: (execute_rigid_body_refine) moved to here
	    from c-interface.cc.  Now sets imol_moving_atoms [oops].
	    
	* src/graphics-info.cc: (apply_undo), (Undo_molecule), created for
	    "Undo" support.

	* src/molecule-class-info.cc: (add_pointer_multiatom) Use 4
	    letters in the atom names.

2003-09-21  Paul Emsley  <paul@chem.gla.ac.uk>

	* coords/Bond_lines.cc: (construct_from_asc) Use the
	    non_Hydrogen_atoms array not the SelAtom.atom_selection for
	    the calculation of non-hydrogen bonds.  Hydrogens are really
	    not displayed now when we use (draw-hydrogens 0 0).

2003-09-19  Paul Emsley  <paul@chem.gla.ac.uk>

	* Release 0.4.27

	* src/molecule-class-info-other.cc (add_OXT_to_residue): and
	    supporting code in c-interface-build.cc

	* Release 0.4.26

	* refmac.scm (run-refmac-by-filename): Added
	    extra-cif-lib-filename argument.  Also made changes in calling
	    code execute_refmac_real();

	* src/molecule-class-info.cc: (full_atom_spec_to_atom_index) Now
	    us User Defined Data atom index.  Needs more testing perhaps.

	* src/graphics-info.cc: (baton_build_delete_last_residue). Baton
	    building now has an "Undo" button - hoorah!

2003-09-17  Paul Emsley  <paul@chem.gla.ac.uk>

	* src/molecule-class-info-other.cc: (auto_fit_best_rotamer) Created.

	* mini-mol/mini-mol.cc: residue::residue(const CResidue*
	    residue_p): created.

	* src/graphics-info.cc: moved the guts of
	    set_dynarama_is_displayed() to here from c-interface.cc.  Did
	    a spelling correction of dynarama_is_diplayed and made sure
	    references of it were array usages [there is more than one
	    ramachandran plot now].

2003-09-16  Paul Emsley  <emsley@ysbl.york.ac.uk>

	* src/globjects.cc: Changed the default
	graphics_info_t::environment_min_distance to 0.0.

	* src/graphics-info.h: Added dynamic_map_zoom_offset and the
	c-interface function set_dynamic_map_zoom_offset, which addresses
	Kevin's wish [to have the screen full of density always] somewhat
	[i.e. not completely satisfactarily].

2003-09-11  Paul Emsley  <emsley@ysbl.york.ac.uk>

	* ligand/ligand.cc: Don't apply angles to ligands of size 1
	(e.g. waters).  No more crashing when trying to Rigid Body Refine
	water atoms.

2003-09-09  Paul Emsley  <emsley@ysbl.york.ac.uk>

	* Release 0.4.24

	* ideal/simple-restraint.cc: (make_flanking_atoms_restraints) now
	uses the new class variables istart_minus_flag and iend_plus_flag
	which are now set in (init_from_mol) which are set if we the
	flanking next and previous residues are in the molecule.

	* ligand/residue_by_phi_psi.cc: (make_2_res_joining_frag) Created.
	Now we create a fragment of 2 residues, because when building
	forward, the O of the next atom depends on the next next residue.

2003-09-08  Paul Emsley  <emsley@ysbl.york.ac.uk>

	* src/molecule-class-info.cc: (make_atom_label_string) Add alt conf
	code to the atom label if it has one.

	* db-main/db-main.hh (weighted_residue::weighted_residue()): 
		Initialize weight_sum and weight_sum_cb [fool].
		[Uninitialized variable found by valgrind].
		Ca -> mainchain bug fixed.

2003-09-07  Paul Emsley  <emsley@ysbl.york.ac.uk>

	* Release 0.4.23

	* src/c-interface.cc: (save_coordinates).  Put NULL protection in
	the gtk_object_get_user_data - not a clean solution [still gets a
	Gtk-WARNING invalid cast from NULL pointer], but it doesn't crash
	now.

	* src/molecule-class-info.cc: (append_to_molecule)
	execute_find_waters_real now calls append_to_molecule when we want
	to add the waters to the masking molecule.

	* src/graphics-info.cc: (go_to_atom_residue) Garib's Bug: the way
	to do this is to set the residue number to -1 in the static
	(goto_to_atom_residue_number_) in globjects.cc and test for -1
	when we render the goto_atom_window.  If it is -1, then we use the
	details of the first atom of the first molecule that has atoms. I
	did indeed do exactly that: graphics_info_t::go_to_atom_residue()
	now uses intelligent_this_residue_atom().  Garib's Bug Fixed.  Hoorah!

	* src/gtk-manual.c: (display_control_molecule_combo_box) moved
	gtk_option_menu_set_menu to the end of the routine and use
	render_optionmenu_1_menu directly in the bond_type test just above
	it.  This allows gtk_menu_set_active to work - Hooray!  C-alpha
	bond representation in Display Control now fixed.

2003-09-06  Paul Emsley  <emsley@ysbl.york.ac.uk>

	* src/c-interface-build.cc: created new widget run_refmac dialog
	[which needed widget setup and analysis code], execute_refmac and
	execute_refmac_real and wrote refmac.scm and coot-utils.scm [which
	uses goosh [so I need to add that to my dependences]].  So refmac
	"works".  This is rather pleasing.  It does not currently read in
	the new coordinates and map, I will do that shortly.

2003-09-05  Paul Emsley  <emsley@ysbl.york.ac.uk>

	* src/c-interface.cc: (set_show_aniso(int state)) redraw glarea so
	that callback actually changes the graphics.

2003-08-27  Paul Emsley  <paule@chem.gla.ac.uk>

	* src/molecule-class-info.cc: (add_pointer_multiatom) Added
	multiatom [e.g. SO4] pointer atom code.

2003-08-26  Paul Emsley  <paule@chem.gla.ac.uk>

	* src/c-interface-build.cc: (mutate) return a status so that the
	calling script knows that something went wrong [potentially].

	* src/molecule-class-info.cc: Made get_ori_to_this_res and
	move_std_residue return error status for signalling unfilled rtop,
	used now in mutate_auto.

2003-08-19  Paul Emsley  <emsley@ysbl.york.ac.uk>

	* src/molecule-class-info.cc: (make_backup).  Activated backup
	code for mutations.

	* src/c-interface.cc: (fill_option_menu_with_coordinates_options)
	added an extra arg, which is the signal function callback for the
	item selection - [needed so that we don't do a goto atom residue
	list update when we save a molecule].

	* src/callbacks.c (on_coordinates_recentring1_activate): Added
	code so that recentre_on_read_pdb is now gui-able.

2003-08-13  Paul Emsley  <paule@chem.gla.ac.uk>

	* src/molecule-class-info.cc: (add_coords) Check for null residue
	[sigh].

2003-08-12  Paul Emsley  <paule@chem.gla.ac.uk>

	* src/rama_plot.cc: (big_square) When the model view was used to
	recentre view and a water was selected, we crashed in big_square,
	which had assued that everything was a protein.  Fixed that by
	testing for the size of phi_spi.

2003-08-11  Paul Emsley  <paule@chem.gla.ac.uk>

	* surface/CIsoSurface.cpp: Comment out clipper/mtz/mtz_io.h: not
	needed.

2003-08-08  Paul Emsley  <emsley@ysbl.york.ac.uk>

	* Today I build a version for the sgi and ran it on perky.  It
	ran!  It displayed a map!  It did regularization and refinement!
	Interestingly the graphics were pretty fast [almost as good as
	bubbles] but the calculation stuff [refinement, map
	contouring/recentering] was very very slow.

2003-08-07  Paul Emsley  <emsley@ysbl.york.ac.uk>

	* src/globjects.cc: (glarea_button_press) [and key_release_event].
	When map level is changed, it first checks to see if there is only
	one map being displayed and if there is, then that map gets moved,
	not the one to which the scroll-wheel is attached.

	* Release 0.4.22-pre-6

	* src/c-interface.cc: (go_to_atom_mol_button_select) Added code to
	do the gtklist widgets for the residue and atom lists in the go to
	atom window.  Note gtklists are out of deprecated and that I had
	to use gtk_set_data_full by hand to add the name to the widget so
	that it could be looked up.  [I had to create it by hand for some
	viewport scrolling issue not supported in glade].

2003-08-05  Paul Emsley  <emsley@ysbl.york.ac.uk>

	* coords/Bond_lines.cc: (Bond_lines_container) added delete trans
	atom code, after using valgrind.  Also in pick.cc.  Valgrind stil
	not happy - but we are in a better position.

	* src/callbacks.c (on_go_to_atom1_activate): Adding list of
	residues and atoms to go_to_atom_window.

2003-08-04  Paul Emsley  <emsley@ysbl.york.ac.uk>

	* src/callbacks.c (on_show_symmetry1_activate and others): Added Ca
	for symmetry option.

2003-07-26  Paul Emsley  <paul@chem.gla.ac.uk>

	* src/molecule-class-info.cc: (set_bond_colour_by_mol_no) Limit
	    the rotation_size to +1.0.

2003-07-25  Paul Emsley  <emsley@ysbl.york.ac.uk>

	* src/c-interface.cc: (fill_close_option_menu_with_all_molecule_options)
	fixed the non-setting of the first molecule in the optionmenu.

	* src/c-interface.cc: fill_option_menu_with_coordinates_options()
	fixed the non-setting of active molecule menu item in optionmenu.

2003-07-18  Paul Emsley  <paul@chem.gla.ac.uk>

	* Release 0.4.21-pre-7: I am pleased with this release.

	* Added "unsaved changes" flag to molecule_class_info_t along with
	    code that ativates in when the molecule is changed and
	    deactivated on save coordinates.

	  Added gui code to interact with above.

	* Added state-saving code. 
	
2003-07-15  Paul Emsley  <paul@chem.gla.ac.uk>

	* src/pick.cc: symmetry_atom_pick() removed the deletion of
	    translated and created a function clear_symm_atom_info that
	    should be called after setRotationCentre(symm_atom_info_t)
	    that clears it instead.

	* coords/Bond_lines.cc: (Bond_lines_container::construct_from_asc)
	    added code to look for " D" as well as " H".

2003-07-14  Paul Emsley  <paul@chem.gla.ac.uk>

	* src/graphics-info.cc:
	    graphics_info_t::execute_rotate_translate_ready() Added the
	    assignment to imol_moving_atoms that I had forgetten.

2003-07-09  Paul Emsley  <emsley@ysbl.york.ac.uk>

	* ligand/ligand.cc: added to the class do_size_match_test.  We
	don't want to do the test for rigid body refinement [which calls
	find_centre_by_ligand], but we do for a full ligand search.

2003-07-07  Paul Emsley  <emsley@ysbl.york.ac.uk>

	* src/c-interface-build.cc: Added function to set lowest rotamer
	probability.

2003-07-07  Paul Emsley  <emsley@ysbl.york.ac.uk>

	* Releases: 0.4.19, 0.4.20, fixing mutate bugs.

2003-07-04  Paul Emsley  <paul@chem.gla.ac.uk>

	* Release 0.4.18 

	* close molecule functionality added [see close_yourself() in
	    molecule_class_info_t].

2003-07-03  Paul Emsley  <paul@chem.gla.ac.uk>

	* Release 0.4.17-pre-1

	* tree/dunbrack.cc: Added dunbrack and assocciated classes
	    [uses mgtree Tree].  testdunbrack seems to work.  Let's make a
	    release of that.

2003-07-01  Paul Emsley  <paul@chem.gla.ac.uk>

	* coords/Bond_lines.cc: added optional int do_disulfide_bonds_flag
	    to constuctor so that disulfide bonds dont flash when we are
	    doing regularization/refinement.  Made necessary changes
	    therefore to graphics_info_t::copy_mol_and_refine,
	    copy_mol_and_regularize and makebonds() in molecule-class-info.

2003-06-24  Paul Emsley  <emsley@ysbl.york.ac.uk>

	* src/pick.cc: removed atom label construction to molecule-class-info.cc

2003-06-23  Paul Emsley  <emsley@ysbl.york.ac.uk>

	* src/mtz-bits.c: manage_column_selector: Added code to set FWT,
	PHWT as default if they exist:
        gtk_menu_set_active(GTK_MENU(optionmenu1_menu), i)  Code works!

	* src/c-interface.cc: set_show_unit_cell: Added code and changed
	interface to be setting all molecule show_unit_cell_flag flags,
	not just imol=0.

2003-06-20  Paul Emsley  <paule@chem.gla.ac.uk>

	* Release mapview-0.4.15-pre-4

	* ideal/simple-restraint.cc, configure.in: Make HAVE_GSL be a
	source configuration option, and --with-gsl-prefix for configure.

2003-06-19  Paul Emsley  <paule@chem.gla.ac.uk>

	* ligand/ligand.cc: Option out the best-overall-*.pdb writing by
	introducing a new class variable write_orientation_solutions.

2003-06-15  Paul Emsley  <paule@chem.gla.ac.uk>

	* src/graphics-info.cc: Made many changes so that regularized_asc
	becomes moving_atoms_asc since it is used by many atom
	manipulation functions, not just regularization.

2003-06-14  Paul Emsley  <paule@chem.gla.ac.uk>

	* src/molecule-class-info.cc: (molecule_class_info_t::pepflip), if
	atom is an " N ", then move to the previous atom.

	* coords/Bond_lines.cc: Bond_lines_container constructor: added
	different bonds [colour] or bond to a Carbon atom.

	* src/pick.cc: (make_atom_label_string) re-written as a c++
	function.

	* src/c-interface.cc: (scale_zoom_internal): Added fabs to wrap f.

2003-06-13  Paul Emsley  <paule@chem.gla.ac.uk>

	* ligand/residue_by_phi_psi.cc: Added then completely re-written,
	sill does not work properly.

	* src/command-line.cc: Added coot-getopt.h not getopt.h, ie we
	now have a copy of getopt in coot [in compat].

2003-06-07  Paul Emsley  <paule@chem.gla.ac.uk>

	* src/globjects.cc: Set graphics_info_t::rotate_colour_map_for_map
	= 31.0; degrees

2003-06-03  Paul Emsley  <emsley@ysbl.york.ac.uk>

	* ligand/ligand.cc: (coot::ligand::fit_ligand_to_clusters) Added
	protection for setting at the end final_ligand[iclust] beyond it's
	size.

2003-05-30  Paul Emsley  <paul@chem.gla.ac.uk>

	* src/molecule-class-info.cc:
	    (initialize_map_things_on_read_molecule) now has colour map
	    rotation for the map.

	* src/rama_plot.cc: (draw_phi_psi_point_internal) Fixed assignment
	    of big_box_item. I think the ramachandran plot bug has gone
	    away now.  Phew.

2003-05-29  Paul Emsley  <paul@chem.gla.ac.uk>

	* geometry/protein-geometry.hh: Fixed dist_esd for link planes.

2003-05-28  Paul Emsley  <paul@chem.gla.ac.uk>

	* src/graphics-info.cc: Attempt to make some safety for
	    regularized_asc deletion.  To no avail - deletion of the
	    molecule is commented.

2003-05-25  Paul Emsley  <paul@chem.gla.ac.uk>

	* src/c-interface.cc: execute_rigid_body_refine(): Function added
	    - uses ligand class.

	* ligand/ligand.cc (get_solution): Function added. Used for
	    graphics.
	    
	  find_centre_by_ligand(): Function added: for use in rigid body
	    refinement.

	* src/c-interface.h: Added these functions:
	void set_map_sampling_rate_text(gchar *text);
	void set_map_sampling_rate(float r);
	char* get_text_for_map_sampling_rate_text();
	float get_map_sampling_rate();

	* src/callbacks.c (on_density_size1_activate): Added code to get
	    and set map_sampling_rate using widget
	    map_sampling_rate_entry.

2003-05-18  Paul Emsley  <paul@chem.gla.ac.uk>

	* src/gtk-manual.c: Added code to provide C-alpha pseudo bond
	    representation menu_item.

	* Release 0.4.12

	* ideal/simple-restraint.cc: Added map terms and now the seem
	    to work correctly - with a substantial (1000?) weight in the
	    constructor.

2003-05-08  Paul Emsley  <paule@chem.gla.ac.uk>

	* ideal/simple-restraint.cc: (make_monomer_restraints) changed to
	istart_res and iend_res usage for the residue selection.

	* src/globjects.cc: changed default skeleton box radius to 40A.

	* angles/AngleInfo.cc: (assign_angle_torsion).  We get a crash
	when running build Ca now.  The problem is in assign_angle_torsion
	creating bad values for theta_bin and torsion_bin for the
	angle_torsion_table.  Fixed by adding
	setup_angle_torsion_table(10,5) to the AngleInfo constructor.

2003-05-07  Paul Emsley  <paule@chem.gla.ac.uk>

	* src/graphics-info.cc: (smooth_scroll_maybe) Had another bash at
	making the zoom/scroll/zoom look better.

	* src/Makefile.am (EXTRA_DIST): Added post-glade.

	* Synced upto 24 April 2003 clipper.

	* src/molecule-class-info.cc: Added #include
	"clipper/mmdbold/clipper_mmdb.h" for clipper::DBAtom_selection
	atoms() in make_map_from_cif_generic().

	* ligand/ligand.hh: Added #include
	"clipper/mmdbold/clipper_mmdb.h" so that clipper::MMDB and
	clipper::DBAtom_selection work. 

	* angles/AngleInfo-angle-torsions-autogen.cc
	(from_batched_angle_torsions_bits_540): Split into compiler-sized
	chunks :-).  Compiles much faster now.  Added the new declarations
	to AngleInfo.h too.

	* macros/with-python.m4 (AM_WITH_PYTHON): Added UTIL_LIB for
	PYTHON_LIBS depending on `uname`

2003-04-10  Paul Emsley  <emsley@ysbl.york.ac.uk>

	* src/globjects.cc: Added colour map rotation using rgb to hsv
	conversion, where we add a few degrees
	(graphics_info_t::rotate_colour_map_on_read_pdb) to the hue.
	However, molecule 1 appears over the top of molecule 2, thus
	causing confusion, potientially.  So draw the molecules in draw
	back to front [i.e. starting at the higest molecule number].

	Add c-interface.cc support for these variables.

2003-04-08  Paul Emsley  <paul@chem.gla.ac.uk>

	* skeleton/Makefile.am: Added ligand dir to mapview.  Synced up
	    configure.in and main Makefile.am to match.

	* macros/with-python.m4 (MAPVIEW_WRAP_PYTHON_CONVERT): added
	    variable to copy blank.cc to mapview_wrap_python.cc if python
	    was not included.
	
	* macros/with-guile.m4 likewise for guile.  Also sync
	    src/Makefile.am to reflect these changes.

2003-03-13  Paul Emsley  <paul@chem.gla.ac.uk>

	* src/Makefile.am (INCLUDES): Changed GLUT_CLAGS to GLUT_CFLAGS.

2003-03-12  Paul Emsley  <paul@chem.gla.ac.uk>

	* src/c-interface.h: Added mapview_exit so that Py_Finalize() gets
	    called.  Used in callbacks.c by on_exit1_activate(); 

2003-03-04  Paul Emsley  <emsley@ysbl.york.ac.uk>

	* src/callbacks.c (on_smooth_scrolling_window_ok_button_clicked):
	changed to set_smooth_scroll_limit_str because we changed the
	interface so that we can pass a float.

2003-02-26  Paul Emsley  <emsley@ysbl.york.ac.uk>

	* macros/gtkgl.m4 (AM_PATH_GTKGL): Added -lpthread.  We should
	check for thread first then, I guess.

	* skeleton/Makefile.am (test_various_LDADD): Changes references to
	AngleInfo to mapview-AngleInfo.

	* macros/Makefile.am (MACROS): Recreated [because I left it on the
	laptop] gtk-canvas.m4 and included it in Makefile.am

2003-11-26  Paul Emsley  <paul@chem.gla.ac.uk>

	* Release 0.4.7-3

	* */Makefile.am : Now using libtool

2003-11-25  Paul Emsley  <paul@chem.gla.ac.uk>

	* src/molecule-class-info.cc: (make_map_from_cif) Added 2fo-fc map
	    generation code. Yeah!  How cool!  [Critical code cribbed from
	    Kevin, of course - he said alliteratively].

	* macros/Makefile.am (MACROS): Added guile.m4

	* src/molecule-class-info.cc: (unlabel_atom) Fixed indexing limit
	    in for loop so that we can no delete the last atom in the
	    list.

2003-11-20  Paul Emsley  <paul@chem.gla.ac.uk>

	* macros/gtkgl.m4 (AM_PATH_GTKGL): Added -lpthread.  Not sure
	    about the placing.

2003-02-18  Paul Emsley  <emsley@ysbl.york.ac.uk>

	* Release 0.4.6-pre-7

2003-02-17  Paul Emsley  <emsley@ysbl.york.ac.uk>

	* src/Makefile.am (MAPVIEW_EXTRA_LIBS): Removed ../db-main for
	now.

	(mapview_LDADD): Removed @MAPVIEW_WRAP_LIBS@ 

	* src/molecule-class-info.cc: Commented clipper-cif.h

	* src/c-interface.cc: Commented out db-main.h from includes.
	Commented out test_fragment().

	* src/Makefile.am (EXTRA_DIST): added EXTRA_DIST for mapview.i

	* All sorts of gcc 3.2 fixes, using std:: a lot, removing default
	arguments from function definitions, etc.

	* configure.in: delete db-main (and from Makefile.am) for now.

2003-02-03  Paul Emsley  <paule@chem.gla.ac.uk>

	* src/callbacks.h: removed clipping_adjustment_changed and moved
	it to c-interface.cc, since it is only called by
	do_clipping1_activate().

	* src/callbacks.c (on_exit1_activate): Call gtk_exit, not
	gtk_main_quit() because gtk_main_quit does nothing [I don't know
	why] now that we have a scripting window.

	* (on_clipping1_activate): moved code to do_clipping1_activate()
	in c-interface.cc.  Likewise clipping_adjustment_changed(). 

2002-11-14  Paul Emsley  <paule@chem.gla.ac.uk>

	* macros/clipper.m4 (AM_PATH_CLIPPER): take out cctbx and sgtbx
	from the necessary libraries.

	* skeleton/BuildCas.cc (all_skel_pts_in_asu): Removed the commment
	on the map level.

2002-10-30  Paul Emsley  <paule@chem.gla.ac.uk>

	* Added a ton of code, phs reading, cell selection, map and
	molecule control, more autobuilding code.  

	* Release 0.4.5 

2002-10-30  Paul Emsley  <paule@chem.gla.ac.uk>

	* Linking with python, following Stuart's recipe works [except
	that gtk takes over the console].  Attempting to link with guile
	make guile crash :-(.

2002-10-10  Paul Emsley  <paule@chem.gla.ac.uk>

	* skeleton/BuildCas.cc: added "tidy up trans_selection:" code.
	Now *much* faster at generating symmetry expanded branch points.

2002-08-21  Paul Emsley  <paule@chem.gla.ac.uk>

	* Release 0.4.1 [due to post-glade mix-up].

2002-08-20  Paul Emsley  <paule@chem.gla.ac.uk>

	* Release 0.4.0 [at long last!]

	* src/c-interface.cc: (goto_near_atom_maybe and friends).  Added
	functions to do next/previous residue (go_to_atom_* functions)

2002-08-19  Paul Emsley  <paule@chem.gla.ac.uk>

	* src/pick.cc: (atom_pick) Added an update for SelAtom so that we
	are looking at the molecule that had the nearest contact [fixes
	James Murray bug, I believe].

	* src/pick.cc (symmetry_atom_pick).  Similar to above [using
	translated].
	
	* synced with laptop [IUCr 2002 enhancements]. 

2002-07-28  Paul Emsley  <paule@chem.gla.ac.uk>

	* src/globjects.cc: (glarea_motion_notify), (init), (draw) add in
	quaternion/trackball support.  Hoorah! the mouse now moves the
	molecule as I like it.  We use trackball.c from sgi.

	* src/c-interface.cc: (skel_foadi_on) Call
	initialize_coordinate_things_on_read_molecule() for the bones and
	the constructed atoms.  Goodbye "symmetry labelling" bug.

	* src/globjects.cc: (glarea_button_press) Only try to pick
	symmetry atoms if they are being displayed.  The same goes for
	labelling. 

2002-07-09  Paul Emsley  <paule@chem.gla.ac.uk>

	* src/globjects.cc: (anisotropic something) Tinkered with this
	function so that it returns "nice" values.

	* src/c-interface.h: Reshuffled aniso c-interface functions and
	dropped their molecule arguments. The Anisotropic Atoms widget has
	no ability to select molecules.  This then is not a property of a
	molecule, but is a property of the graphics.
	
	float get_limit_aniso();          // not a function of the molecule
	short int get_show_limit_aniso(); // not a function of the molecule
	short int get_show_aniso();       // not a function of the molecule
	void set_limit_aniso(short int state);
	void set_aniso_limit_size_from_widget(char *text);
	void set_show_aniso(int state); 
	char *get_text_for_aniso_limit_radius_entry();
	void set_aniso_probability(float f);
	float get_aniso_probability();

2002-06-25  Paul Emsley  <paule@chem.gla.ac.uk>

	* skeleton/fc_skeleton.cc: (converge): change the gridding limits
	from -1..1 to -2..2 [like Kevin suggested].

2002-06-17  Paul Emsley  <paule@chem.gla.ac.uk>

	* skeleton/fc_skeleton.h (class fc_skeleton): Deleted denlist and
	friends and removed their usage from fc_skeleton() and
	~fc_skeleton(). 

	* skeleton/fc_skeleton.cc (initprevden): Completely rewritten
	according to Kevin's notes.

	(getprevden): Likewise.

2002-05-24  Paul Emsley  <paule@chem.gla.ac.uk>

	* Release 0.3.93
	
2002-05-01  Paul Emsley  <paule@chem.gla.ac.uk>

	* Massive rebuilding - the static maps and coordinates are gone and
	now are part of molecules.  Much rebuilding of the interface to
	take account of this change.  Much removal of static objects -
	which have been moved to dynamically allocated molecules
	(molecule_class_info_t). 

2002-02-28  Paul Emsley  <paule@chem.gla.ac.uk>

	* font/Makefile.am (CXXFLAGS): I mean CXXFLAGS, not CXX_FLAGS.

2002-02-23  Paul Emsley  <paule@chem.gla.ac.uk>

	* src/pick.cc: (make_atom_label_string) fixed atom labelling.

2002-02-22  Paul Emsley  <paule@chem.gla.ac.uk>

	* macros/clipper.m4 (AM_PATH_CLIPPER): Added -lm

2002-02-17  Paul Emsley  <paule@chem.gla.ac.uk>

	* src/globjects.cc: (draw) Addeded and extra gtk_widget_draw()
	      call. 

	* src/Makefile.am (mapview_SOURCES): changed map.cc to
	      xmap-interface.cc and similarly with the includes.

2002-02-14  Paul Emsley  <paule@chem.gla.ac.uk>

	* surface/CIsoSurface.cpp: (done_line_list_t::done_line_list_t)
	      set the start size to a typical number of vectors, 40000
	      (not 10). 

2002-02-07  Paul Emsley  <paule@chem.gla.ac.uk>

	* src/c-interface.cc: (make_and_draw_map) Added gtk_widget_draw for
	      glarea.

	* coords/Bond_lines.cc: Moved out the old contructor from an
	      atom_selection_container_t to tmp.cc

2002-02-06  Paul Emsley  <paule@chem.gla.ac.uk>

	* coords/Bond_lines.cc: (Bond_lines_container) Added the delete
	      contacts. 

	* src/pick.cc: Chopped unproject into 2 so that unproject_xyz can
	      be used by screen_x_to_real_space_vector();

	* src/graphics-info.h: Added control_is_pressed as a public
	      static. 

	* src/gl-extras.cc (gl_extras): Added the focus grabbing so that
	      we can get key [keyboard] presses.
	

